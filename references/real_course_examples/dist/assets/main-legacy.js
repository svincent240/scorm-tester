!function(){function e(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function t(e,t){return e.get(n(e,t))}function r(e,t,r){return e.set(n(e,t),r),r}function n(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,s=[],c=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e,t,r){return(t=f(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function o(r,n,a,o){var c=n&&n.prototype instanceof s?n:s,d=Object.create(c.prototype);return l(d,"_invoke",function(r,n,a){var o,s,c,l=0,d=a||[],u=!1,p={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,r){return o=t,s=0,c=e,p.n=r,i}};function m(r,n){for(s=r,c=n,t=0;!u&&l&&!a&&t<d.length;t++){var a,o=d[t],m=p.p,g=o[2];r>3?(a=g===n)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=m&&((a=r<2&&m<o[1])?(s=0,p.v=n,p.n=o[1]):m<g&&(a=r<3||o[0]>n||n>g)&&(o[4]=r,o[5]=n,p.n=g,s=0))}if(a||r>1)return i;throw u=!0,n}return function(a,d,g){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&m(d,g),s=d,c=g;(t=s<2?e:c)||!u;){o||(s?s<3?(s>1&&(p.n=-1),m(s,c)):p.n=c:p.v=c);try{if(l=2,o){if(s||(a="next"),t=o[a]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=e}else if((t=(u=p.n<0)?c:r.call(n,p))!==i)break}catch(t){o=e,s=1,c=t}finally{l=1}}return{value:t,done:u}}}(r,a,o),!0),d}var i={};function s(){}function d(){}function u(){}t=Object.getPrototypeOf;var p=[][n]?t(t([][n]())):(l(t={},n,function(){return this}),t),m=u.prototype=s.prototype=Object.create(p);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,l(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return d.prototype=u,l(m,"constructor",u),l(u,"constructor",d),d.displayName="GeneratorFunction",l(u,a,"GeneratorFunction"),l(m),l(m,a,"Generator"),l(m,n,function(){return this}),l(m,"toString",function(){return"[object Generator]"}),(c=function(){return{w:o,m:g}})()}function l(e,t,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}l=function(e,t,r,n){function o(t,r){l(e,t,function(e){return this._invoke(t,r,e)})}t?a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(o("next",0),o("throw",1),o("return",2))},l(e,t,r,n)}function d(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){d(o,n,a,i,s,"next",e)}function s(e){d(o,n,a,i,s,"throw",e)}i(void 0)})}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function g(e,t,r){return t&&m(e.prototype,t),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e){var t=function(e,t){if("object"!=h(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==h(t)?t:t+""}function v(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=y(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function y(e,t){if(e){if("string"==typeof e)return w(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}System.register([],function(n,o){"use strict";return{execute:function(){var l,d=document.createElement("style");d.textContent=':root{--color-primary: #240250;--color-primary-hover: #1a0140;--color-secondary: #581c87;--color-secondary-hover: #4a176f;--color-accent: #00874a;--color-accent-hover: #006338;--color-white: #ffffff;--color-gray-50: #f9fafb;--color-gray-100: #f3f4f6;--color-gray-200: #e5e7eb;--color-gray-300: #d1d5db;--color-gray-400: #9ca3af;--color-gray-500: #6b7280;--color-gray-600: #4b5563;--color-gray-700: #374151;--color-gray-800: #1f2937;--color-gray-900: #111827;--text-primary: #111827;--text-body: #111827;--text-muted: #6b7280;--text-secondary: #4b5563;--color-success: #007a43;--color-success-light: #f0fdf4;--color-warning: #f59e0b;--color-warning-light: #fffbeb;--color-error: #b91c1c;--color-error-light: #fef2f2;--color-info: #1d4ed8;--color-info-light: #eff6ff;--color-partial: #d97706;--color-secondary-vibrant: #9b1fff;--color-primary-alpha-10: rgba(36, 2, 80, .1);--color-primary-alpha-20: rgba(36, 2, 80, .2);--color-primary-alpha-30: rgba(36, 2, 80, .3);--color-secondary-alpha-05: rgba(88, 28, 135, .05);--color-secondary-alpha-10: rgba(88, 28, 135, .1);--color-secondary-alpha-15: rgba(88, 28, 135, .15);--color-secondary-alpha-20: rgba(88, 28, 135, .2);--color-secondary-alpha-30: rgba(88, 28, 135, .3);--color-accent-alpha-10: rgba(0, 135, 74, .1);--color-accent-alpha-30: rgba(0, 135, 74, .3);--color-white-alpha-15: rgba(255, 255, 255, .15);--color-white-alpha-25: rgba(255, 255, 255, .25);--color-white-alpha-30: rgba(255, 255, 255, .3);--color-white-alpha-50: rgba(255, 255, 255, .5);--color-white-alpha-80: rgba(255, 255, 255, .8);--color-white-alpha-95: rgba(255, 255, 255, .95);--space-1: .25rem;--space-2: .5rem;--space-3: .75rem;--space-4: 1rem;--space-5: 1.25rem;--space-6: 1.5rem;--space-8: 2rem;--space-10: 2.5rem;--space-12: 3rem;--space-16: 4rem;--space-20: 5rem;--space-24: 6rem;--font-size-xs: .75rem;--font-size-sm: .875rem;--font-size-base: 1rem;--font-size-lg: 1.125rem;--font-size-xl: 1.25rem;--font-size-2xl: 1.5rem;--font-size-3xl: 1.875rem;--font-size-4xl: 2.25rem;--font-size-5xl: 3rem;--line-height-tight: 1.25;--line-height-snug: 1.375;--line-height-normal: 1.5;--line-height-relaxed: 1.625;--line-height-loose: 2;--font-weight-normal: 400;--font-weight-medium: 500;--font-weight-semibold: 600;--font-weight-bold: 700;--radius-sm: .25rem;--radius-md: .375rem;--radius-lg: .5rem;--radius-xl: .75rem;--radius-2xl: 1rem;--radius-full: 9999px;--shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, .05);--shadow-md: 0 4px 6px -1px rgba(0, 0, 0, .1), 0 2px 4px -1px rgba(0, 0, 0, .06);--shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, .1), 0 4px 6px -2px rgba(0, 0, 0, .05);--shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, .1), 0 10px 10px -5px rgba(0, 0, 0, .04);--gradient-subtle: linear-gradient(135deg, var(--color-gray-50) 0%, var(--color-gray-100) 100%);--gradient-header: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);--gradient-primary: linear-gradient(135deg, var(--color-secondary) 0%, var(--color-secondary-vibrant) 100%);--gradient-success: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-hover) 100%);--gradient-progress: linear-gradient(90deg, var(--color-primary) 0%, var(--color-secondary) 100%);--gradient-shimmer: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, .3) 50%, transparent 100%);--gradient-celebration: linear-gradient(135deg, var(--color-secondary-alpha-10), var(--color-secondary-alpha-10));--transition-fast: .15s cubic-bezier(.4, 0, .2, 1);--transition-normal: .25s cubic-bezier(.4, 0, .2, 1);--transition-slow: .35s cubic-bezier(.4, 0, .2, 1);--btn-padding-y: var(--space-3);--btn-padding-x: var(--space-5);--btn-min-height: 44px;--btn-border-radius: var(--radius-lg);--btn-font-size: var(--font-size-base);--btn-font-weight: var(--font-weight-medium);--btn-transition: all var(--transition-fast);--content-padding: var(--space-10);--section-padding: var(--space-8);--header-padding-x: var(--space-6);--header-padding-y: var(--space-3);--header-height: 72px;--footer-padding-x: var(--space-6);--footer-padding-y: var(--space-3);--nav-padding-x: var(--space-6);--nav-padding-y: var(--space-2);--input-padding-y: var(--space-3);--input-padding-x: var(--space-4);--input-border-width: 2px;--input-border-color: var(--color-gray-300);--input-border-radius: var(--radius-lg);--input-font-size: var(--font-size-base);--input-min-height: 44px;--input-focus-color: var(--color-primary);--input-focus-shadow: 0 0 0 3px rgba(36, 2, 80, .1);--feedback-padding: var(--space-3);--feedback-border-radius: var(--radius-md);--feedback-font-size: var(--font-size-sm);--feedback-font-weight: var(--font-weight-medium);--z-dropdown: 1000;--z-sticky: 1020;--z-fixed: 1030;--z-modal-backdrop: 1040;--z-modal: 1050;--z-popover: 1060;--z-tooltip: 1070;--bp-desktop-xl: 1440px;--bp-desktop: 1200px;--bp-tablet-landscape: 1024px;--bp-tablet-portrait: 768px;--bp-mobile-landscape: 480px;--bp-mobile-portrait: 320px;--space-sm: var(--space-2);--space-md: var(--space-4);--space-lg: var(--space-6);--color-text: var(--text-primary);--color-text-secondary: var(--text-secondary);--font-weight-light: 300}html{font-size:16px;line-height:var(--line-height-normal);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;height:100%}body{margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;font-size:var(--font-size-base);font-weight:var(--font-weight-normal);line-height:var(--line-height-normal);color:var(--color-gray-900);background-color:var(--color-white);-webkit-text-size-adjust:100%;height:100%}h1,h2,h3,h4,h5,h6{margin:0 0 var(--space-4) 0;font-weight:var(--font-weight-semibold);line-height:var(--line-height-tight);color:var(--color-gray-900);letter-spacing:-.01em}h1{font-size:var(--font-size-4xl);font-weight:var(--font-weight-bold);line-height:var(--line-height-tight);color:var(--color-primary);margin-bottom:var(--space-6)}h2{font-size:var(--font-size-3xl);font-weight:var(--font-weight-bold);color:var(--color-primary);margin-bottom:var(--space-5)}h3{font-size:var(--font-size-2xl);font-weight:var(--font-weight-semibold);color:var(--color-primary);margin-bottom:var(--space-4)}h4{font-size:var(--font-size-xl);font-weight:var(--font-weight-semibold);color:var(--color-gray-900);margin-bottom:var(--space-3)}h5{font-size:var(--font-size-lg);font-weight:var(--font-weight-semibold);color:var(--color-gray-900);margin-bottom:var(--space-3)}h6{font-size:var(--font-size-base);font-weight:var(--font-weight-semibold);color:var(--color-gray-900);margin-bottom:var(--space-3)}p{margin:0;color:var(--color-gray-900);line-height:var(--line-height-relaxed)}strong,b{font-weight:var(--font-weight-semibold);color:var(--color-gray-900)}em,i{font-style:italic;color:var(--color-gray-800)}a{color:var(--color-primary);text-decoration:none;transition:color var(--transition-fast)}a:hover{color:var(--color-primary-hover);text-decoration:underline}a:focus{outline:2px solid var(--color-primary);outline-offset:2px;border-radius:var(--radius-sm)}#app{max-width:1400px;margin:0 auto;background:var(--color-white);box-shadow:var(--shadow-md);position:relative;height:100%;display:flex;flex-direction:column;overflow:hidden}header{display:flex;align-items:center;justify-content:space-between;gap:var(--space-4);padding:var(--header-padding-y) var(--header-padding-x);background:var(--gradient-header);border-bottom:3px solid var(--color-secondary);position:relative;box-shadow:var(--shadow-md);flex-shrink:0;z-index:var(--z-fixed);min-height:var(--header-height)}header h1{font-size:var(--font-size-lg);color:var(--color-white);margin:0;font-weight:var(--font-weight-bold);letter-spacing:-.01em}#brand{display:flex;align-items:center;gap:var(--space-4);flex-shrink:0;flex:1}#brand img.logo{height:40px;width:auto;max-height:40px;object-fit:contain;background:none;padding:var(--space-2)}#brand .brand-title{color:var(--color-white);font-size:var(--font-size-lg);font-weight:var(--font-weight-bold);letter-spacing:-.01em}.app-body{display:flex;flex-direction:row;flex:1;overflow:hidden;position:relative}main#content{padding:var(--content-padding);background:var(--color-gray-50);background-image:radial-gradient(circle at 20% 50%,var(--color-secondary-alpha-05) 0%,transparent 50%),radial-gradient(circle at 80% 80%,var(--color-primary-alpha-10) 0%,transparent 50%);position:relative;flex:1;overflow-y:auto;overflow-x:hidden}main#content>section{padding:var(--section-padding);border-radius:var(--radius-lg);background:var(--color-white);border:1px solid var(--color-gray-200);box-shadow:var(--shadow-sm)}.content-narrow{max-width:700px;margin:0 auto}.content-medium{max-width:900px;margin:0 auto}.content-wide{max-width:1200px;margin:0 auto}.content-full{max-width:none}.stack-sm{display:flex;flex-direction:column;gap:var(--space-2)}.stack-md{display:flex;flex-direction:column;gap:var(--space-4)}.stack-lg{display:flex;flex-direction:column;gap:var(--space-6)}.cols-2{display:grid;grid-template-columns:repeat(2,1fr);gap:var(--space-4)}.cols-3{display:grid;grid-template-columns:repeat(3,1fr);gap:var(--space-4)}.cols-auto-fit{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:var(--space-4)}.split-50-50{display:grid;grid-template-columns:1fr 1fr;gap:var(--space-4)}.split-60-40{display:grid;grid-template-columns:3fr 2fr;gap:var(--space-4)}.split-40-60{display:grid;grid-template-columns:2fr 3fr;gap:var(--space-4)}@media(max-width:768px){.cols-2,.cols-3,.split-50-50,.split-60-40,.split-40-60{grid-template-columns:1fr}}[data-layout]{display:flex;flex-direction:column;height:100%;gap:var(--space-4)}[data-layout-header],[data-layout-footer]{flex-shrink:0}[data-layout-body]{flex-grow:1;overflow-y:auto}[data-layout=two-col] [data-layout-body]{display:grid;grid-template-columns:1fr 1fr;gap:var(--space-4)}[data-layout=sidebar-left] [data-layout-body]{display:grid;grid-template-columns:300px 1fr;gap:var(--space-4)}[data-layout=sidebar-left] [data-layout-sidebar]{border-right:1px solid var(--color-border);padding-right:var(--space-4)}[data-layout=sidebar-right] [data-layout-body]{display:grid;grid-template-columns:1fr 300px;gap:var(--space-4)}[data-layout=sidebar-right] [data-layout-sidebar]{border-left:1px solid var(--color-border);padding-left:var(--space-4)}.accordion{border:1px solid var(--color-gray-200);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);background:var(--color-white);overflow:hidden}.accordion-item{border-bottom:1px solid var(--color-gray-200);background:var(--color-white);display:block!important}.accordion-item:last-child{border-bottom:none}.accordion-item>.accordion-header{margin:0}.accordion-button{width:100%;padding:var(--space-4) var(--space-5);background:transparent;border:none;text-align:left;cursor:pointer;display:flex;align-items:center;justify-content:space-between;font-size:var(--font-size-lg);font-weight:var(--font-weight-medium);color:var(--color-gray-800);transition:background-color var(--transition-fast),color var(--transition-fast)}.accordion-button:hover{background:var(--color-gray-50);color:var(--color-primary-dark)}.accordion-button:focus-visible{outline:2px solid var(--color-primary);outline-offset:-2px;background:var(--color-gray-50);z-index:1}.accordion-button:not(.collapsed){color:var(--color-primary);font-weight:var(--font-weight-semibold);background:var(--color-primary-alpha-05);border-bottom:1px solid var(--color-primary-alpha-10)}.accordion-title{flex:1}.accordion-icon{margin-left:var(--space-4);color:var(--color-gray-400);flex-shrink:0;width:20px;height:20px;display:flex;align-items:center;justify-content:center;transition:transform var(--transition-normal),color var(--transition-fast)}.accordion-button:hover .accordion-icon{color:var(--color-primary)}.accordion-button:not(.collapsed) .accordion-icon{transform:rotate(180deg);color:var(--color-primary)}.accordion-icon:before{content:"";display:block;width:10px;height:10px;border-right:2px solid currentColor;border-bottom:2px solid currentColor;transform:rotate(45deg);margin-top:-4px}.accordion-content{max-height:0;overflow:hidden;transition:max-height .3s cubic-bezier(.4,0,.2,1);background:var(--color-white);visibility:hidden}.accordion-content[hidden]{display:block}.accordion-content.show{max-height:200rem;transition:max-height .5s ease-in-out;visibility:visible}.accordion-body{padding:var(--space-5);color:var(--color-gray-700);line-height:var(--line-height-relaxed);border-top:1px solid transparent}[data-theme=dark] .accordion{border-color:var(--color-gray-700);background:var(--color-gray-800)}[data-theme=dark] .accordion-item{background:var(--color-gray-800);border-bottom-color:var(--color-gray-700)}[data-theme=dark] .accordion-content{background:var(--color-gray-800)}[data-theme=dark] .accordion-button{color:var(--color-gray-200)}[data-theme=dark] .accordion-button:hover{background:var(--color-gray-700);color:var(--color-white)}[data-theme=dark] .accordion-button:not(.collapsed){color:var(--color-primary-light);background:rgba(var(--color-primary-rgb),.15);border-bottom-color:rgba(var(--color-primary-rgb),.2)}[data-theme=dark] .accordion-body{color:var(--color-gray-300)}[data-theme=dark] .accordion-icon{color:var(--color-gray-500)}[data-theme=dark] .accordion-button:hover .accordion-icon,[data-theme=dark] .accordion-button:not(.collapsed) .accordion-icon{color:var(--color-primary-light)}@media(prefers-reduced-motion:reduce){.accordion-content,.accordion-icon{transition:none}}.info-box{background:var(--color-secondary-alpha-05);border:1px solid var(--color-secondary-alpha-20);border-radius:var(--radius-lg);padding:var(--space-5);margin:var(--space-6) 0}.info-box h3{color:var(--color-secondary);margin:0 0 var(--space-4);font-size:var(--font-size-lg);font-weight:var(--font-weight-semibold)}.info-box ul{list-style:none;padding:0;margin:0;display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:var(--space-3)}.info-box li{color:var(--text-body);font-size:var(--font-size-sm);margin:0}.info-box strong{color:var(--color-secondary);font-weight:var(--font-weight-semibold)}.assessment-progress-bar{position:relative;height:32px;background:var(--color-gray-100);border-radius:var(--radius-md);margin-bottom:var(--space-6);overflow:hidden;border:1px solid var(--color-gray-200)}.assessment-progress-bar-fill{height:100%;background:linear-gradient(90deg,var(--color-primary) 0%,var(--color-secondary) 100%);transition:width .4s ease;border-radius:var(--radius-md)}.assessment-progress-bar-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:var(--text-body);font-size:var(--font-size-sm);font-weight:var(--font-weight-semibold);z-index:1;text-shadow:0 1px 2px rgba(255,255,255,.8)}.nav-bar{display:flex;justify-content:space-between;align-items:center;gap:var(--space-4);padding:var(--space-5);background:var(--color-gray-50);border-radius:var(--radius-lg);border:1px solid var(--color-gray-200);margin-bottom:var(--space-6)}.assessment-review-section{margin-bottom:var(--space-6)}.assessment-review-section h3{color:var(--color-secondary);margin:0 0 var(--space-5) 0;font-size:var(--font-size-xl);font-weight:var(--font-weight-semibold)}.review-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--space-4);margin-bottom:var(--space-6)}.review-item{background:var(--color-white);border:2px solid var(--color-gray-200);border-radius:var(--radius-lg);padding:var(--space-5);transition:all var(--transition-normal)}.review-item.completed{border-color:var(--color-success-alpha-30);background:var(--color-success-alpha-05)}.review-item.incomplete{border-color:var(--color-warning-alpha-30);background:var(--color-warning-alpha-05)}.review-item:hover{box-shadow:var(--shadow-md);transform:translateY(-2px)}.review-item-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-3);padding-bottom:var(--space-3);border-bottom:1px solid var(--color-gray-200)}.review-item-number{font-weight:var(--font-weight-semibold);color:var(--color-secondary);font-size:var(--font-size-base)}.review-item-status{font-size:var(--font-size-sm);font-weight:var(--font-weight-medium)}.review-item.completed .review-item-status{color:var(--color-success)}.review-item.incomplete .review-item-status{color:var(--color-warning)}.review-item-prompt{color:var(--text-body);font-size:var(--font-size-sm);margin-bottom:var(--space-4);line-height:var(--line-height-relaxed);display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.review-item-edit{background:transparent;border:none;color:var(--color-primary);font-size:var(--font-size-sm);font-weight:var(--font-weight-medium);cursor:pointer;padding:0;text-decoration:underline;transition:color var(--transition-fast)}.review-item-edit:hover{color:var(--color-secondary)}.review-actions{display:flex;justify-content:space-between;align-items:center;gap:var(--space-4);padding:var(--space-5);background:var(--color-gray-50);border-radius:var(--radius-lg);border:1px solid var(--color-gray-200)}.assessment-submit-section{display:flex;flex-direction:column;align-items:center;gap:var(--space-3);padding:var(--space-6);background:var(--color-gray-50);border-radius:var(--radius-lg);border:1px solid var(--color-gray-200);margin-bottom:var(--space-6)}.btn-submit.btn-lg{padding:var(--space-4) var(--space-8);font-size:var(--font-size-lg);box-shadow:var(--shadow-md)}.btn-submit.btn-lg:hover:not(:disabled){box-shadow:var(--shadow-lg)}.submit-help{color:var(--text-muted);font-size:var(--font-size-sm);margin:0;text-align:center}.result-card{background:var(--color-white);border:2px solid var(--color-gray-200);border-radius:var(--radius-md);padding:var(--space-4);transition:border-color .2s ease}.result-card.correct{border-color:var(--color-success);background:var(--color-success-alpha-05)}.result-card.incorrect{border-color:var(--color-error);background:var(--color-error-alpha-05)}.results-list .assessment-list-item{flex-direction:column;align-items:stretch}.result-item-content{display:flex;flex-direction:column;gap:var(--space-3);width:100%}.response-box{margin-top:var(--space-3);padding:var(--space-3);border-radius:var(--radius-lg);background:var(--color-gray-50)}.response-box>p:first-child{margin-top:0;margin-bottom:var(--space-2);font-weight:var(--font-weight-semibold);font-size:var(--font-size-sm);color:var(--color-text-secondary)}.response-box.correct{background:var(--color-success-alpha-05);border:1px solid var(--color-success-alpha-20)}.response-item,.correct-item{margin:var(--space-1) 0;padding-left:var(--space-2);line-height:var(--line-height-relaxed);color:var(--color-gray-900)}.response-item:first-of-type,.correct-item:first-of-type{margin-top:0}.response-item:last-of-type,.correct-item:last-of-type{margin-bottom:0}.badge{display:inline-flex;align-items:center;justify-content:center;padding:var(--space-1) var(--space-3);font-size:var(--font-size-xs);font-weight:var(--font-weight-semibold);line-height:1;border-radius:var(--radius-full);white-space:nowrap}.badge-success{background:var(--color-success-light);color:var(--color-success)}.badge-warning{background:var(--color-warning-light);color:var(--color-warning)}.badge-error{background:var(--color-error-light);color:var(--color-error)}.badge-secondary{background:var(--color-gray-100);color:var(--color-gray-700)}.badge.status-answered{background:var(--color-success-light);color:var(--color-success)}.badge.status-unanswered{background:var(--color-warning-light);color:var(--color-warning)}.assessment-section-header{margin-bottom:var(--space-6);padding-bottom:var(--space-4);border-bottom:1px solid var(--color-gray-200)}.assessment-section-header h3{color:var(--color-secondary);margin:0 0 var(--space-3) 0;font-size:var(--font-size-xl)}.assessment-instructions{color:var(--text-muted);margin:0;font-size:var(--font-size-base);line-height:var(--line-height-relaxed)}.question-container{margin-top:var(--space-4)}.assessment-controls{display:flex;justify-content:space-between;align-items:center;padding:var(--space-5);background:var(--color-gray-50);border-radius:var(--radius-lg);margin-top:var(--space-6);border:1px solid var(--color-gray-200)}.assessment-list{list-style:none;padding:0;margin:0;border-radius:var(--radius-lg)}.assessment-list-item{padding:var(--space-4);background:var(--color-white);border:1px solid var(--color-gray-300);border-top-width:0;display:flex;align-items:center;gap:var(--space-3)}.assessment-list-item:first-child{border-top-width:1px;border-top-left-radius:var(--radius-lg);border-top-right-radius:var(--radius-lg)}.assessment-list-item:last-child{border-bottom-left-radius:var(--radius-lg);border-bottom-right-radius:var(--radius-lg)}.assessment-list-flush{border-radius:0}.assessment-list-flush .assessment-list-item{border-left:0;border-right:0;border-radius:0}.assessment-list-flush .assessment-list-item:first-child{border-top:0}.assessment-list-flush .assessment-list-item:last-child{border-bottom:0}@media(max-width:768px){.review-grid{grid-template-columns:1fr}.review-actions{flex-direction:column}.review-actions button{width:100%}.info-box ul{grid-template-columns:1fr}}.btn,.nav-btn,.btn-nav,.btn-submit,button[type=submit],button[type=button]{display:inline-flex;align-items:center;justify-content:center;gap:var(--space-2);padding:var(--btn-padding-y) var(--btn-padding-x);border-radius:var(--btn-border-radius);font-size:var(--btn-font-size);font-weight:var(--btn-font-weight);line-height:1;text-decoration:none;border:2px solid transparent;cursor:pointer;transition:var(--btn-transition);font-family:inherit;appearance:none;-webkit-appearance:none;-moz-appearance:none}.btn-primary,.btn-submit,.nav-btn.active,.nav-btn[aria-pressed=true],.btn-nav:not(:disabled):not(.btn-secondary):not(.btn-reset){background:var(--color-primary);color:var(--color-white);border-color:var(--color-primary)}.btn-primary:hover:not(:disabled),.btn-submit:hover:not(:disabled),.nav-btn.active:hover,.btn-nav:hover:not(:disabled):not(.btn-secondary):not(.btn-reset){background:var(--color-primary-hover);border-color:var(--color-primary-hover);box-shadow:var(--shadow-md);transform:translateY(-2px)}.btn-primary:active:not(:disabled),.btn-submit:active:not(:disabled),.btn-nav:active:not(:disabled):not(.btn-secondary):not(.btn-reset){transform:translateY(0);box-shadow:var(--shadow-sm)}.btn-secondary,.nav-btn:not(.active),.btn-nav.btn-secondary{background:var(--color-white);color:var(--color-gray-700);border-color:var(--color-gray-300)}.btn-secondary:hover:not(:disabled),.nav-btn:not(.active):hover,.btn-nav.btn-secondary:hover:not(:disabled){background:var(--color-gray-50);border-color:var(--color-secondary);color:var(--color-secondary);box-shadow:var(--shadow-md);transform:translateY(-2px)}.btn-success,.btn-check{background:var(--color-accent);color:var(--color-white);border-color:var(--color-accent)}.btn-success:hover:not(:disabled),.btn-check:hover:not(:disabled){background:var(--color-accent-hover);border-color:var(--color-accent-hover);box-shadow:var(--shadow-md);transform:translateY(-2px)}.btn-reset{background:var(--color-gray-300);color:var(--color-gray-700);border-color:var(--color-gray-300)}.btn-reset:hover:not(:disabled){background:var(--color-gray-400);border-color:var(--color-gray-400);box-shadow:var(--shadow-md);transform:translateY(-2px)}.btn-hint,.btn-info{background:var(--color-info);color:var(--color-white);border-color:var(--color-info)}.btn-hint:hover:not(:disabled),.btn-info:hover:not(:disabled){background:var(--color-info);border-color:var(--color-info);filter:brightness(.9);box-shadow:var(--shadow-md);transform:translateY(-2px)}.btn-warning{background:var(--color-warning);color:var(--color-gray-900);border-color:var(--color-warning)}.btn-warning:hover:not(:disabled){background:var(--color-warning);border-color:var(--color-warning);filter:brightness(.9);box-shadow:var(--shadow-md);transform:translateY(-2px)}.btn-danger{background:var(--color-error);color:var(--color-white);border-color:var(--color-error)}.btn-danger:hover:not(:disabled){background:var(--color-error);border-color:var(--color-error);filter:brightness(.9);box-shadow:var(--shadow-md);transform:translateY(-2px)}.btn-gradient{display:inline-flex;align-items:center;justify-content:center;gap:var(--space-2);padding:var(--btn-padding-y) var(--btn-padding-x);border-radius:var(--btn-border-radius);font-size:var(--btn-font-size);font-weight:var(--btn-font-weight);min-height:var(--btn-min-height);background:var(--gradient-primary);color:var(--color-white);border:2px solid transparent;border-color:transparent;box-shadow:0 4px 12px var(--color-secondary-alpha-30);position:relative;overflow:hidden;cursor:pointer;transition:var(--btn-transition);font-family:inherit}.btn-gradient:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:var(--gradient-shimmer);transition:left .5s;pointer-events:none}.btn-gradient:hover:not(:disabled):before{left:100%}.btn-gradient:hover:not(:disabled){background:var(--gradient-header);box-shadow:0 6px 20px rgba(131,8,255,.4);transform:translateY(-2px)}.btn-gradient:active:not(:disabled){transform:translateY(0);box-shadow:0 2px 8px var(--color-secondary-alpha-30)}.btn-sm{padding:var(--space-2) var(--space-4);font-size:var(--font-size-sm)}.btn-lg{padding:var(--space-4) var(--space-6);font-size:var(--font-size-lg)}.btn-outline-primary{background:transparent;color:var(--color-primary);border-color:var(--color-primary)}.btn-outline-primary:hover:not(:disabled){background:var(--color-primary);color:var(--color-white);box-shadow:var(--shadow-md);transform:translateY(-2px)}.btn-outline-secondary{background:transparent;color:var(--color-secondary);border-color:var(--color-secondary)}.btn-outline-secondary:hover:not(:disabled){background:var(--color-secondary);color:var(--color-white);box-shadow:var(--shadow-md);transform:translateY(-2px)}.btn-gradient:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}.btn:disabled,.nav-btn:disabled,.btn-nav:disabled,.btn-submit:disabled,button:disabled{cursor:not-allowed;transform:none;box-shadow:none;background:var(--color-gray-100);color:var(--color-gray-700);border-color:var(--color-gray-300)}.btn:disabled:hover,.nav-btn:disabled:hover,.btn-nav:disabled:hover,.btn-submit:disabled:hover,button:disabled:hover{background:var(--color-gray-100);color:var(--color-gray-700);border-color:var(--color-gray-300);transform:none;box-shadow:none}.btn:focus-visible,.nav-btn:focus-visible,.btn-nav:focus-visible,.btn-submit:focus-visible,button:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}.callout{position:relative;padding:var(--space-4);margin:var(--space-4) 0;border:1px solid transparent;border-radius:var(--radius-lg);border-left-width:4px;box-shadow:var(--shadow-sm);overflow:hidden}.callout p{margin:0;line-height:var(--line-height-relaxed)}.callout h3{margin-top:0;margin-bottom:var(--space-2);font-size:var(--font-size-lg);font-weight:var(--font-weight-bold)}.callout.callout-info{background-color:var(--color-info-light);border-left-color:var(--color-info);color:var(--color-gray-900)}.callout.callout-info h3{color:var(--color-info)}.callout.callout-success{background-color:var(--color-success-light);border-left-color:var(--color-success);color:var(--color-gray-900)}.callout.callout-success h3{color:var(--color-success)}.callout.callout-warning{background-color:var(--color-warning-light);border-left-color:var(--color-warning);color:var(--color-gray-900)}.callout.callout-warning h3{color:var(--color-warning)}.callout.callout-error{background-color:var(--color-error-light);border-left-color:var(--color-error);color:var(--color-gray-900)}.callout.callout-error h3{color:var(--color-error)}.alert{position:relative;padding:var(--space-4) var(--space-8) var(--space-4) var(--space-4);margin-bottom:var(--space-4);border:1px solid transparent;border-radius:var(--radius-lg);border-left-width:4px;box-shadow:var(--shadow-sm);overflow:hidden}.alert p{margin:0;line-height:var(--line-height-normal)}.alert-info{color:#0c5460;background-color:var(--color-info-light);border-color:var(--color-info)}.alert-success{color:#155724;background-color:var(--color-success-light);border-color:var(--color-success)}.alert-warning{color:#856404;background-color:var(--color-warning-light);border-color:var(--color-warning)}.alert-error{color:#721c24;background-color:var(--color-error-light);border-color:var(--color-error)}.alert-close{position:absolute;top:50%;right:var(--space-4);transform:translateY(-50%);background:transparent;border:none;font-size:1.5rem;font-weight:700;line-height:1;color:inherit;opacity:.7;cursor:pointer;padding:0 var(--space-2)}.alert-close:hover{opacity:1}.card,.feature-card,.concept-card,.stat-card{background:var(--color-white);border:1px solid var(--color-gray-300);border-radius:var(--radius-lg);padding:var(--space-6);margin-bottom:var(--space-4);box-shadow:var(--shadow-sm);transition:all var(--transition-normal);position:relative;overflow:hidden;box-sizing:border-box}.card:before,.feature-card:before,.concept-card:before,.stat-card:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,var(--color-secondary-alpha-05),transparent);transition:left var(--transition-slow)}.card:hover,.feature-card:hover,.concept-card:hover,.stat-card:hover{box-shadow:var(--shadow-lg);border-color:var(--color-secondary);transform:translateY(-4px)}.card:hover:before,.feature-card:hover:before,.concept-card:hover:before,.stat-card:hover:before{left:100%}.card.no-hover,.feature-card.no-hover,.concept-card.no-hover,.stat-card.no-hover{transition:none;overflow:visible}.card.no-hover:hover,.feature-card.no-hover:hover,.concept-card.no-hover:hover,.stat-card.no-hover:hover{box-shadow:var(--shadow-sm);border-color:var(--color-gray-300);transform:none}.card.no-hover:before,.feature-card.no-hover:before,.concept-card.no-hover:before,.stat-card.no-hover:before{display:none}.carousel{position:relative;width:100%;overflow:hidden;border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);min-height:400px;background:var(--color-gray-100);isolation:isolate;display:flex;flex-direction:column}.carousel-track{display:flex;transition:transform .5s cubic-bezier(.25,1,.5,1);flex:1;height:100%}.carousel-slide{flex:0 0 100%;width:100%;height:100%;position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;background-color:var(--color-gray-50);padding:var(--space-6);box-sizing:border-box}.carousel-slide img{width:100%;height:100%;object-fit:cover;display:block}.carousel-button{position:absolute;top:50%;transform:translateY(-50%);width:48px;height:48px;border-radius:50%;background-color:rgba(255,255,255,.9);color:var(--color-gray-900);border:1px solid rgba(0,0,0,.1);box-shadow:var(--shadow-md);font-size:1.5rem;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;transition:all .2s ease;opacity:0;padding:0;line-height:1}.carousel:hover .carousel-button,.carousel-button:focus-visible{opacity:1}.carousel-button:hover:not(:disabled){background-color:#fff;transform:translateY(-50%) scale(1.1);box-shadow:var(--shadow-lg);color:var(--color-primary)}.carousel-button:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}.carousel-button:disabled{opacity:0;cursor:default;pointer-events:none}.carousel-button.prev{left:16px}.carousel-button.next{right:16px}.carousel-dots{position:absolute;bottom:20px;left:50%;transform:translate(-50%);display:flex;gap:8px;z-index:10;padding:8px 12px;background-color:rgba(0,0,0,.3);backdrop-filter:blur(4px);border-radius:20px}.carousel-dot{width:10px;height:10px;border-radius:50%;background-color:rgba(255,255,255,.5);border:none;cursor:pointer;padding:0;transition:all .3s ease}.carousel-dot:hover{background-color:rgba(255,255,255,.8)}.carousel-dot.active{background-color:#fff;transform:scale(1);width:24px;border-radius:10px}.carousel-dot:focus-visible{outline:2px solid white;outline-offset:2px}.carousel-caption{position:absolute;bottom:0;left:0;right:0;padding:60px 20px 20px;background:linear-gradient(to top,rgba(0,0,0,.8),transparent);color:#fff;text-align:center;pointer-events:none}.carousel-caption h3{color:#fff;margin-bottom:.5rem;font-size:var(--font-size-lg)}.carousel-caption p{color:rgba(255,255,255,.9);margin:0;font-size:var(--font-size-sm)}.checkbox-group{display:flex;flex-direction:column;gap:var(--space-3)}.checkbox-option{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-4);border:2px solid var(--color-gray-300);border-radius:var(--radius-lg);cursor:pointer;transition:all var(--transition-fast);background:var(--color-white);position:relative}.checkbox-option:hover{border-color:var(--color-secondary);background:var(--color-gray-50)}.checkbox-option input[type=checkbox]{position:absolute;opacity:0;width:0;height:0;margin:0;padding:0;border:none}.checkbox-custom{width:24px;height:24px;border:2px solid var(--color-gray-400);border-radius:var(--radius-md);position:relative;flex-shrink:0;transition:all var(--transition-fast);background:var(--color-white)}.checkbox-custom:after{content:"✓";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);color:var(--color-white);font-size:16px;font-weight:700;transition:transform var(--transition-fast)}.checkbox-option input[type=checkbox]:checked~.checkbox-custom{background:var(--color-secondary);border-color:var(--color-secondary)}.checkbox-option input[type=checkbox]:checked~.checkbox-custom:after{transform:translate(-50%,-50%) scale(1)}.checkbox-option input[type=checkbox]:focus-visible~.checkbox-custom{outline:3px solid var(--color-primary);outline-offset:2px}.checkbox-option input[type=checkbox]:disabled~.checkbox-custom{opacity:.5;cursor:default}.checkbox-option:has(input[type=checkbox]:checked){border-color:var(--color-secondary);background:rgba(131,8,255,.05)}.checkbox-label{font-size:var(--font-size-base);color:var(--color-gray-900);font-weight:var(--font-weight-medium);flex:1}.checkbox-description{font-size:var(--font-size-sm);color:var(--color-gray-600);margin-top:var(--space-1)}.collapse-panel{max-height:0;overflow:hidden;transition:max-height .35s ease-in-out}.collapse-trigger{background:none;border:none;color:var(--color-primary);text-decoration:underline;cursor:pointer;padding:var(--space-1) 0;font-weight:var(--font-weight-semibold)}.collapse-trigger:hover{color:var(--color-primary-hover, var(--color-primary))}.collapse-text-hide,.expanded .collapse-text-show{display:none}.expanded .collapse-text-hide{display:inline}.expanded .collapse-panel{max-height:150rem;transition:max-height .5s ease-in}@media(prefers-reduced-motion:reduce){.collapse-panel{transition:none}.expanded .collapse-panel{max-height:none}}.custom-dropdown{position:relative;display:inline-block;width:100%}button.dropdown-trigger{width:100%;padding:var(--space-3) var(--space-4);background-color:var(--color-white);border:2px solid var(--color-gray-300);border-radius:var(--radius-lg);text-align:left;cursor:pointer;display:flex;justify-content:space-between;align-items:center;font-size:var(--font-size-base);color:var(--color-gray-900);transition:all var(--transition-fast)}button.dropdown-trigger:focus-visible{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 3px var(--color-primary-alpha-10)}button.dropdown-trigger:hover{border-color:var(--color-secondary)}button.dropdown-trigger:after{content:"▼";font-size:.8em;margin-left:var(--space-2);color:var(--color-gray-500);transition:transform var(--transition-fast)}button.dropdown-trigger[aria-expanded=true]:after{transform:rotate(180deg)}.dropdown-menu{display:none;position:absolute;top:100%;left:0;right:0;background-color:var(--color-white);border:1px solid var(--color-gray-300);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);z-index:100;margin-top:var(--space-1);max-height:200px;overflow-y:auto}.dropdown-menu.active{display:block}.dropdown-item{padding:var(--space-2) var(--space-4);cursor:pointer;transition:background-color var(--transition-fast);color:var(--color-gray-900)}.dropdown-item:hover{background-color:var(--color-gray-100)}.dropdown-item.selected{background-color:var(--color-primary-alpha-10);color:var(--color-primary);font-weight:var(--font-weight-medium)}.engagement-indicator-footer{display:flex;align-items:center;justify-content:center;margin-left:var(--space-8);position:relative;opacity:1}.engagement-indicator-footer[hidden]{display:none}.engagement-circle{display:block;transform:rotate(-90deg);filter:drop-shadow(0 1px 2px rgba(0,0,0,.1))}.engagement-track{stroke:var(--color-gray-400)}.engagement-progress{stroke:var(--color-primary);transition:stroke-dashoffset .4s cubic-bezier(.4,0,.2,1),stroke .3s ease;transform-origin:center}.engagement-progress.complete{stroke:var(--color-success);animation:pulse-success .6s ease-out}@keyframes pulse-success{0%{opacity:1}50%{opacity:.7;filter:drop-shadow(0 0 6px var(--color-success))}to{opacity:1}}.engagement-checkmark{fill:var(--color-success);font-weight:700;opacity:0;transition:opacity .3s ease .2s;pointer-events:none;transform:rotate(90deg);transform-origin:center}.engagement-indicator{background:var(--color-white);border:1px solid var(--color-border);border-radius:var(--radius-lg);padding:var(--space-4);margin:var(--space-4) 0;box-shadow:var(--shadow-sm)}.engagement-indicator--top{margin-bottom:var(--space-6)}.engagement-indicator--bottom{margin-top:var(--space-6)}.engagement-progress-bar{position:relative;width:100%;height:32px;background:var(--color-neutral-100);border-radius:var(--radius-md);overflow:hidden;margin-bottom:var(--space-3)}.engagement-progress-fill{height:100%;width:var(--progress, 0%);background:linear-gradient(90deg,var(--color-primary),var(--color-secondary));transition:width .5s ease;border-radius:var(--radius-md)}.engagement-progress-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:var(--font-size-sm);font-weight:var(--font-weight-semibold);color:var(--text-primary);text-shadow:0 1px 2px rgba(255,255,255,.8);z-index:1}.engagement-checklist{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:var(--space-2)}.engagement-checklist-item{display:flex;align-items:center;gap:var(--space-2);padding:var(--space-2);border-radius:var(--radius-md);transition:background var(--transition-fast)}.engagement-checklist-item.incomplete{color:var(--text-muted)}.engagement-checklist-item.complete{color:var(--color-success);font-weight:var(--font-weight-medium)}.engagement-icon{flex-shrink:0;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:var(--font-size-lg);line-height:1}.engagement-checklist-item.incomplete .engagement-icon{color:var(--text-muted)}.engagement-checklist-item.complete .engagement-icon{color:var(--color-success)}.engagement-label{flex:1;font-size:var(--font-size-sm)}.engagement-complete{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-3);background:var(--color-success-alpha-10);border:1px solid var(--color-success-alpha-20);border-radius:var(--radius-md);color:var(--color-success);font-weight:var(--font-weight-semibold)}.engagement-complete .engagement-icon{font-size:var(--font-size-xl)}[data-theme=dark] .engagement-track{stroke:var(--color-gray-700)}[data-theme=dark] .engagement-circle{filter:drop-shadow(0 1px 3px rgba(0,0,0,.3))}[data-accessibility=high-contrast] .engagement-progress{stroke-width:4}[data-accessibility=high-contrast] .engagement-track{stroke-width:4;opacity:.8}@media(prefers-reduced-motion:reduce){.engagement-progress,.engagement-checkmark{transition:none}.engagement-progress.complete{animation:none}}@media(max-width:768px){.engagement-circle{width:28px;height:28px}.engagement-indicator-footer{margin-left:var(--space-2)}.engagement-indicator{padding:var(--space-3)}.engagement-progress-bar{height:28px}.engagement-progress-text,.engagement-label{font-size:var(--font-size-xs)}}@media(max-width:480px){.engagement-circle{width:24px;height:24px}.engagement-checkmark{font-size:14px}}.flip-card{background-color:transparent;perspective:1000px;min-height:280px;cursor:pointer}.flip-card-inner{position:relative;width:100%;min-height:280px;text-align:center;transition:transform .6s cubic-bezier(.4,0,.2,1);transform-style:preserve-3d}.flip-card.is-flipped .flip-card-inner{transform:rotateY(180deg)}.flip-card-front,.flip-card-back{position:absolute;width:100%;height:100%;box-sizing:border-box;-webkit-backface-visibility:hidden;backface-visibility:hidden;border-radius:var(--radius-lg);padding:var(--space-6);box-shadow:var(--shadow-md);display:flex;flex-direction:column;justify-content:center;align-items:center;border:1px solid var(--color-gray-300);background-color:var(--color-white)}.flip-card-front{color:var(--color-text);z-index:2}.flip-card-back{transform:rotateY(180deg);background-color:var(--color-primary);color:var(--color-white);border-color:var(--color-primary);z-index:1}.flip-card-back .flip-card-title,.flip-card-back .flip-card-text{color:var(--color-white);text-shadow:0 1px 2px rgba(0,0,0,.2)}.flip-card-back.bg-light{background-color:var(--color-gray-50);color:var(--color-text);border-color:var(--color-gray-300)}.flip-card-back.bg-light .flip-card-title,.flip-card-back.bg-light .flip-card-text{color:var(--color-text);text-shadow:none}.flip-card-back.bg-secondary{background-color:var(--color-secondary);border-color:var(--color-secondary);color:var(--color-text)}.flip-card-back.bg-dark{background-color:var(--color-gray-900);border-color:var(--color-gray-900)}.flip-card-icon{font-size:3rem;margin-bottom:var(--space-4);display:block}.flip-card-title{font-size:var(--font-size-lg);font-weight:var(--font-weight-bold);margin-bottom:var(--space-2)}.flip-card-text{font-size:var(--font-size-md);line-height:1.5}footer{display:flex;justify-content:space-between;align-items:center;gap:var(--space-3);padding:var(--footer-padding-y) var(--footer-padding-x);border-top:2px solid var(--color-gray-200);background:var(--color-white);flex-shrink:0}#app:has(#loading:not([style*="display: none"])) footer{display:none;z-index:var(--z-fixed)}.nav-controls{display:flex;gap:var(--space-3);align-items:center;flex:1;justify-content:space-between}.nav-controls .nav-nav-buttons{display:flex;gap:var(--space-3);align-items:center}.nav-controls .nav-exit-button{margin-left:auto}[data-theme=dark] footer{background:var(--color-gray-800);border-top-color:var(--color-gray-600)}.form-group{margin-bottom:var(--space-5)}.form-label{display:block;font-size:var(--font-size-sm);font-weight:var(--font-weight-semibold);color:var(--color-gray-700);margin-bottom:var(--space-2)}.form-label.required:after{content:" *";color:var(--color-error)}.form-help{display:block;font-size:var(--font-size-xs);color:var(--color-gray-500);margin-top:var(--space-2)}.form-error{display:block;font-size:var(--font-size-sm);color:var(--color-error);margin-top:var(--space-2);font-weight:var(--font-weight-medium)}.form-success{display:block;font-size:var(--font-size-sm);color:var(--color-success);margin-top:var(--space-2);font-weight:var(--font-weight-medium)}input,textarea{width:100%;padding:var(--space-3) var(--space-4);border:2px solid var(--color-gray-300);border-radius:var(--radius-lg);font-size:var(--font-size-base);font-family:inherit;color:var(--color-gray-900);background:var(--color-white);transition:all var(--transition-fast);box-shadow:var(--shadow-sm);box-sizing:border-box}input:focus,textarea:focus{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 3px var(--color-primary-alpha-10)}input:disabled,textarea:disabled{background:var(--color-gray-100);color:var(--color-gray-400);border-color:var(--color-gray-200);cursor:default}textarea{resize:vertical;min-height:80px;max-width:100%}select{width:100%;padding:var(--space-3) var(--space-4);border:2px solid var(--color-gray-300);border-radius:var(--radius-lg);font-size:var(--font-size-base);font-family:inherit;color:var(--color-gray-900);background:var(--color-white);cursor:pointer;transition:all var(--transition-fast);box-shadow:var(--shadow-sm);box-sizing:border-box;min-height:44px}select:focus{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 3px var(--color-primary-alpha-10)}select:disabled{background:var(--color-gray-100);color:var(--color-gray-400);border-color:var(--color-gray-200);cursor:default}.radio-group{display:flex;flex-direction:column;gap:var(--space-3)}.radio-option{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-4);border:2px solid var(--color-gray-300);border-radius:var(--radius-lg);cursor:pointer;transition:all var(--transition-fast);background:var(--color-white);position:relative}.radio-option:hover{border-color:var(--color-secondary);background:var(--color-gray-50)}.radio-option input[type=radio]{position:absolute;opacity:0;width:0;height:0}.radio-custom{width:24px;height:24px;border:2px solid var(--color-gray-400);border-radius:50%;position:relative;flex-shrink:0;transition:all var(--transition-fast);background:var(--color-white)}.radio-custom:after{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);width:12px;height:12px;border-radius:50%;background:var(--color-secondary);transition:transform var(--transition-fast)}.radio-option input[type=radio]:checked~.radio-custom{border-color:var(--color-secondary);background:var(--color-white)}.radio-option input[type=radio]:checked~.radio-custom:after{transform:translate(-50%,-50%) scale(1)}.radio-option input[type=radio]:focus-visible~.radio-custom{outline:3px solid var(--color-primary);outline-offset:2px}.radio-option input[type=radio]:disabled~.radio-custom{opacity:.5;cursor:default}.radio-option:has(input[type=radio]:checked){border-color:var(--color-secondary);background:rgba(131,8,255,.05)}.radio-label{font-size:var(--font-size-base);color:var(--color-gray-900);font-weight:var(--font-weight-medium);flex:1}.radio-description{font-size:var(--font-size-sm);color:var(--color-gray-600);margin-top:var(--space-1)}#loading{display:flex;align-items:center;justify-content:center;min-height:200px;color:var(--text-muted);font-style:italic}.modal-backdrop{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:var(--z-modal-backdrop);display:none;opacity:0;transition:opacity var(--transition-normal);backdrop-filter:blur(4px)}.modal-backdrop.active{display:block;opacity:1}.modal{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(.9);background:var(--color-white);border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);z-index:var(--z-modal);max-width:90%;max-height:90vh;width:600px;display:none;opacity:0;transition:all var(--transition-normal);overflow:hidden}.modal.active{display:block;opacity:1;transform:translate(-50%,-50%) scale(1)}.modal-header{display:flex;align-items:center;justify-content:space-between;padding:var(--space-4);border-bottom:2px solid var(--color-gray-200);background:var(--color-gray-100)}.modal-title{margin:0;font-size:var(--font-size-2xl);font-weight:var(--font-weight-semibold);color:var(--color-primary)}.modal-close{background:transparent;border:none;font-size:var(--font-size-xl);color:var(--color-gray-600);cursor:pointer;padding:var(--space-2);border-radius:var(--radius-md);transition:all var(--transition-fast);min-width:var(--btn-min-height);min-height:var(--btn-min-height);display:flex;align-items:center;justify-content:center}.modal-close:hover{background:var(--color-gray-200);color:var(--color-gray-900)}.modal-close:focus-visible{outline:3px solid var(--color-primary);outline-offset:2px}.modal-body{padding:var(--space-6);overflow-y:auto;overflow-x:hidden;max-height:calc(90vh - 180px);box-sizing:border-box}.modal-body *{box-sizing:border-box;max-width:100%}.modal-body input,.modal-body textarea,.modal-body select{width:100%;box-sizing:border-box}.modal-body .form-group{margin-bottom:var(--space-4)}.modal-body .select-wrapper{width:100%}.modal-footer{display:flex;align-items:center;justify-content:flex-end;gap:var(--space-3);padding:var(--space-4);border-top:2px solid var(--color-gray-200);background:var(--color-gray-100)}.modal-sm{width:400px}.modal-lg{width:800px}.modal-xl{width:1000px}@media(prefers-reduced-motion:reduce){.modal-backdrop,.modal{transition:none}.modal.active{transform:translate(-50%,-50%) scale(1)}}.notification-container{position:absolute;top:var(--space-4);right:var(--space-4);z-index:1100;display:flex;flex-direction:column;gap:var(--space-2);max-width:400px;width:calc(100% - var(--space-8));pointer-events:none}.notification{background:var(--color-white);border-left:4px solid var(--color-info);box-shadow:var(--shadow-lg);padding:var(--space-3) var(--space-4);border-radius:var(--radius-md);pointer-events:auto;transition:all .3s ease;opacity:0;transform:translate(20px);animation:notificationSlideIn .3s forwards;display:flex;align-items:flex-start;justify-content:space-between;gap:var(--space-3);margin-bottom:var(--space-2)}@keyframes notificationSlideIn{to{opacity:1;transform:translate(0)}}@keyframes notificationSlideOut{to{opacity:0;transform:translate(100%)}}.notification-success{border-left-color:var(--color-success);background-color:var(--color-success-light)}.notification-error{border-left-color:var(--color-error);background-color:var(--color-error-light)}.notification-warning{border-left-color:var(--color-warning);background-color:var(--color-warning-light)}.notification-info{border-left-color:var(--color-info);background-color:var(--color-info-light)}.notification-close{background:transparent;border:none;color:var(--color-text-muted);cursor:pointer;padding:0;font-size:1.25rem;line-height:1;opacity:.6;flex-shrink:0;margin-top:-2px}.notification-close:hover{opacity:1;color:var(--color-text)}.notification-message{font-size:var(--font-size-sm);color:var(--color-text);line-height:1.4;flex-grow:1}@media(max-width:480px){.notification-container{top:var(--space-2);right:var(--space-2);left:var(--space-2);width:auto;max-width:none}}.sidebar-toggle{display:flex;align-items:center;justify-content:center;width:var(--btn-min-height);height:var(--btn-min-height);background:transparent;border:none;border-radius:var(--radius-md);cursor:pointer;transition:all var(--transition-normal);color:var(--color-white);font-size:var(--font-size-2xl);margin-right:var(--space-4);flex-shrink:0;position:relative}.sidebar-toggle:hover{background:var(--color-white-alpha-25);transform:translateY(-1px)}.sidebar-toggle:focus-visible{outline:2px solid var(--color-white);outline-offset:2px}.sidebar-toggle:active{background:var(--color-white-alpha-35);transform:scale(.95)}.sidebar-toggle .toggle-icon{display:block;line-height:1;user-select:none;transition:transform var(--transition-normal)}.sidebar-toggle[aria-expanded=true] .toggle-icon{transform:rotate(90deg)}#accessibility-menu{position:absolute;top:calc(100% + var(--space-2));right:var(--space-6);background:var(--color-white);border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);padding:var(--space-2);min-width:200px;z-index:var(--z-dropdown);border:1px solid var(--color-gray-200)}#accessibility-menu[hidden]{display:none}#accessibility-menu button{width:100%;display:flex;align-items:center;gap:var(--space-3);padding:var(--space-3) var(--space-4);background:transparent;border:none;border-radius:var(--radius-md);cursor:pointer;transition:all var(--transition-fast);color:var(--color-gray-900);font-size:var(--font-size-sm);text-align:left}#accessibility-menu button:hover{background:var(--color-gray-100)}#accessibility-menu button:focus-visible{outline:2px solid var(--color-primary);outline-offset:-2px}#accessibility-menu button span:first-child{font-size:var(--font-size-lg);flex-shrink:0}#accessibility-menu .menu-label{flex:1;font-weight:var(--font-weight-medium)}.sidebar{position:absolute;top:0;left:0;width:var(--sidebar-width, 280px);height:100%;background:var(--color-white);border-right:1px solid var(--color-gray-200);display:flex;flex-direction:column;overflow:hidden;z-index:100;box-shadow:var(--shadow-xl);transition:transform var(--transition-slow);will-change:transform}.sidebar.collapsed{transform:translate(-100%)}.sidebar.position-right{left:auto;right:0;border-right:none;border-left:1px solid var(--color-gray-200)}.sidebar.position-right.collapsed{transform:translate(100%)}.app-body.sidebar-static .sidebar{position:relative;flex:0 0 var(--sidebar-width, 280px);height:100%;transform:none!important;box-shadow:none;z-index:auto}.app-body.sidebar-static .sidebar.collapsed{transform:none}.app-body.sidebar-static-right{flex-direction:row-reverse}.app-body.sidebar-static-right .sidebar{border-left:1px solid var(--color-gray-200);border-right:none}@media(prefers-reduced-motion:reduce){.sidebar,.sidebar-backdrop{transition:none}}nav#menu{flex:1;overflow-y:auto;overflow-x:hidden;padding:var(--space-4) 0;scrollbar-width:thin;scrollbar-color:var(--color-gray-300) transparent}nav#menu::-webkit-scrollbar{width:6px}nav#menu::-webkit-scrollbar-track{background:transparent}nav#menu::-webkit-scrollbar-thumb{background:var(--color-gray-300);border-radius:3px}nav#menu::-webkit-scrollbar-thumb:hover{background:var(--color-gray-400)}.sidebar-backdrop{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);z-index:99;opacity:0;transition:opacity var(--transition-slow);backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px)}.sidebar-backdrop.visible{display:block;opacity:1}.app-body.sidebar-static #sidebar-backdrop{display:none!important}.nav-list,.nav-item{list-style:none;margin:0;padding:0}.nav-item a{display:flex;align-items:center;gap:var(--space-2);padding:var(--space-3) var(--space-4);color:var(--color-gray-700);text-decoration:none;font-size:var(--font-size-sm);font-weight:var(--font-weight-medium);border-left:3px solid transparent;transition:all var(--transition-fast);cursor:pointer}.nav-item a:hover{background:var(--color-secondary-alpha-05);color:var(--color-secondary);border-left-color:var(--color-secondary)}.nav-item a:focus-visible{outline:2px solid var(--color-primary);outline-offset:-2px;z-index:1}.nav-item.active a{background:var(--color-secondary-alpha-10);border-left-color:var(--color-secondary);color:var(--color-secondary);font-weight:var(--font-weight-semibold)}.nav-item.visited a{background-color:var(--color-gray-100)}.nav-item.visited.active a{background:var(--color-secondary-alpha-10);color:var(--color-secondary);font-weight:var(--font-weight-semibold)}.nav-item.visited:not(.locked) a:after{content:"✔";margin-left:auto;color:var(--color-accent);font-weight:var(--font-weight-bold)}.nav-item.locked a{color:var(--color-gray-500);cursor:not-allowed;position:relative}.nav-item.locked a .slide-icon,.nav-item.locked a .slide-label,.nav-item.locked a .lock-icon{opacity:.5}.nav-item.locked .lock-icon{margin-left:auto;font-size:var(--font-size-sm);opacity:.7}.nav-item.locked a:hover{background:transparent;border-left-color:transparent}.nav-item a.tooltip:after{bottom:calc(100% + var(--space-2));top:auto;left:50%;transform:translate(-50%);white-space:normal;max-width:200px;width:max-content;text-align:left;background:var(--color-gray-600)}.nav-item a.tooltip:before{bottom:100%;top:auto;left:50%;transform:translate(-50%);border:var(--space-2) solid transparent;border-top-color:var(--color-gray-600);border-right-color:transparent}.slide-icon,.section-icon{font-size:var(--font-size-lg);flex-shrink:0;line-height:1}.slide-label,.section-label{flex:1;line-height:var(--line-height-normal)}.nav-section{list-style:none;margin:0;padding:0}.section-toggle{-webkit-appearance:none;appearance:none;background:transparent;border:none;color:var(--color-gray-900);cursor:pointer;display:flex;align-items:center;justify-content:space-between;gap:var(--space-2);padding:var(--space-3) var(--space-4);width:100%;text-align:left;font-size:var(--font-size-sm);font-weight:var(--font-weight-semibold);transition:background var(--transition-fast)}.section-toggle:hover{background:var(--color-gray-100)}.section-toggle:focus-visible{outline:2px solid var(--color-primary);outline-offset:-2px}.toggle-indicator{font-size:var(--font-size-lg);transition:transform var(--transition-fast);color:var(--color-gray-600);flex-shrink:0;line-height:1}.nav-section.expanded .toggle-indicator{transform:rotate(90deg)}.nav-section.all-children-locked .section-toggle{color:var(--color-gray-500)!important;opacity:.6}.nav-section.all-children-locked .section-toggle:hover{background:transparent!important}.nav-section.all-children-locked .section-icon,.nav-section.all-children-locked .section-label,.nav-section.all-children-locked .toggle-indicator{color:var(--color-gray-500)!important;opacity:.7}.section-children{list-style:none;margin:0;padding:0;max-height:0;overflow:hidden;transition:max-height var(--transition-slow)}.nav-section.expanded .section-children{max-height:2000px}.section-children .nav-item a{padding-left:var(--space-8);font-size:var(--font-size-sm)}.section-children .nav-section .section-toggle{padding-left:var(--space-8)}.section-children .section-children .nav-item a{padding-left:var(--space-12);font-size:var(--font-size-xs)}@media(prefers-reduced-motion:reduce){.section-children{transition:none}.nav-section.expanded .section-children{max-height:none}}.spinner{display:inline-block;width:2rem;height:2rem;vertical-align:-.125em;border:.25em solid currentColor;border-right-color:transparent;border-radius:50%;-webkit-animation:.75s linear infinite spinner-border;animation:.75s linear infinite spinner-border;color:var(--color-primary)}.spinner-sm{width:1rem;height:1rem;border-width:.2em}.spinner-lg{width:3rem;height:3rem;border-width:.3em}@keyframes spinner-border{to{transform:rotate(360deg)}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg)}}.table{width:100%;border-collapse:collapse;margin:var(--space-4) 0;font-size:var(--font-size-base)}.table thead{background-color:var(--color-gray-100);border-bottom:2px solid var(--color-gray-300)}.table thead th{padding:var(--space-3);text-align:left;font-weight:var(--font-weight-semibold);color:var(--color-gray-900);border-right:1px solid var(--color-gray-200)}.table thead th:last-child{border-right:none}.table tbody td{padding:var(--space-3);border-bottom:1px solid var(--color-gray-200);border-right:1px solid var(--color-gray-200);color:var(--color-gray-800)}.table tbody td:last-child{border-right:none}.table tbody tr:hover{background-color:rgba(0,0,0,.02)}.table tbody tr:last-child td{border-bottom:none}.content-tabs,.assessment-tabs,.tab-list{display:flex;gap:var(--space-2);margin-bottom:var(--space-6);border-bottom:2px solid var(--color-secondary-alpha-15);padding:0;list-style:none}.tab-button,.assessment-tab{background:transparent;border:none;border-bottom:3px solid transparent;padding:var(--space-3) var(--space-5);cursor:pointer;transition:all var(--transition-normal);color:var(--text-muted);font-weight:var(--font-weight-medium);font-size:var(--font-size-base);display:flex;align-items:center;gap:var(--space-2);position:relative;border-radius:var(--radius-md) var(--radius-md) 0 0}.tab-button:hover,.assessment-tab:hover{background:var(--color-secondary-alpha-05);color:var(--color-secondary)}.tab-button:focus-visible,.assessment-tab:focus-visible{outline:2px solid var(--color-primary);outline-offset:-2px;z-index:1}.tab-button.active,.assessment-tab.active{background:var(--color-white);color:var(--color-secondary);border-bottom-color:var(--color-secondary);font-weight:var(--font-weight-semibold)}.tab-icon{font-size:1.2em;line-height:1}.tab-content,.assessment-content{display:none;animation:fadeIn .3s ease;padding:var(--space-6);background:var(--color-white);border-radius:0 var(--radius-lg) var(--radius-lg) var(--radius-lg);box-shadow:var(--shadow-sm)}.tab-content.active,.assessment-content.active{display:block}.tab-content[hidden],.assessment-content[hidden]{display:none}@keyframes fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@media(prefers-reduced-motion:reduce){.tab-content,.assessment-content{animation:none}@keyframes fadeIn{0%{opacity:1;transform:translateY(0)}to{opacity:1;transform:translateY(0)}}}.toggle-switch{position:relative;display:inline-flex;align-items:center;cursor:pointer;gap:var(--space-3);user-select:none;transition:all var(--transition-fast)}.toggle-switch input{opacity:0;width:0;height:0;position:absolute;margin:0;padding:0;border:none}.toggle-slider{position:relative;width:48px;height:24px;background-color:var(--color-gray-400);border-radius:24px;transition:background-color var(--transition-fast);flex-shrink:0}.toggle-slider:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:transform var(--transition-fast);border-radius:50%}.toggle-switch input:checked+.toggle-slider{background-color:var(--color-primary)}.toggle-switch.toggle-success input:checked+.toggle-slider{background-color:var(--color-success)}.toggle-switch input:focus-visible+.toggle-slider{box-shadow:0 0 0 3px var(--color-primary-alpha-10)}.toggle-switch input:checked+.toggle-slider:before{transform:translate(24px)}.toggle-switch input:disabled+.toggle-slider{opacity:.5;cursor:default}.toggle-label{font-size:var(--font-size-base);color:var(--color-gray-900);font-weight:var(--font-weight-medium)}.tooltip-container{position:absolute;top:0;left:0;background-color:rgba(31,41,55,.95);color:var(--color-white);padding:var(--space-2) var(--space-3);border-radius:var(--radius-md);font-size:var(--font-size-sm);font-weight:var(--font-weight-medium);line-height:1.4;z-index:var(--z-tooltip);pointer-events:none;opacity:0;transform:scale(.95) translateY(4px);transition:opacity .2s cubic-bezier(.4,0,.2,1),transform .2s cubic-bezier(.4,0,.2,1);white-space:normal;max-width:260px;box-shadow:var(--shadow-lg),0 0 0 1px var(--color-gray-700);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);text-align:center}.tooltip-container.active{opacity:1;transform:scale(1) translateY(0)}.interaction{background:transparent;border:none;border-radius:0;padding:var(--space-4) 0;margin:0;position:relative}.interaction .question-prompt{margin-bottom:var(--space-3)}.interaction .question-prompt h3{color:var(--color-primary);margin:0 0 var(--space-2)}.drag-drop-container{display:grid;grid-template-columns:1fr 1fr;gap:var(--space-6);margin:var(--space-4) 0}.drag-items,.drop-zones{padding:var(--space-4);border:2px dashed var(--color-secondary-alpha-30);border-radius:var(--radius-lg);min-height:200px}.drag-items h4,.drop-zones h4{margin:0 0 var(--space-3);color:var(--color-primary);font-weight:var(--font-weight-semibold);font-size:var(--font-size-base)}.drag-item{background:var(--color-secondary);color:var(--color-white);padding:var(--space-2) var(--space-4);margin:var(--space-2) 0;border-radius:var(--radius-2xl);cursor:grab;user-select:none;transition:all var(--transition-fast);text-align:center;font-weight:var(--font-weight-medium);border:2px solid transparent;min-height:44px;display:flex;align-items:center;justify-content:center}.drag-item:hover{transform:scale(1.05);box-shadow:var(--shadow-md)}.drag-item:active{cursor:grabbing;transform:scale(.95)}.zone-content .drag-item.dropped:hover{transform:none;box-shadow:var(--shadow-md)}.zone-content .drag-item.dropped:active{transform:none}.drag-item.keyboard-selected{outline:3px solid var(--color-info);outline-offset:2px;border-color:var(--color-info)}.drop-zone{border:2px solid var(--color-secondary-alpha-30);border-radius:var(--radius-lg);padding:var(--space-3);margin:var(--space-2) 0;min-height:60px;background:var(--color-secondary-alpha-05);transition:all var(--transition-fast)}.drop-zone.drag-over{border-color:var(--color-secondary);background:var(--color-secondary-alpha-10);transform:scale(1.02);box-shadow:var(--shadow-md)}.zone-label{font-weight:var(--font-weight-semibold);color:var(--color-primary);margin-bottom:var(--space-2);font-size:var(--font-size-sm)}.zone-content{display:flex;flex-direction:column;gap:var(--space-2);min-height:40px}.zone-content .drag-item.dropped{cursor:grab;opacity:.9;position:relative;padding-right:40px;margin:0}.zone-content .drag-item.dropped:active{cursor:grabbing}.drag-item .remove-item{position:absolute;top:50%;right:0;transform:translateY(-50%);background:transparent;color:var(--color-white);border:none;border-radius:50%;width:32px;height:32px;min-width:32px;min-height:32px;font-size:22px;font-weight:var(--font-weight-bold);line-height:32px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background var(--transition-fast),color var(--transition-fast);padding:0 0 2px;z-index:10;-webkit-tap-highlight-color:transparent}.drag-item .remove-item:hover{color:var(--color-error);background:rgba(255,255,255,.2);width:26px;height:26px}.drag-item .remove-item:active{background:rgba(255,255,255,.3);width:26px;height:26px}.drag-item .remove-item:focus{outline:2px solid var(--color-error);outline-offset:2px}.drag-items.drag-over{background:var(--color-success-alpha-10);border:2px dashed var(--color-success);border-radius:var(--radius-lg)}@media(max-width:767px){.drag-drop-container{grid-template-columns:1fr;gap:var(--space-6)}.drag-items,.drop-zones{padding:var(--space-4)}.drag-item{padding:var(--space-3) var(--space-5);font-size:var(--font-size-sm)}.drop-zone{padding:var(--space-4)}}.fill-in-container{display:flex;flex-direction:column;gap:var(--space-3)}.fill-in-item{display:flex;flex-direction:column;gap:var(--space-2)}.fill-in-item label{font-weight:600;color:var(--text-body)}.fill-in-item input{padding:var(--space-2) var(--space-3);border:2px solid var(--color-secondary-alpha-30);border-radius:var(--radius-md);font-size:var(--font-size-base);transition:all var(--transition-fast)}.fill-in-item input:focus{outline:none;border-color:var(--color-secondary);box-shadow:0 0 0 3px var(--color-secondary-alpha-10)}.fill-in-item input.correct{border-color:var(--color-success);background:var(--color-success-light)}.fill-in-item input.incorrect{border-color:var(--color-error);background:rgba(220,38,38,.1)}.hotspot-container{position:relative;display:inline-block;margin:var(--space-3) 0}.hotspot-area{position:absolute;background:rgba(239,68,68,.3);border:2px solid var(--color-error);border-radius:50%;cursor:pointer;transition:all var(--transition-fast);min-width:var(--btn-min-height);min-height:var(--btn-min-height)}.hotspot-area:hover{background:rgba(239,68,68,.5);transform:scale(1.1);box-shadow:var(--shadow-md)}.hotspot-area:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}.hotspot-area.selected{border-width:3px;background:var(--color-success-alpha-30);border-color:var(--color-success)}.likert-container{overflow-x:auto;margin:var(--space-4) 0;border:1px solid var(--color-gray-200);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm)}.likert-table{width:100%;border-collapse:collapse;min-width:600px}.likert-table th,.likert-table td{padding:var(--space-3) var(--space-4);text-align:center;vertical-align:middle}.likert-table thead{background-color:var(--color-gray-100);border-bottom:2px solid var(--color-gray-300)}.likert-header-question{text-align:left!important;width:40%;font-weight:var(--font-weight-bold);color:var(--color-gray-800)}.likert-header-option{font-weight:var(--font-weight-semibold);color:var(--color-gray-700);font-size:var(--font-size-sm)}.likert-row{border-bottom:1px solid var(--color-gray-200);transition:background-color var(--transition-fast)}.likert-row:last-child{border-bottom:none}.likert-row.odd{background-color:var(--color-white)}.likert-row.even{background-color:var(--color-gray-50)}.likert-row:hover{background-color:var(--color-primary-alpha-10)}.likert-question-text{text-align:left!important;font-weight:var(--font-weight-medium);color:var(--color-gray-900)}.likert-option input[type=radio]{width:20px;height:20px;cursor:pointer;accent-color:var(--color-primary)}@media(max-width:768px){.likert-header-option{font-size:var(--font-size-xs);padding:var(--space-2)}.likert-question-text{font-size:var(--font-size-sm)}}.matching-interaction{margin:var(--space-4) 0}.matching-instruction{color:var(--text-muted);font-size:var(--font-size-sm);margin-top:var(--space-2);font-style:italic}.matching-container{display:grid;grid-template-columns:1fr 1fr;gap:var(--space-6);margin:var(--space-5) 0;padding:var(--space-4);background:var(--color-gray-100);border-radius:var(--radius-lg)}.matching-column{display:flex;flex-direction:column;gap:var(--space-3)}.matching-column-header{margin:0 0 var(--space-3);color:var(--color-primary);font-weight:var(--font-weight-semibold);font-size:var(--font-size-md);padding-bottom:var(--space-2);border-bottom:2px solid var(--color-secondary-alpha-20)}.matching-list{display:flex;flex-direction:column;gap:var(--space-2)}.matching-item{display:flex;align-items:center;justify-content:space-between;padding:var(--space-3) var(--space-4);background:var(--color-white);border:2px solid var(--color-gray-300);border-radius:var(--radius-md);font-size:var(--font-size-base);font-weight:var(--font-weight-medium);color:var(--text-primary);cursor:pointer;transition:all var(--transition-fast);text-align:left;min-height:48px;position:relative}.matching-item:hover:not(:disabled){border-color:var(--color-secondary);background:var(--color-white);transform:translate(-2px);box-shadow:var(--shadow-sm)}.matching-item:focus{outline:2px solid var(--color-secondary);outline-offset:2px;border-color:var(--color-secondary)}.matching-item.selected{border-color:var(--color-secondary);background:var(--color-secondary-alpha-15);box-shadow:0 0 0 3px var(--color-secondary-alpha-10);font-weight:var(--font-weight-semibold)}.matching-item.matched{cursor:pointer}.matching-item.matched:hover{transform:translate(-2px)}.matching-item:disabled{opacity:.5;cursor:not-allowed}.matching-target{display:flex;align-items:center;justify-content:space-between;padding:var(--space-3) var(--space-4);background:var(--color-white);border:2px solid var(--color-gray-300);border-radius:var(--radius-md);font-size:var(--font-size-base);color:var(--text-primary);cursor:pointer;transition:all var(--transition-fast);text-align:left;min-height:48px;position:relative}.matching-target:hover:not(:disabled){border-color:var(--color-secondary);background:var(--color-white);transform:translate(2px);box-shadow:var(--shadow-sm)}.matching-target:focus{outline:2px solid var(--color-secondary);outline-offset:2px;border-color:var(--color-secondary)}.matching-target.selected{border-color:var(--color-secondary);background:var(--color-secondary-alpha-15);box-shadow:0 0 0 3px var(--color-secondary-alpha-10)}.matching-target.matched{cursor:pointer}.matching-target.matched:hover{transform:translate(2px)}.matching-target:disabled{opacity:.5;cursor:not-allowed}.matching-connection-indicator{display:none;width:8px;height:8px;margin-left:var(--space-2);flex-shrink:0;border-radius:50%;background:var(--pair-color, var(--color-gray-400))}.matching-deferred .matching-target.matched .matching-connection-indicator{display:block}.matching-feedback-icon{display:none;width:24px;height:24px;margin-left:var(--space-2);flex-shrink:0;font-size:18px;font-weight:var(--font-weight-bold)}.matching-immediate .matching-item.correct .matching-feedback-icon{display:flex;align-items:center;justify-content:center;color:var(--color-success)}.matching-immediate .matching-item.correct .matching-feedback-icon:before{content:"✓"}.matching-immediate .matching-item.matched,.matching-immediate .matching-target.matched{border-color:var(--color-success);background:var(--color-success-light);color:var(--color-success);opacity:1}.matching-deferred .matching-item.selected,.matching-deferred .matching-target.selected{border-color:var(--selection-color, var(--color-secondary))!important;background:color-mix(in srgb,var(--selection-color, var(--color-secondary)) 15%,var(--color-white))!important;box-shadow:none!important}.matching-deferred .matching-item:not(.matched):focus,.matching-deferred .matching-target:not(.matched):focus{outline-color:var(--selection-color, var(--color-secondary));border-color:var(--selection-color, var(--color-secondary))}.matching-deferred .matching-item.matched:focus,.matching-deferred .matching-target.matched:focus{outline-color:var(--pair-color, var(--color-secondary));border-color:var(--pair-color, var(--color-secondary))}.matching-deferred .matching-item.matched,.matching-deferred .matching-target.matched{border-color:var(--pair-color, var(--color-secondary));background:color-mix(in srgb,var(--pair-color, var(--color-secondary)) 10%,var(--color-white));opacity:1;cursor:pointer}.matching-deferred .matching-item.matched:hover,.matching-deferred .matching-target.matched:hover{opacity:1}.matching-item.correct,.matching-target.correct{border-color:var(--color-success)!important;background:var(--color-success-light)!important;color:var(--color-success)}@keyframes flash-incorrect{0%,to{border-color:var(--color-error);background:var(--color-error-light)}50%{border-color:var(--color-error);background:var(--color-error);color:var(--color-white)}}.flash-incorrect,.matching-immediate .matching-item.incorrect,.matching-immediate .matching-target.incorrect{animation:flash-incorrect .6s ease-in-out}.matching-item-text,.matching-target-text{flex:1;line-height:1.4}@media(max-width:1024px){.matching-container{gap:var(--space-4)}}@media(max-width:767px){.matching-container{grid-template-columns:1fr;gap:var(--space-5);padding:var(--space-3)}.matching-column-header{font-size:var(--font-size-base)}.matching-item,.matching-target{padding:var(--space-2) var(--space-3);font-size:var(--font-size-sm)}.matching-instruction{font-size:var(--font-size-xs)}}.numeric-input-container{display:flex;align-items:center;gap:var(--space-3);margin:var(--space-4) 0}.numeric-input-container label{font-weight:var(--font-weight-medium);color:var(--text-body);font-size:var(--font-size-base)}.numeric-input-container input[type=number]{padding:var(--input-padding-y) var(--input-padding-x);border:var(--input-border-width) solid var(--color-secondary-alpha-30);border-radius:var(--input-border-radius);font-size:var(--font-size-lg);width:140px;text-align:center;transition:all var(--transition-fast)}.numeric-input-container input[type=number]:focus{outline:none;border-color:var(--color-secondary);box-shadow:0 0 0 3px var(--color-secondary-alpha-10)}.units{font-weight:var(--font-weight-medium);color:var(--text-muted);font-size:var(--font-size-base)}@media(max-width:767px){.numeric-input-container{flex-direction:column;gap:var(--space-4)}.numeric-input-container input[type=number]{width:100%}}.sequencing-list{display:flex;flex-direction:column;gap:var(--space-2);margin:var(--space-4) 0;padding:var(--space-2);background:var(--color-gray-50);border-radius:var(--radius-lg);border:1px solid var(--color-gray-200)}.sequence-item{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-3) var(--space-4);background:var(--color-white);border:1px solid var(--color-gray-300);border-radius:var(--radius-md);cursor:grab;transition:all var(--transition-fast);position:relative;user-select:none}.sequence-item:hover{border-color:var(--color-primary-alpha-50);box-shadow:var(--shadow-sm)}.sequence-item:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px;z-index:1}.sequence-item.dragging{opacity:.5;background:var(--color-gray-100);cursor:grabbing}.drag-handle{color:var(--color-gray-400);font-size:var(--font-size-lg);cursor:grab;display:flex;align-items:center;justify-content:center;width:24px;height:24px}.sequence-item:hover .drag-handle{color:var(--color-primary)}.item-text{flex:1;font-size:var(--font-size-base);color:var(--color-gray-800);line-height:1.5}.sequence-item.drag-over-top{border-top:2px solid var(--color-primary);margin-top:2px}.sequence-item.drag-over-bottom{border-bottom:2px solid var(--color-primary);margin-bottom:2px}.correct-sequence .sequence-item{border-color:var(--color-success);background-color:var(--color-success-alpha-10)}.response-sequence .sequence-item{cursor:default}.true-false-options{display:grid;grid-template-columns:1fr 1fr;gap:var(--space-4);margin:var(--space-4) 0}.true-false-options label{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:var(--space-2);padding:var(--space-6) var(--space-4);border:3px solid var(--color-gray-300);border-radius:var(--radius-lg);cursor:pointer;transition:all var(--transition-fast);background:var(--color-white);position:relative;min-height:80px;font-size:var(--font-size-lg);font-weight:var(--font-weight-semibold);color:var(--color-gray-700);text-transform:uppercase;letter-spacing:.05em}.true-false-options label:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;border-radius:calc(var(--radius-lg) - 2px);background:linear-gradient(135deg,transparent 0%,var(--color-secondary-alpha-05) 100%);opacity:0;transition:opacity var(--transition-fast)}.true-false-options label:hover{border-color:var(--color-secondary);transform:translateY(-2px);box-shadow:var(--shadow-md)}.true-false-options label:hover:before{opacity:1}.true-false-options label:active{transform:translateY(0)}.true-false-options input[type=radio]{position:absolute;opacity:0;width:0;height:0}.true-false-options label:has(input[type=radio]:checked){border-color:var(--color-secondary);background:linear-gradient(135deg,var(--color-secondary-alpha-10) 0%,var(--color-secondary-alpha-05) 100%);color:var(--color-secondary);box-shadow:0 0 0 3px var(--color-secondary-alpha-10);transform:translateY(-2px)}.true-false-options label:has(input[type=radio]:checked):after{content:"✓";position:absolute;top:var(--space-3);right:var(--space-3);width:28px;height:28px;background:var(--color-secondary);color:var(--color-white);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:var(--font-size-lg);font-weight:700;animation:checkmarkPop .3s cubic-bezier(.68,-.55,.265,1.55)}@keyframes checkmarkPop{0%{transform:scale(0)}50%{transform:scale(1.2)}to{transform:scale(1)}}.true-false-options label.answer-correct:has(input[type=radio]:checked){border-color:var(--color-success);background:linear-gradient(135deg,var(--color-success-light) 0%,rgba(0,163,70,.05) 100%);color:var(--color-success);box-shadow:0 0 0 3px rgba(0,163,70,.1)}.true-false-options label.answer-correct:has(input[type=radio]:checked):after{background:var(--color-success)}.true-false-options label.answer-incorrect:has(input[type=radio]:checked){border-color:var(--color-error);background:linear-gradient(135deg,rgba(220,38,38,.1),rgba(220,38,38,.05));color:var(--color-error);box-shadow:0 0 0 3px rgba(220,38,38,.1)}.true-false-options label.answer-incorrect:has(input[type=radio]:checked):after{content:"✗";background:var(--color-error)}@media(prefers-contrast:high){.matching-item,.matching-target{border-width:3px}.matching-item.selected,.matching-target.selected{outline-width:3px}}@media(prefers-reduced-motion:reduce){.matching-item,.matching-target,.drag-item,.drop-zone,.hotspot-area{transition:none}.matching-item:hover,.matching-target:hover,.drag-item:hover,.drag-item:active,.hotspot-area:hover{transform:none}@keyframes flash-incorrect{0%,to{border-color:var(--color-error);background:var(--color-error-light)}}}.text-primary{color:var(--text-primary)}.border{border:1px solid var(--color-gray-300)}.border-2{border:2px solid var(--color-gray-300)}.border-primary{border-color:var(--color-primary)}.border-secondary{border-color:var(--color-secondary)}.border-accent{border-color:var(--color-accent)}.rounded{border-radius:var(--radius-md)}.rounded-lg{border-radius:var(--radius-lg)}.rounded-full{border-radius:var(--radius-full)}.border-accent-left{border-left:4px solid var(--color-accent)}.border-warning-left{border-left:4px solid var(--color-warning)}.border-info-left{border-left:4px solid var(--color-info)}.border-secondary-left{border-left:4px solid var(--color-secondary)}.border-primary-left{border-left:4px solid var(--color-primary)}.text-primary{color:var(--color-primary)}.text-secondary{color:var(--color-secondary)}.text-accent{color:var(--color-accent)}.text-success{color:var(--color-success)}.text-warning{color:var(--color-warning)}.text-error{color:var(--color-error)}.text-info{color:var(--color-info)}.text-muted{color:var(--text-muted)}.text-body{color:var(--text-body)}.text-white{color:var(--color-white)}.bg-primary{background:var(--color-primary)}.bg-secondary{background:var(--color-secondary)}.bg-accent{background:var(--color-accent)}.bg-success{background:var(--color-success)}.bg-warning{background:var(--color-warning)}.bg-error{background:var(--color-error)}.bg-info{background:var(--color-info)}.bg-white{background:var(--color-white)}.bg-gray-50{background:var(--color-gray-50)}.bg-gray-100{background:var(--color-gray-100)}.container{width:100%;max-width:var(--container-max-width, 1200px);margin-left:auto;margin-right:auto;padding-left:var(--container-padding-x, var(--space-4));padding-right:var(--container-padding-x, var(--space-4))}.container-fluid{width:100%;padding-left:var(--container-padding-x, var(--space-4));padding-right:var(--container-padding-x, var(--space-4))}.d-block{display:block}.d-inline{display:inline}.d-inline-block{display:inline-block}.d-flex{display:flex}.d-grid{display:grid}.d-none{display:none}.visible{visibility:visible}.invisible{visibility:hidden}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-scroll{overflow:scroll}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.position-relative{position:relative}.position-absolute{position:absolute}.w-full{width:100%}.w-auto{width:auto}.h-full{height:100%}.h-auto{height:auto}.flex{display:flex}.flex-col{flex-direction:column}.flex-row{flex-direction:row}.flex-wrap{flex-wrap:wrap}.flex-nowrap{flex-wrap:nowrap}.flex-center{display:flex;align-items:center;justify-content:center}.flex-between{display:flex;align-items:center;justify-content:space-between}.flex-start{display:flex;align-items:flex-start;justify-content:flex-start}.items-center{align-items:center}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.self-center{align-self:center}.self-start{align-self:flex-start}.self-end{align-self:flex-end}.flex-1{flex:1}.flex-grow{flex-grow:1}.flex-shrink{flex-shrink:1}.flex-shrink-0{flex-shrink:0}.gap-0{gap:0}.gap-1{gap:var(--space-1)}.gap-2{gap:var(--space-2)}.gap-3{gap:var(--space-3)}.gap-4{gap:var(--space-4)}.gap-6{gap:var(--space-6)}.grid{display:grid}.grid-cols-1{grid-template-columns:1fr}.grid-cols-2{grid-template-columns:repeat(2,1fr)}.grid-cols-3{grid-template-columns:repeat(3,1fr)}.grid-cols-auto{grid-template-columns:repeat(auto-fit,minmax(250px,1fr))}.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:var(--grid-gap, var(--space-4))}.col-1{grid-column:span 1}.col-2{grid-column:span 2}.col-3{grid-column:span 3}.col-4{grid-column:span 4}.col-5{grid-column:span 5}.col-6{grid-column:span 6}.col-7{grid-column:span 7}.col-8{grid-column:span 8}.col-9{grid-column:span 9}.col-10{grid-column:span 10}.col-11{grid-column:span 11}.col-12{grid-column:span 12}.col-full{grid-column:1 / -1}.col-start-1{grid-column-start:1}.col-start-2{grid-column-start:2}.col-start-3{grid-column-start:3}.col-start-4{grid-column-start:4}.col-start-5{grid-column-start:5}.col-start-6{grid-column-start:6}.col-start-7{grid-column-start:7}.col-start-8{grid-column-start:8}.col-start-9{grid-column-start:9}.col-start-10{grid-column-start:10}.col-start-11{grid-column-start:11}.col-start-12{grid-column-start:12}.list-none{list-style:none}.list-disc{list-style:disc}.list-decimal{list-style:decimal}.list-styled,.list-numbered{padding-left:var(--space-6);margin:var(--space-4) 0}.list-styled li,.list-numbered li{margin:var(--space-3) 0;padding-left:var(--space-2);line-height:1.6}.list-styled{list-style:disc}.list-styled li::marker{color:var(--color-primary);font-size:1.2em}.list-numbered{list-style:decimal;counter-reset:list-counter}.list-numbered li::marker{color:var(--color-primary);font-weight:var(--font-weight-semibold)}.list-styled ul,.list-numbered ul,.list-styled ol,.list-numbered ol{margin:var(--space-2) 0;padding-left:var(--space-5)}.list-styled ul li::marker{content:"◦";font-size:1.4em}.m-0{margin:0}.m-1{margin:var(--space-1)}.m-2{margin:var(--space-2)}.m-3{margin:var(--space-3)}.m-4{margin:var(--space-4)}.m-5{margin:var(--space-5)}.m-6{margin:var(--space-6)}.mx-auto{margin-left:auto;margin-right:auto}.my-auto{margin-top:auto;margin-bottom:auto}.mt-0{margin-top:0}.mt-1{margin-top:var(--space-1)}.mt-2{margin-top:var(--space-2)}.mt-3{margin-top:var(--space-3)}.mt-4{margin-top:var(--space-4)}.mt-6{margin-top:var(--space-6)}.mb-0{margin-bottom:0}.mb-1{margin-bottom:var(--space-1)}.mb-2{margin-bottom:var(--space-2)}.mb-3{margin-bottom:var(--space-3)}.mb-4{margin-bottom:var(--space-4)}.mb-6{margin-bottom:var(--space-6)}.ml-0{margin-left:0}.ml-1{margin-left:var(--space-1)}.ml-2{margin-left:var(--space-2)}.ml-3{margin-left:var(--space-3)}.ml-4{margin-left:var(--space-4)}.mr-0{margin-right:0}.mr-1{margin-right:var(--space-1)}.mr-2{margin-right:var(--space-2)}.mr-3{margin-right:var(--space-3)}.mr-4{margin-right:var(--space-4)}.p-0{padding:0}.p-1{padding:var(--space-1)}.p-2{padding:var(--space-2)}.p-3{padding:var(--space-3)}.p-4{padding:var(--space-4)}.p-5{padding:var(--space-5)}.p-6{padding:var(--space-6)}.px-0{padding-left:0;padding-right:0}.px-2{padding-left:var(--space-2);padding-right:var(--space-2)}.px-3{padding-left:var(--space-3);padding-right:var(--space-3)}.px-4{padding-left:var(--space-4);padding-right:var(--space-4)}.py-0{padding-top:0;padding-bottom:0}.py-2{padding-top:var(--space-2);padding-bottom:var(--space-2)}.py-3{padding-top:var(--space-3);padding-bottom:var(--space-3)}.py-4{padding-top:var(--space-4);padding-bottom:var(--space-4)}.pt-0{padding-top:0}.pt-2{padding-top:var(--space-2)}.pt-3{padding-top:var(--space-3)}.pt-4{padding-top:var(--space-4)}.pb-0{padding-bottom:0}.pb-2{padding-bottom:var(--space-2)}.pb-3{padding-bottom:var(--space-3)}.pb-4{padding-bottom:var(--space-4)}.pl-0{padding-left:0}.pl-1{padding-left:var(--space-1)}.pl-2{padding-left:var(--space-2)}.pl-3{padding-left:var(--space-3)}.pl-4{padding-left:var(--space-4)}.pl-5{padding-left:var(--space-5)}.pl-6{padding-left:var(--space-6)}.pr-0{padding-right:0}.pr-1{padding-right:var(--space-1)}.pr-2{padding-right:var(--space-2)}.pr-3{padding-right:var(--space-3)}.pr-4{padding-right:var(--space-4)}.pr-5{padding-right:var(--space-5)}.pr-6{padding-right:var(--space-6)}.font-light{font-weight:300}.font-normal{font-weight:400}.font-medium{font-weight:500}.font-semibold{font-weight:600}.font-bold{font-weight:700}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-md{font-size:1rem}.text-lg{font-size:1.125rem}.text-xl{font-size:1.25rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-justify{text-align:justify}.uppercase{text-transform:uppercase}.lowercase{text-transform:lowercase}.capitalize{text-transform:capitalize}.no-underline{text-decoration:none}.underline{text-decoration:underline}.line-clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.line-clamp-3{display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.conditional-hidden{opacity:0;transform:translateY(-10px);transition:opacity .3s ease-out,transform .3s ease-out;pointer-events:none}.conditional-visible{opacity:1;transform:translateY(0);transition:opacity .3s ease-in,transform .3s ease-in;pointer-events:auto}@media(prefers-reduced-motion:reduce){.conditional-hidden,.conditional-visible{transition:none;transform:none}}.pattern-intro-cards{max-width:900px;margin:0 auto}.pattern-intro-cards>.intro{margin-bottom:var(--space-8);text-align:center}.pattern-intro-cards>.intro .lead{font-size:var(--font-size-lg);color:var(--text-secondary)}.pattern-intro-cards .card-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:var(--space-4)}@media(max-width:640px){.pattern-intro-cards .card-grid{grid-template-columns:1fr}}.pattern-steps{max-width:800px;margin:0 auto}.pattern-steps .step{display:flex;gap:var(--space-4);margin-bottom:var(--space-6);padding:var(--space-4);background:var(--color-white);border-radius:var(--radius-lg);border-left:4px solid var(--color-primary)}.pattern-steps .step:last-child{margin-bottom:0}.pattern-steps .step-number{flex-shrink:0;width:48px;height:48px;display:flex;align-items:center;justify-content:center;background:var(--color-primary);color:var(--color-white);border-radius:50%;font-size:var(--font-size-xl);font-weight:var(--font-weight-bold)}.pattern-steps .step-content h3{margin-top:0;margin-bottom:var(--space-2)}.pattern-features{display:grid;grid-template-columns:repeat(4,1fr);gap:var(--space-4);margin:var(--space-8) 0}.pattern-features .feature-item{text-align:center;padding:var(--space-4)}.pattern-features .feature-icon{font-size:3rem;margin-bottom:var(--space-3);display:block;color:var(--color-primary)}.pattern-features .feature-item h3{margin-bottom:var(--space-2)}@media(max-width:1024px){.pattern-features{grid-template-columns:repeat(2,1fr)}}@media(max-width:640px){.pattern-features{grid-template-columns:1fr}}.pattern-comparison{display:grid;grid-template-columns:repeat(2,1fr);gap:var(--space-6);margin:var(--space-6) 0}.pattern-comparison .comparison-item{padding:var(--space-6);background:var(--color-white);border:2px solid var(--color-gray-200);border-radius:var(--radius-lg)}.pattern-comparison .comparison-item.highlight{border-color:var(--color-primary);box-shadow:0 0 0 3px var(--color-primary-alpha-10)}.pattern-comparison .comparison-item h3{margin-top:0}@media(max-width:768px){.pattern-comparison{grid-template-columns:1fr}}.pattern-content-image{display:grid;grid-template-columns:1fr 1fr;gap:var(--space-6);align-items:center;margin:var(--space-6) 0}.pattern-content-image.reverse{direction:rtl}.pattern-content-image.reverse>*{direction:ltr}.pattern-content-image img{width:100%;height:auto;border-radius:var(--radius-lg);box-shadow:var(--shadow-md)}@media(max-width:768px){.pattern-content-image{grid-template-columns:1fr;direction:ltr}.pattern-content-image.reverse{direction:ltr}}.pattern-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:var(--space-4);margin:var(--space-8) 0}.pattern-stats .stat{text-align:center;padding:var(--space-6);background:var(--color-white);border-radius:var(--radius-lg)}.pattern-stats .stat-value{font-size:var(--font-size-4xl);font-weight:var(--font-weight-bold);color:var(--color-primary);display:block;line-height:1;margin-bottom:var(--space-2)}.pattern-stats .stat-label{font-size:var(--font-size-sm);color:var(--color-gray-600);text-transform:uppercase;letter-spacing:.05em}@media(max-width:1024px){.pattern-stats{grid-template-columns:repeat(2,1fr)}}@media(max-width:640px){.pattern-stats{grid-template-columns:1fr}}html.bp-min-large-desktop{--content-padding: var(--space-10);--section-padding: var(--space-8);--header-padding-x: var(--space-12);--header-padding-y: var(--space-2);--header-height: 24px;--footer-padding-x: var(--space-12);--footer-padding-y: var(--space-3)}html.bp-min-large-desktop #app{max-width:1440px;height:100%;margin:0 auto}html.bp-max-desktop{--content-padding: var(--space-10);--section-padding: var(--space-8);--header-padding-x: var(--space-10);--header-padding-y: var(--space-2);--header-height: 24px;--footer-padding-x: var(--space-10);--footer-padding-y: var(--space-5)}html.bp-max-desktop #app{margin:0;max-width:none;height:100%}html.bp-max-tablet-landscape{--content-padding: var(--space-8);--section-padding: var(--space-6);--header-padding-x: var(--space-8);--header-padding-y: var(--space-2);--header-height: 24px;--footer-padding-x: var(--space-8);--footer-padding-y: var(--space-4);--nav-padding-x: var(--space-6);--nav-padding-y: var(--space-2)}html.bp-max-tablet-portrait{--font-size-4xl: var(--font-size-3xl);--font-size-3xl: var(--font-size-2xl);--content-padding: var(--space-6);--section-padding: var(--space-6);--header-padding-x: var(--space-4);--header-padding-y: var(--space-2);--header-height: 24px;--footer-padding-x: var(--space-6);--footer-padding-y: var(--space-6);--nav-padding-x: var(--space-4);--nav-padding-y: var(--space-2)}html.bp-max-tablet-portrait #app{margin:0;border-radius:0;height:100%}html.bp-max-tablet-portrait header{flex-wrap:wrap;justify-content:center;gap:var(--space-3)}html.bp-max-tablet-portrait header h1{font-size:var(--font-size-lg);text-align:center}html.bp-max-tablet-portrait #brand{flex:1 1 100%;justify-content:center}html.bp-max-tablet-portrait #accessibility-menu{right:var(--space-4)}html.bp-max-tablet-portrait footer{flex-direction:column;gap:var(--space-5)}html.bp-max-tablet-portrait .nav-controls{width:100%;flex-direction:column;gap:var(--space-3)}html.bp-max-tablet-portrait .nav-controls .nav-nav-buttons{width:100%;justify-content:space-between}html.bp-max-tablet-portrait .nav-controls .nav-exit-button{width:100%;margin-left:0}html.bp-max-tablet-portrait footer button{width:100%;justify-content:center}html.bp-max-tablet-portrait .stats-grid,html.bp-max-tablet-portrait .features-grid{grid-template-columns:1fr;gap:var(--space-4)}html.bp-max-tablet-portrait .concept-cards{grid-template-columns:1fr}html.bp-max-tablet-portrait .content-tabs,html.bp-max-tablet-portrait .assessment-tabs{flex-direction:column;gap:var(--space-3)}html.bp-max-tablet-portrait .tab-button,html.bp-max-tablet-portrait .assessment-tab{width:100%;justify-content:center}html.bp-max-tablet-portrait .final-actions{flex-direction:column;gap:var(--space-4)}html.bp-max-tablet-portrait .final-actions button{width:100%;max-width:320px}html.bp-max-mobile-landscape{--font-size-2xl: var(--font-size-xl);--font-size-xl: var(--font-size-lg);--content-padding: var(--space-5);--section-padding: var(--space-5);--header-padding-x: var(--space-4);--header-padding-y: var(--space-4);--header-height: 56px;--footer-padding-x: var(--space-5);--footer-padding-y: var(--space-5);--nav-padding-x: var(--space-3);--nav-padding-y: var(--space-2)}html.bp-max-mobile-landscape #app{margin:0;border-radius:0;height:100%}html.bp-max-mobile-landscape header h1{font-size:var(--font-size-lg)}html.bp-max-mobile-landscape #brand img.logo{height:44px}html.bp-max-mobile-landscape .feature-card,html.bp-max-mobile-landscape .concept-card,html.bp-max-mobile-landscape .stat-card{padding:var(--space-5)}html.bp-max-mobile-landscape .interaction{padding:var(--space-6)}html.bp-max-mobile-landscape .assessment-navigation{flex-direction:column;gap:var(--space-3)}html.bp-max-mobile-landscape .btn-nav{width:100%;min-width:auto}html.bp-max-mobile-landscape .assessment-nav-center{order:-1;margin-bottom:var(--space-2)}html.bp-max-mobile-landscape .nav-controls{flex-direction:column;gap:var(--space-2)}html.bp-max-mobile-landscape .nav-controls button{width:100%}html.bp-max-mobile-landscape .review-actions{flex-direction:column}html.bp-max-mobile-landscape .review-actions button{width:100%}html.bp-max-mobile-portrait{--space-8: var(--space-6);--space-10: var(--space-8);--space-12: var(--space-8);--content-padding: var(--space-4);--section-padding: var(--space-4);--header-padding-x: var(--space-3);--header-padding-y: var(--space-3);--header-height: 52px;--footer-padding-x: var(--space-4);--footer-padding-y: var(--space-4);--nav-padding-x: var(--space-3);--nav-padding-y: var(--space-2)}html.bp-max-mobile-portrait #app{margin:0;border-radius:0;height:100%}html.bp-max-mobile-portrait header h1{font-size:var(--font-size-base)}html.bp-max-mobile-portrait #brand img.logo{height:40px}html.bp-max-mobile-portrait main#content>section{margin-bottom:var(--space-6)}html.bp-max-mobile-portrait .feature-card,html.bp-max-mobile-portrait .concept-card,html.bp-max-mobile-portrait .stat-card{padding:var(--space-4)}html.bp-max-mobile-portrait .interaction{padding:var(--space-5)}html.bp-max-mobile-portrait footer button{padding:var(--space-3) var(--space-4);font-size:var(--font-size-sm)}button:focus-visible,.btn:focus-visible,input:focus-visible,textarea:focus-visible,select:focus-visible{outline:3px solid var(--color-primary);outline-offset:2px;border-radius:var(--radius-md);box-shadow:0 0 0 1px var(--color-white),0 0 0 4px var(--color-primary-alpha-20);transition:transform var(--transition-fast)}a:focus-visible{outline:3px solid var(--color-primary);outline-offset:2px;border-radius:var(--radius-sm);text-decoration:underline}.skip-link{position:absolute;top:-40px;left:6px;background:var(--color-primary);color:var(--color-white);padding:var(--space-2) var(--space-4);border-radius:var(--radius-md);text-decoration:none;font-weight:var(--font-weight-semibold);z-index:var(--z-tooltip);transition:top var(--transition-normal)}.skip-link:focus{top:6px}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);clip-path:inset(50%);white-space:nowrap;border:0}@media(prefers-contrast:high){:root{--text-body: #000;--text-muted: #333}button:focus-visible{outline:3px solid #000}}@media(prefers-reduced-motion:reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}html{scroll-behavior:auto!important}}@media print{#accessibility-button,#accessibility-menu,.interaction-controls,.final-actions,.nav-controls{display:none!important}.interaction{page-break-inside:avoid}*{animation:none!important;transition:none!important}button{border:2px solid #000!important;background:#fff!important;color:#000!important}.notification{border:2px solid #000!important;background:#fff!important}}.btn-loading{position:relative;color:transparent}.btn-loading:after{content:"";position:absolute;width:16px;height:16px;top:50%;left:50%;margin-left:-8px;margin-top:-8px;border:2px solid transparent;border-top:2px solid currentColor;border-radius:50%;animation:spin var(--transition-slow) linear infinite}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes successPulse{0%{transform:scale(1)}50%{transform:scale(1.05)}to{transform:scale(1)}}.btn-success-feedback{animation:successPulse .6s ease-out}.progress-bar{width:100%;height:8px;background:var(--color-gray-200);border-radius:var(--radius-sm);overflow:hidden;position:relative}.progress-fill{height:100%;background:var(--gradient-progress);border-radius:var(--radius-sm);transition:width var(--transition-slow);position:relative}.progress-fill:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:var(--gradient-shimmer);animation:shimmer 2s infinite}@keyframes shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}@keyframes tooltip-fade-in{0%{opacity:0;visibility:visible}to{opacity:1;visibility:visible}}.tooltip{position:relative;display:inline-block}.tooltip:after{content:attr(data-tooltip);position:absolute;bottom:125%;left:50%;transform:translate(-50%);background:var(--color-gray-600);color:var(--color-white);padding:var(--space-2) var(--space-3);border-radius:var(--radius-md);font-size:var(--font-size-sm);white-space:normal;max-width:200px;width:max-content;text-align:left;opacity:0;visibility:hidden;transition:opacity var(--transition-fast),visibility var(--transition-fast);transition-delay:0s;pointer-events:none;z-index:var(--z-tooltip)}.tooltip:before{content:"";position:absolute;bottom:110%;left:50%;transform:translate(-50%);border:var(--space-2) solid transparent;border-top-color:var(--color-gray-900);opacity:0;visibility:hidden;transition:opacity var(--transition-fast),visibility var(--transition-fast);transition-delay:0s;pointer-events:none;z-index:var(--z-tooltip)}.tooltip:hover:after,.tooltip:hover:before,.tooltip:focus:after,.tooltip:focus:before{animation:tooltip-fade-in .15s ease-out forwards;animation-delay:1s}.notification{padding:var(--space-4);border-radius:var(--radius-lg);margin:var(--space-4) 0;border-left:4px solid;position:relative;overflow:hidden}.notification:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;opacity:.05;z-index:-1}.notification-info{background:var(--color-info-light);border-left-color:var(--color-info);color:var(--color-gray-800)}.notification-info:before{background:var(--color-info)}.notification-success{background:var(--color-success-light);border-left-color:var(--color-success);color:var(--color-gray-800)}.notification-success:before{background:var(--color-success)}.notification-warning{background:var(--color-warning-light);border-left-color:var(--color-warning);color:var(--color-gray-800)}.notification-warning:before{background:var(--color-warning)}.notification-error{background:var(--color-error-light);border-left-color:var(--color-error);color:var(--color-gray-800)}.notification-error:before{background:var(--color-error)}img[alt=""]{outline:2px dashed var(--color-warning);position:relative}img[alt=""]:after{content:"⚠️ Missing alt text";position:absolute;top:5px;right:5px;background:var(--color-warning);color:var(--text-primary);padding:var(--space-1) var(--space-2);border-radius:var(--radius-sm);font-size:var(--font-size-xs);font-weight:var(--font-weight-semibold)}[data-theme=dark]{--text-body: #e0e0e0;--text-muted: #b0b0b0}section>*:first-child{margin-top:0}section>*:last-child{margin-bottom:0}\n/*$vite$:1*/',document.head.appendChild(d),n({b:Qa,c:fo,d:Va,f:Za,g:Fr,h:Pn,j:ht,l:sn,m:Vr,s:za});var m=n("_",function(e,t,r){var n=Promise.resolve();function a(e){var t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return n.then(function(t){var r,n=b(t||[]);try{for(n.s();!(r=n.n()).done;){var o=r.value;"rejected"===o.status&&a(o.reason)}}catch(i){n.e(i)}finally{n.f()}return e().catch(a)})});function f(e){if(null===e||"object"!==h(e))return e;if(e instanceof Date)return new Date(e.getTime());if(Array.isArray(e))return e.map(function(e){return f(e)});var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=f(e[r]));return t}function y(){return"".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id","-").concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}function w(e){if(!(e&&e instanceof HTMLElement))throw new Error("trapFocus: container must be a valid HTMLElement");var t=function(e){return e&&e instanceof HTMLElement?Array.from(e.querySelectorAll('a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])')):[]}(e);if(0===t.length)return function(){};var r=t[0],n=t[t.length-1],a=function(e){"Tab"===e.key&&(e.shiftKey?document.activeElement===r&&(e.preventDefault(),n.focus()):document.activeElement===n&&(e.preventDefault(),r.focus()))};return e.addEventListener("keydown",a),r.focus(),function(){e.removeEventListener("keydown",a)}}function x(e){if(!e||"object"!==h(e)||Array.isArray(e))throw new Error("deepMerge: target must be a plain object");for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(0===r.length)return e;var a=r.shift();if(a&&"object"===h(a)&&!Array.isArray(a))for(var o in a)if(a.hasOwnProperty(o)){var i=a[o],s=e[o];i&&"object"===h(i)&&!Array.isArray(i)?(s&&"object"===h(s)&&!Array.isArray(s)||(e[o]={}),x(e[o],i)):e[o]=i}return x.apply(void 0,[e].concat(r))}function k(e){if(!Array.isArray(e))throw new Error("shuffleArray: input must be an array");for(var t=v(e),r=t.length-1;r>0;r--){var n=Math.floor(Math.random()*(r+1)),a=[t[n],t[r]];t[r]=a[0],t[n]=a[1]}return t}var S=function(){return g(function e(){p(this,e),this.events={}},[{key:"on",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||"function"!=typeof t)throw new Error("Event name and callback are required");this.events[e]||(this.events[e]=[]);var a={callback:t,once:n.once||!1,id:y("listener")};return this.events[e].push(a),function(){return r.off(e,a.id)}}},{key:"once",value:function(e,t){return this.on(e,t,{once:!0})}},{key:"off",value:function(e,t){this.events[e]&&("string"==typeof t?this.events[e]=this.events[e].filter(function(e){return e.id!==t}):"function"==typeof t&&(this.events[e]=this.events[e].filter(function(e){return e.callback!==t})),0===this.events[e].length&&delete this.events[e])}},{key:"emit",value:function(e,t){var r=this;if(!this.events[e]||0===this.events[e].length)return!1;e.endsWith(":error")&&console.error("[EventBus Error] ".concat(e,":"),t);var n=v(this.events[e]),a=[];return n.forEach(function(r){try{r.callback(t),r.once&&a.push(r.id)}catch(n){console.error("[EventBus] Error in listener for '".concat(e,"':"),n)}}),a.forEach(function(t){return r.off(e,t)}),!0}},{key:"emitAsync",value:(e=u(c().m(function e(t,r){var n,a,o,i,s,l,d,u=this;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.events[t]&&0!==this.events[t].length){e.n=1;break}return e.a(2,!1);case 1:n=v(this.events[t]),a=[],o=b(n),e.p=2,o.s();case 3:if((i=o.n()).done){e.n=8;break}return s=i.value,e.p=4,e.n=5,s.callback(r);case 5:s.once&&a.push(s.id),e.n=7;break;case 6:e.p=6,l=e.v,console.error("[EventBus] Error in async listener for '".concat(t,"':"),l);case 7:e.n=3;break;case 8:e.n=10;break;case 9:e.p=9,d=e.v,o.e(d);case 10:return e.p=10,o.f(),e.f(10);case 11:return a.forEach(function(e){return u.off(t,e)}),e.a(2,!0)}},e,this,[[4,6],[2,9,10,11]])})),function(t,r){return e.apply(this,arguments)})},{key:"clear",value:function(e){e?delete this.events[e]:this.events={}}},{key:"getListenerCount",value:function(e){return this.events[e]?this.events[e].length:0}}]);var e}(),E=n("e",new S),A=!1,C=!1,z=!1;function I(){if(!A)throw new Error("SCORM API not initialized. Call initializeSCORM() first before accessing SCORM data.")}function M(){var e=window.doGetLastError();return"0"===e||0===e?null:{code:e,message:window.doGetErrorString(e),diagnostic:window.doGetDiagnostic(e)}}function q(){if(A)return E.emit("scorm:error",{domain:"scorm",operation:"Initialize (redundant call)",message:"initializeSCORM() called more than once. This is unnecessary and may indicate a logic error elsewhere in the application.",context:{}}),!0;var e=null;if("function"==typeof window.getAPIHandle&&(e=window.getAPIHandle()),e)try{var t=e.GetValue("cmi.mode"),r=e.GetLastError?e.GetLastError().toString():"0";if("0"===r||0===r)return console.log('[SCORM] Session detected as already active (cmi.mode: "'.concat(t,'"). Skipping Initialize().')),window.initialized,window.initialized=!0,A=!0,z=!0,!0}catch(s){console.log("[SCORM] Session activity check failed, proceeding to initialize.",s)}var n=!1,a=null;try{var o=window.doInitialize();n="true"===o||!0===o}catch(s){if(console.warn("[SCORM] window.doInitialize() threw an error:",s),!s.message||!s.message.includes("Already initialized")&&!s.message.includes("103"))throw s;a={code:"103",message:s.message}}if(n||a||(a=M()),!n||a){if(a&&("103"===a.code||103===a.code||a.message&&a.message.includes("Already initialized"))){if(console.warn("[SCORM] Session already initialized (Error 103). Recovering session..."),e)return console.log("[SCORM] Session is active (Error 103). Forcing recovery."),void 0!==window.initialized?(window.initialized=!0,console.log("[SCORM] Wrapper state manually updated to initialized")):window.initialized=!0,A=!0,z=!0,!0;console.error("[SCORM] Could not get raw API handle for recovery.")}var i={domain:"scorm",operation:"Initialize",message:a?"SCORM initialization failed: ".concat(a.message):"SCORM initialization failed",context:a};throw E.emit("scorm:error",i),new Error(i.message)}return A=!0,console.log("[SCORM] Initialize() completed successfully"),!0}function L(e){if(I(),z)try{var t=window.getAPIHandle();if(!t)throw new Error("SCORM API handle lost during recovery");var r=t.GetValue(e),n=t.GetLastError?t.GetLastError().toString():"0";if("0"!==n){var a=t.GetErrorString?t.GetErrorString(n):"Unknown error";throw new Error("SCORM Error ".concat(n,": ").concat(a))}return"cmi.entry"===e&&console.log("[SCORM] getValue('".concat(e,"') [RECOVERED] returned: \"").concat(r,'"')),r||""}catch(l){var o={domain:"scorm",operation:"GetValue (Recovered)",message:'Failed to get value for "'.concat(e,'" in recovered mode: ').concat(l.message),context:{key:e,error:l}};throw E.emit("scorm:error",o),new Error(o.message)}var i=window.doGetValue(e),s=M();if(s){var c={domain:"scorm",operation:"GetValue",message:'Failed to get value for "'.concat(e,'": ').concat(s.message),context:{key:e,error:s}};throw E.emit("scorm:error",c),new Error(c.message)}return"cmi.suspend_data"===e?(console.log("[SCORM] getValue('cmi.suspend_data') called"),console.log("[SCORM]   Raw value type: ".concat(h(i))),console.log("[SCORM]   Raw value length: ".concat(i?i.length:0)),console.log("[SCORM]   Value is truthy: ".concat(!!i)),console.log("[SCORM]   Will return: ".concat(i?"actual data":"empty string"))):"cmi.entry"===e&&console.log("[SCORM] getValue('cmi.entry') returned: \"".concat(i,'"')),i||""}function T(e,t){I();var r="string"==typeof t?t:String(t),n=null;if("cmi.suspend_data"===e&&(n={isString:"string"==typeof t,actualType:h(t),stringValueType:h(r),length:(null==r?void 0:r.length)||0,sizeKB:(((null==r?void 0:r.length)||0)/1024).toFixed(2),hasNullCharacters:null==r?void 0:r.includes("\0"),hasControlCharacters:/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/.test(r),firstChar:null==r?void 0:r[0],firstCharCode:null==r?void 0:r.charCodeAt(0),lastChar:null==r?void 0:r[r.length-1],lastCharCode:null==r?void 0:r.charCodeAt(r.length-1),preview:null==r?void 0:r.substring(0,200)}),z)try{var a=window.getAPIHandle();if(!a)throw new Error("SCORM API handle lost during recovery");var o=a.SetValue(e,r);if(!("true"===o||!0===o)){var s=a.GetLastError?a.GetLastError().toString():"Unknown",c=a.GetErrorString?a.GetErrorString(s):"Unknown error";throw new Error("SCORM Error ".concat(s,": ").concat(c))}return!0}catch(g){var l={domain:"scorm",operation:"SetValue (Recovered)",message:'Failed to set value for "'.concat(e,'" in recovered mode: ').concat(g.message),context:{key:e,error:g}};throw E.emit("scorm:error",l),new Error(l.message)}var d=window.doSetValue(e,r);if(!("true"===d||!0===d)){var u=M(),p={key:e,valueType:h(t),valueLength:(null==r?void 0:r.length)||0,valueSizeKB:(((null==r?void 0:r.length)||0)/1024).toFixed(2),valuePreview:(null==r?void 0:r.substring(0,200))+((null==r?void 0:r.length)>200?"...":""),error:u};"cmi.suspend_data"===e&&n&&(p.suspendDataDiagnostics=i(i({},n),{},{jsonParseTest:function(){try{return JSON.parse(r),"valid"}catch(g){return"invalid: ".concat(g.message)}}()}));var m={domain:"scorm",operation:"SetValue",message:u?'Failed to set value for "'.concat(e,'": ').concat(u.message):'Failed to set value for "'.concat(e,'"'),stack:(new Error).stack,context:p};throw E.emit("scorm:error",m),new Error(m.message)}return!0}for(var O,j="@slides/",_="../../../course/slides/",R=Object.assign({"../../../course/slides/assessment.js":function(){return m(function(){return o.import("./assessment-legacy.js")},void 0,o.meta.url)},"../../../course/slides/content.js":function(){return m(function(){return o.import("./content-legacy.js")},void 0,o.meta.url)},"../../../course/slides/intro.js":function(){return m(function(){return o.import("./intro-legacy.js")},void 0,o.meta.url)},"../../../course/slides/remedial.js":function(){return m(function(){return o.import("./remedial-legacy.js")},void 0,o.meta.url)},"../../../course/slides/summary.js":function(){return m(function(){return o.import("./summary-legacy.js")},void 0,o.meta.url)},"../../../course/slides/ui-demo.js":function(){return m(function(){return o.import("./ui-demo-legacy.js")},void 0,o.meta.url)}}),D=new Map,N=0,P=Object.entries(R);N<P.length;N++){var B=a(P[N],2),F=B[0],V=B[1],H=be(F);D.set(H,V)}function U(e){return W.apply(this,arguments)}function W(){return W=u(c().m(function e(t){var r,n,a;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=he(t),n=D.get(r)){e.n=1;break}throw new Error("Failed to find slide module registered at ".concat(r," (original: ").concat(t,")"));case 1:return e.p=1,e.n=2,n();case 2:return e.a(2,e.v);case 3:throw e.p=3,a=e.v,console.error("Failed to load slide module for path: ".concat(t),a),new Error("Failed to load slide module at ".concat(t,": ").concat(a.message));case 4:return e.a(2)}},e,null,[[1,3]])})),W.apply(this,arguments)}var Y=null;function Q(e){if(!e)throw new Error("normalizeControls: controls parameter is required");return{showNext:!1!==e.showNext,showPrevious:!1!==e.showPrevious,nextTarget:e.nextTarget||null,previousTarget:e.previousTarget||null,exitTarget:e.exitTarget||null}}function G(e){return(t=e,t?Array.isArray(t)?t:[t]:[]).map(function(e){return e&&"object"===h(e)?i({},e):null}).filter(Boolean);var t}function J(e){if(!e)return null;if(!e.conditions)throw new Error('Gating configuration must have a "conditions" array. Legacy "condition" property is not supported.');var t=G(e.conditions);return t.length?{mode:"any"===e.mode?"any":"all",message:e.message||null,conditions:t}:null}function K(e){if(!e)return null;var t=G(e.includeWhen),r=G(e.skipUntil),n=e.insert&&(e.insert.slideId||e.insert.anchor)?{position:"after"===e.insert.position?"after":"before",slideId:e.insert.slideId||e.insert.anchor}:null;return{includeByDefault:!1!==e.includeByDefault,includeWhen:t,skipUntil:r,insert:n,message:e.message||null}}function Z(e,t,r){if(!e)throw new Error("normalizeNavigation: nodeNavigation parameter is required");return{sequential:!1!==e.sequential,controls:Q(e.controls||{showNext:!0,showPrevious:!0}),gating:J(e.gating),sequence:K(e.sequence),assessmentRef:e.assessmentRef||("assessment"===t?r:null)}}function $(){if(!O)throw new Error("CourseHelpers: courseConfig not initialized. Call init() first.");if(!Array.isArray(O.structure))throw new Error("CourseHelpers: courseConfig.structure must be an array.");return O.structure}function X(){return ee.apply(this,arguments)}function ee(){return ee=u(c().m(function e(){var t,r,n,a,o,i;return c().w(function(e){for(;;)switch(e.n){case 0:if(i=function(){return i=u(c().m(function e(i){var s,l,d,u,p,m,g,f,v,y,w,x,k,S,E,A,C,z,I,M,q,L,T,O,j,_,R=arguments;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:if(s=R.length>1&&void 0!==R[1]?R[1]:0,l=R.length>2&&void 0!==R[2]?R[2]:n,Array.isArray(i)){e.n=1;break}return e.a(2);case 1:d=b(i),e.p=2,d.s();case 3:if((u=d.n()).done){e.n=17;break}if((m=u.value)&&"object"===h(m)){e.n=4;break}return e.a(3,16);case 4:if("section"!==m.type){e.n=7;break}return w=[],e.n=5,o(m.children||[],s+1,w);case 5:if(!(m.menu&&m.menu.hidden)){e.n=6;break}return l.push.apply(l,w),e.a(3,16);case 6:return x=(null===(g=m.menu)||void 0===g?void 0:g.label)||m.title||m.id||"Section",k={type:"section",id:m.id||x.toLowerCase().replace(/\s+/g,"-"),label:x,icon:(null===(f=m.menu)||void 0===f?void 0:f.icon)||null,defaultExpanded:!1!==(null===(v=m.menu)||void 0===v?void 0:v.defaultExpanded),collapsible:!1!==(null===(y=m.menu)||void 0===y?void 0:y.collapsible),level:s,children:w},l.push(k),e.a(3,16);case 7:if("string"==typeof(S=m.component||m.slide||m.content||m.module)){e.n=8;break}throw new Error("Slide '".concat(m.id||"unknown","' is missing a component path string."));case 8:if(E=m.id){e.n=9;break}throw new Error("Slide is missing an id");case 9:return A=void 0,C=null,z="assessment"===m.type?"assessment":"slide",e.n=10,U(S);case 10:if(I=e.v,"assessment"!==z){e.n=14;break}if(I.config&&I.slide){e.n=11;break}throw new Error("Assessment module at ".concat(S," must export named 'config' and 'slide' objects."));case 11:if("function"==typeof I.slide.render){e.n=12;break}throw new Error("Assessment 'slide' export at ".concat(S," does not have a render function."));case 12:if(C=I.config.id,A=I.slide,!a.has(C)){e.n=13;break}throw new Error("[CourseHelpers] Duplicate assessment ID '".concat(C,"' found. Each assessment must have a unique ID in course-config.js."));case 13:a.set(C,I.config),e.n=15;break;case 14:if((A=Object.values(I)[0])&&"function"==typeof A.render){e.n=15;break}throw new Error("Slide module at ".concat(S," does not have a valid component export with a render function."));case 15:M=m.title||A.title||(null===(p=m.menu)||void 0===p?void 0:p.label)||E,q=Z(m.navigation||{},z,C),L=m.menu||{},T=t.length,O={type:z,id:E,assessmentId:C,index:T,component:A,title:M,engagement:m.engagement,navigation:q,menu:L,metadata:m.metadata||{},assessment:"assessment"===z?m.assessment||{}:null},t.push(O),r[E]=T,L.hidden||(j={type:"slide",id:E,label:L.label||M,icon:L.icon||null,level:s,slideIndex:T},l.push(j));case 16:e.n=3;break;case 17:e.n=19;break;case 18:e.p=18,_=e.v,d.e(_);case 19:return e.p=19,d.f(),e.f(19);case 20:return e.a(2)}},e,null,[[2,18,19,20]])})),i.apply(this,arguments)},o=function(e){return i.apply(this,arguments)},!Y){e.n=1;break}return e.a(2,Y);case 1:return t=[],r={},n=[],a=new Map,e.n=2,o($(),0,n);case 2:return Y={slides:t,indexById:r,menuTree:n,assessmentConfigs:a},e.a(2,Y)}},e)})),ee.apply(this,arguments)}function te(e){return e?i(i({},e),{},{navigation:f(e.navigation),menu:f(e.menu),metadata:f(e.metadata),assessment:f(e.assessment)}):null}function re(e){if(O)throw new Error("CourseHelpers: Already initialized. Do not call init() more than once.");if(!e)throw new Error("CourseHelpers: config parameter is required.");O=Object.freeze(e)}function ne(){return ae.apply(this,arguments)}function ae(){return(ae=u(c().m(function e(){var t;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,X();case 1:return t=e.v,e.a(2,t.slides.map(function(e){return te(e)}))}},e)}))).apply(this,arguments)}function oe(e){return ie.apply(this,arguments)}function ie(){return(ie=u(c().m(function e(t){var r;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,X();case 1:return r=e.v,e.a(2,te(r.slides[t]||null))}},e)}))).apply(this,arguments)}function se(e){return ce.apply(this,arguments)}function ce(){return(ce=u(c().m(function e(t){var r,n;return c().w(function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}return e.a(2,null);case 1:return e.n=2,X();case 2:return r=e.v,n=r.indexById[t],e.a(2,void 0===n?null:n)}},e)}))).apply(this,arguments)}function le(e){return de.apply(this,arguments)}function de(){return(de=u(c().m(function e(t){var r;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,se(t);case 1:if(null!==(r=e.v)){e.n=2;break}return e.a(2,null);case 2:return e.a(2,oe(r))}},e)}))).apply(this,arguments)}function ue(){return pe.apply(this,arguments)}function pe(){return(pe=u(c().m(function e(){var t;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,X();case 1:return t=e.v,e.a(2,f(t.menuTree))}},e)}))).apply(this,arguments)}function me(e){return ge.apply(this,arguments)}function ge(){return(ge=u(c().m(function e(t){var r;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,X();case 1:return r=e.v,e.a(2,r.slides.filter(function(e){return e.type===t}).map(function(e){return f(e)}))}},e)}))).apply(this,arguments)}function fe(){return ve.apply(this,arguments)}function ve(){return(ve=u(c().m(function e(){var t;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,X();case 1:return t=e.v,e.a(2,t.assessmentConfigs)}},e)}))).apply(this,arguments)}function he(e){if(!e||"string"!=typeof e)throw new Error("Slide module path must be a non-empty string.");var t=e.replace(/\\/g,"/");if(t.startsWith(j))return t;var r=t.replace(/^\.\//,"");if(r.startsWith("course/slides/"))return"".concat(j).concat(r.slice(14));var n=r.indexOf("/course/slides/");return-1!==n?"".concat(j).concat(r.slice(n+15)):t}function be(e){var t=e.replace(/\\/g,"/");return t.startsWith(_)?"".concat(j).concat(t.slice(23)):t}var ye=["true-false","choice","fill-in","long-fill-in","matching","performance","sequencing","likert","numeric","other"],we=["correct","incorrect","unanticipated","neutral"];function xe(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"value";return t.includes(e)?{valid:!0,error:null}:{valid:!1,error:"Invalid ".concat(r,' "').concat(e,'". Must be one of: ').concat(t.join(", "))}}var ke={dropdown:{trigger:"toggle-dropdown",item:"select-item"},tabs:{button:"select-tab"},modal:{close:"close-modal"},interaction:{check:"check-answer",reset:"reset"}};function Se(e){var t=[];return e.querySelectorAll('.custom-dropdown, [class*="dropdown"]').forEach(function(e){e.querySelectorAll('.dropdown-trigger, [class*="dropdown-trigger"]').forEach(function(e){if(e.hasAttribute("data-action")){var r=e.getAttribute("data-action");r!==ke.dropdown.trigger&&t.push({message:'Dropdown trigger has incorrect data-action="'.concat(r,'"'),context:{element:e.outerHTML,actual:r,expected:ke.dropdown.trigger,fix:'Change to data-action="'.concat(ke.dropdown.trigger,'".')}})}else t.push({message:"Dropdown trigger is missing data-action attribute",context:{element:e.outerHTML,expected:'data-action="'.concat(ke.dropdown.trigger,'"'),fix:'Add data-action="toggle-dropdown" to the dropdown trigger button.'}})}),e.querySelectorAll('.dropdown-item, [class*="dropdown-item"]').forEach(function(e){if(e.hasAttribute("data-action")){var r=e.getAttribute("data-action");r!==ke.dropdown.item&&t.push({message:'Dropdown item has incorrect data-action="'.concat(r,'"'),context:{element:e.outerHTML,actual:r,expected:ke.dropdown.item,fix:'Change to data-action="'.concat(ke.dropdown.item,'".')}})}else t.push({message:"Dropdown item is missing data-action attribute",context:{element:e.outerHTML,expected:'data-action="'.concat(ke.dropdown.item,'"'),fix:'Add data-action="select-item" to the dropdown item.'}})})}),{valid:0===t.length,errors:t}}function Ee(e){var t=[];return e.querySelectorAll('.tabs, [role="tablist"]').forEach(function(e){e.querySelectorAll('.tab-button, [role="tab"]').forEach(function(e){if(e.hasAttribute("data-action")){var r=e.getAttribute("data-action");r!==ke.tabs.button&&t.push({message:'Tab button has incorrect data-action="'.concat(r,'"'),context:{element:e.outerHTML,actual:r,expected:ke.tabs.button,fix:'Change to data-action="'.concat(ke.tabs.button,'".')}})}else t.push({message:"Tab button is missing data-action attribute",context:{element:e.outerHTML,expected:'data-action="'.concat(ke.tabs.button,'"'),fix:'Add data-action="select-tab" to the tab button.'}})})}),{valid:0===t.length,errors:t}}function Ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=[];Se(e).errors.forEach(function(e){r.push(i({type:"dropdown",viewName:t},e))}),Ee(e).errors.forEach(function(e){r.push(i({type:"tabs",viewName:t},e))});var n=function(e){var t=[];return e.querySelectorAll('.modal, [role="dialog"]').forEach(function(e){e.querySelectorAll('.modal-close, button[aria-label*="close" i], button[aria-label*="dismiss" i]').forEach(function(e){if(e.hasAttribute("data-action")){var r=e.getAttribute("data-action");r!==ke.modal.close&&t.push({message:'Modal close button has incorrect data-action="'.concat(r,'"'),context:{element:e.outerHTML,actual:r,expected:ke.modal.close,fix:'Change to data-action="'.concat(ke.modal.close,'".')}})}else t.push({message:"Modal close button is missing data-action attribute",context:{element:e.outerHTML,expected:'data-action="'.concat(ke.modal.close,'"'),fix:'Add data-action="close-modal" to the modal close button.'}})})}),{valid:0===t.length,errors:t}}(e);n.errors.forEach(function(e){r.push(i({type:"modal",viewName:t},e))});var a=function(e){var t=[];return e.querySelectorAll('[data-interaction-type], .interaction, [class*="interaction-"]').forEach(function(e){var r=e.id||e.dataset.interaction||"unknown";e.querySelectorAll('.check-answer, button[class*="check"]').forEach(function(e){if(e.hasAttribute("data-action")){var n=e.getAttribute("data-action");n!==ke.interaction.check&&n!==ke.interaction.reset&&t.push({message:'Interaction button has incorrect data-action="'.concat(n,'"'),context:{interactionId:r,element:e.outerHTML,actual:n,expected:'"'.concat(ke.interaction.check,'" or "').concat(ke.interaction.reset,'"'),fix:'Use data-action="check-answer" or data-action="reset".'}})}else t.push({message:"Interaction check button is missing data-action attribute",context:{interactionId:r,element:e.outerHTML,expected:'data-action="'.concat(ke.interaction.check,'"'),fix:'Add data-action="check-answer" and data-interaction="[id]" to the check button.'}});e.hasAttribute("data-interaction")||t.push({message:"Interaction button is missing data-interaction attribute",context:{interactionId:r,element:e.outerHTML,fix:'Add data-interaction="[id]" to identify which interaction this button controls.'}})})}),{valid:0===t.length,errors:t}}(e);return a.errors.forEach(function(e){r.push(i({type:"interaction",viewName:t},e))}),{valid:0===r.length,errors:r}}function Ce(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=[],n=function(e){var t=[];return e.querySelectorAll("form").forEach(function(e){var r=e.querySelectorAll("button:not([type])");r.length>0&&t.push({message:"Found ".concat(r.length," button(s) inside a form without a 'type' attribute"),context:{form:e.outerHTML.substring(0,200)+"...",buttons:Array.from(r).map(function(e){return e.outerHTML}),fix:'Add type="button" to buttons that should not submit the form, or type="submit" for submit buttons.'}})}),{valid:0===t.length,errors:t}}(e);n.errors.forEach(function(e){r.push(i({type:"form-button",viewName:t},e))});var a=function(e){var t=[];return e.querySelectorAll("[data-action]").forEach(function(e){"BUTTON"===e.tagName&&e.closest("form")&&!e.hasAttribute("type")&&t.push({message:"Button with data-action inside a form is missing type attribute",context:{button:e.outerHTML,action:e.getAttribute("data-action"),fix:'Add type="button" to prevent the button from submitting the form.'}})}),{valid:0===t.length,errors:t}}(e);a.errors.forEach(function(e){r.push(i({type:"action-button",viewName:t},e))});var o=function(e){var t=[],r=e.querySelectorAll('a[href="#"], a[href=""]');return r.length>0&&t.push({message:"Found ".concat(r.length," anchor tag(s) with dangerous href attribute"),context:{anchors:Array.from(r).map(function(e){return e.outerHTML}),fix:'For internal navigation, use NavigationActions.goToSlide(). For other actions, use a <button type="button">. For external links, use a valid URL.'}}),{valid:0===t.length,errors:t}}(e);o.errors.forEach(function(e){r.push(i({type:"anchor",viewName:t},e))});var s=Ae(e,t);return r.push.apply(r,v(s.errors)),{valid:0===r.length,errors:r}}var ze=new Set(["cmi.learner_id","cmi.learner_name","cmi.credit","cmi.mode","cmi.total_time","cmi.max_time_allowed","cmi.time_limit_action","cmi.launch_data","cmi.comments_from_lms","cmi.objectives._count","cmi.interactions._count"]),Ie=function(){return g(function e(){p(this,e),this.state={},this.isInitialized=!1,this.isTerminated=!1},[{key:"initialize",value:function(){if(this.isInitialized)throw new Error("StateManager: Already initialized. Do not call initialize() more than once.");this._hydrateStateFromLMS(),this.isInitialized=!0,console.log("[StateManager] Initialized and state hydrated from LMS"),E.emit("state:initialized",this.getState())}},{key:"getState",value:function(){if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");return f(this.state)}},{key:"getDomainState",value:function(e){if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");if("string"!=typeof e||""===e.trim())throw new Error("StateManager: domain must be a non-empty string");return this.state[e]?f(this.state[e]):void 0}},{key:"setDomainState",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTerminated)throw new Error("StateManager: Cannot set state after termination. The SCORM session has ended.");if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");if("string"!=typeof e||""===e.trim())throw new Error("StateManager: domain must be a non-empty string");this.state[e]=t,console.log("[StateManager] State updated for domain: ".concat(e)),E.emit("state:changed",{domain:e,value:t,meta:r}),this._commitToLMS()}},{key:"getValue",value:function(e){if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");return L(e)}},{key:"setValue",value:function(e,t){if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");if(ze.has(e))throw new Error("StateManager: Cannot write to read-only SCORM element: ".concat(e));return T(e,t)}},{key:"exitCourseWithSuspend",value:function(){if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");if(this.isTerminated)throw new Error("StateManager: Already terminated. Cannot exit course again.");return console.log("[StateManager] Exiting course with suspend status"),this.setValue("cmi.exit","suspend"),this.terminate()}},{key:"exitCourseComplete",value:function(){if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");if(this.isTerminated)throw new Error("StateManager: Already terminated. Cannot exit course again.");return console.log("[StateManager] Exiting course with normal status"),this.setValue("cmi.exit",""),this.terminate()}},{key:"terminate",value:function(){if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");if(this.isTerminated)throw new Error("StateManager: Already terminated. Cannot terminate again.");return console.log("[StateManager] Terminating..."),this._commitToLMS(),this.isTerminated=!0,function(){if(!A||C)return!0;var e=window.doTerminate();if(!(C="true"===e||!0===e)){var t=M(),r={domain:"scorm",operation:"Terminate",message:t?"SCORM termination failed: ".concat(t.message):"SCORM termination failed",context:t};throw E.emit("scorm:error",r),new Error(r.message)}return!0}()}},{key:"getComments",value:function(){if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");var e=[],t=this.getValue("cmi.comments_from_learner._count");if(t>0)for(var r=0;r<t;r++)e.push({text:this.getValue("cmi.comments_from_learner.".concat(r,".comment")),location:this.getValue("cmi.comments_from_learner.".concat(r,".location")),timestamp:this.getValue("cmi.comments_from_learner.".concat(r,".timestamp"))});return e}},{key:"addComment",value:function(e){if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");if(!e||"object"!==h(e))throw new Error("StateManager: commentObject must be a valid object");if(!e.text||"string"!=typeof e.text)throw new Error("StateManager: comment text is required and must be a string");var t=this.getValue("cmi.comments_from_learner._count");this.setValue("cmi.comments_from_learner.".concat(t,".comment"),e.text),this.setValue("cmi.comments_from_learner.".concat(t,".location"),e.location||""),this.setValue("cmi.comments_from_learner.".concat(t,".timestamp"),e.timestamp||(new Date).toISOString()),console.log("[StateManager] Comment added to cmi.comments_from_learner.".concat(t))}},{key:"updateProgressMeasure",value:function(e){if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");if(this.isTerminated)throw new Error("StateManager: Cannot update progress after termination.");if(!e||e<=0)throw new Error("StateManager: totalSlides must be provided and greater than 0");try{var t=((this.getDomainState("navigation")||{}).visitedSlides||[]).length,r=Math.min(t/e,1);return r=Math.max(0,Math.min(1,r)),r=Math.round(100*r)/100,this.setValue("cmi.progress_measure",r.toString()),console.log("[StateManager] Progress measure updated: ".concat(r," (").concat((100*r).toFixed(0),"%)")),console.log("  - Slides visited: ".concat(t,"/").concat(e)),E.emit("progress:updated",{progressMeasure:r,visitedSlides:t,totalSlides:e}),r}catch(n){throw console.error("[StateManager] Error updating progress_measure:",n),E.emit("state:error",{domain:"progress",operation:"updateProgressMeasure",message:n.message,stack:n.stack}),n}}},{key:"clearAllData",value:function(){if(!this.isInitialized)throw new Error("StateManager: Not initialized. Call initialize() first.");if(this.isTerminated)throw new Error("StateManager: Cannot clear data after termination.");console.log("[StateManager] Clearing all suspend data for course restart"),this.state={},this._commitToLMS(),E.emit("state:cleared",{reason:"course restart"})}},{key:"_hydrateStateFromLMS",value:function(){var e;try{e=L("cmi.entry"),console.log('[StateManager] Entry mode: "'.concat(e,'"'))}catch(r){throw new Error("StateManager: Cannot read cmi.entry. SCORM API may not be initialized. Error: ".concat(r.message))}if("ab-initio"===e)return this.state={},void console.log("[StateManager] Fresh session (ab-initio), starting with empty state");var t=function(){var e=L("cmi.suspend_data");if(console.log("[SCORM] getSuspendData() called"),console.log("[SCORM] Raw suspend_data type: ".concat(h(e))),console.log("[SCORM] Raw suspend_data length: ".concat(e?e.length:0)),console.log("[SCORM] Raw suspend_data value: ".concat(e?e.length>200?e.substring(0,200)+"...":e:"(empty)")),!e)return console.log("[SCORM] No suspend_data found (empty/null/undefined)"),null;try{var t=JSON.parse(e);return console.log("[SCORM] Successfully parsed suspend_data with ".concat(Object.keys(t).length," domain(s)")),t}catch(r){var n={domain:"scorm",operation:"GetSuspendData",message:"Failed to parse suspend data as JSON: ".concat(r.message),context:{rawData:e,parseError:r.message}};throw E.emit("scorm:error",n),new Error(n.message)}}();t?(this.state=t,console.log("[StateManager] Hydrated state from suspend_data"),console.log("[StateManager] Restored ".concat(Object.keys(t).length," domain(s) from previous session"))):(this.state={},"resume"===e?console.warn('[StateManager] Entry mode is "resume" but no suspend_data found. This may indicate a previous session that was not properly saved.'):console.log("[StateManager] No suspend_data found, starting with fresh state"))}},{key:"_commitToLMS",value:function(){if(!this.isInitialized||this.isTerminated)throw new Error("StateManager: Cannot commit. Manager is not initialized or already terminated.");try{var e={domains:Object.keys(this.state),domainSizes:Object.fromEntries(Object.entries(this.state).map(function(e){var t=a(e,2),r=t[0],n=t[1];return[r,JSON.stringify(n).length]})),totalSize:JSON.stringify(this.state).length,totalSizeKB:(JSON.stringify(this.state).length/1024).toFixed(2)};return console.log("[StateManager] Committing state:",e),function(e){if(null==e){var t={domain:"scorm",operation:"SetSuspendData",message:"Cannot set suspend data: data is null or undefined",context:{dataType:h(e),dataValue:e}};throw E.emit("scorm:error",t),new Error(t.message)}var r,n;try{n={topLevelKeys:Object.keys(e),dataType:h(e),isArray:Array.isArray(e),keyCount:Object.keys(e).length},r=JSON.stringify(e)}catch(c){var a={domain:"scorm",operation:"SetSuspendData",message:"Failed to serialize suspend data to JSON: ".concat(c.message),context:{serializeError:c.message,dataType:h(e),dataSnapshot:n,stack:c.stack}};throw E.emit("scorm:error",a),new Error(a.message)}if("string"!=typeof r){var o={domain:"scorm",operation:"SetSuspendData",message:"JSON.stringify returned invalid type: ".concat(h(r)),context:{serializedType:h(r),serializedValue:r}};throw E.emit("scorm:error",o),new Error(o.message)}if(r.includes("\0")){var i={domain:"scorm",operation:"SetSuspendData",message:"Serialized data contains null characters (\\0) which are invalid for SCORM",context:{dataSnapshot:n,length:r.length,nullCharPosition:r.indexOf("\0")}};throw E.emit("scorm:error",i),new Error(i.message)}var s=(r.length/1024).toFixed(2);E.emit("suspend-data:size",{bytes:r.length,kilobytes:parseFloat(s)}),r.length>64e3?(console.error("[SCORM] ⚠️ CRITICAL: suspend_data is ".concat(s,"KB (over 64KB). Many LMSs will reject this! Immediate optimization required.")),E.emit("suspend-data:critical",{bytes:r.length})):r.length>32e3?(console.warn("[SCORM] ⚠️ WARNING: suspend_data is ".concat(s,"KB (over 32KB). Approaching critical threshold. Consider optimization.")),E.emit("suspend-data:warning",{bytes:r.length})):r.length>16e3?console.info("[SCORM] ℹ️ INFO: suspend_data is ".concat(s,"KB (over 16KB). Within safe limits but monitor growth.")):r.length>4096?console.info("[SCORM] ℹ️ INFO: suspend_data is ".concat(s,"KB (over 4KB). Some LMS implementations have 4KB limits.")):console.log("[SCORM] ✓ suspend_data size: ".concat(s,"KB (healthy)")),T("cmi.suspend_data",r)}(this.state),function(){if(I(),z)try{var e=window.getAPIHandle();if(!e)throw new Error("SCORM API handle lost during recovery");var t=e.Commit("");if("true"!==t&&!0!==t){var r=e.GetLastError?e.GetLastError().toString():"Unknown",n=e.GetErrorString?e.GetErrorString(r):"Unknown error";throw new Error("SCORM Error ".concat(r,": ").concat(n))}return!0}catch(c){var a={domain:"scorm",operation:"Commit (Recovered)",message:"Failed to commit in recovered mode: ".concat(c.message),context:{error:c}};throw E.emit("scorm:error",a),new Error(a.message)}var o=window.doCommit();if("true"!==o&&!0!==o){var i=M(),s={domain:"scorm",operation:"Commit",message:i?"SCORM commit failed: ".concat(i.message):"SCORM commit failed",context:{error:i}};throw E.emit("scorm:error",s),new Error(s.message)}}(),console.log("[StateManager] State committed to LMS"),E.emit("state:committed"),!0}catch(l){for(var t={domains:Object.keys(this.state),domainSizes:{},problematicDomains:[]},r=0,n=Object.entries(this.state);r<n.length;r++){var o=a(n[r],2),i=o[0],s=o[1];try{var c=JSON.stringify(s);t.domainSizes[i]=c.length,c.length>1e4&&t.problematicDomains.push({domain:i,size:c.length,sizeKB:(c.length/1024).toFixed(2)})}catch(d){t.domainSizes[i]="SERIALIZATION_FAILED",t.problematicDomains.push({domain:i,error:d.message})}}throw E.emit("state:error",{domain:"state",operation:"commit",message:l.message,stack:l.stack,context:{stateSnapshot:t,originalError:l.message}}),console.error("[StateManager] Commit failed with detailed diagnostics:"),console.error("State structure:",JSON.stringify(t,null,2)),console.error("Original error:",l.message),console.error("Error stack:",l.stack),l}}}])}(),Me=n("a",new Ie),qe=new Set(["theme","darkMode","fontSize","highContrast","reducedMotion"]),Le=Object.freeze({theme:"light",darkMode:!1,fontSize:"normal",highContrast:!1,reducedMotion:!1}),Te=function(){return g(function e(){p(this,e),this.state=i({},Le),this.isInitialized=!1,this.DOMAIN_KEY="accessibility",this.SOURCE="accessibility-manager",this.elements={themeToggle:null,fontSizeToggle:null,highContrastToggle:null,reducedMotionToggle:null,accessibilityMenu:null,accessibilityButton:null}},[{key:"initialize",value:function(){if(this.isInitialized)throw new Error("AccessibilityManager: Already initialized. Do not call initialize() more than once.");try{this._loadState(),this._getDOMElements(),this._updateUI(),this._setupEventListeners(),this._initializeAccessibilityMenu(),this.isInitialized=!0,console.log("AccessibilityManager Initialized",this.state),E.emit("accessibility:initialized",this.state)}catch(e){throw console.error("[AccessibilityManager] Initialization failed:",e),e}}},{key:"setPreference",value:function(e,t){if(!qe.has(e))throw new Error("AccessibilityManager: Unknown preference key: ".concat(e));var r=i({},this.state);"theme"===e?(r.theme="dark"===t?"dark":"light",r.darkMode="dark"===r.theme):"darkMode"===e?(r.darkMode=!!t,r.theme=r.darkMode?"dark":"light"):r[e]=t,this.state=r,this._updateUI(),Me.setDomainState(this.DOMAIN_KEY,this.state,{source:this.SOURCE}),E.emit("accessibility:changed",{key:e,value:this.state[e]})}},{key:"getState",value:function(){return i({},this.state)}},{key:"announce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"polite";if(e){var r=document.getElementById("sr-announcements");r||((r=document.createElement("div")).id="sr-announcements",r.setAttribute("role","status"),r.setAttribute("aria-atomic","true"),r.className="sr-only",document.body.appendChild(r)),r.setAttribute("aria-live","off"),r.textContent="",r.offsetWidth,r.setAttribute("aria-live",t),r.textContent=e}}},{key:"setupKeyboardNav",value:function(e,t){var r=Array.from(t);if(0!==r.length){var n=0,a=function(){r.forEach(function(e,t){e.classList.toggle("keyboard-focus",t===n)})};e.addEventListener("keydown",function(e){var t=n;switch(e.key){case"ArrowRight":case"ArrowDown":e.preventDefault(),t=(n+1)%r.length;break;case"ArrowLeft":case"ArrowUp":e.preventDefault(),t=(n-1+r.length)%r.length;break;case"Home":e.preventDefault(),t=0;break;case"End":e.preventDefault(),t=r.length-1;break;default:return}r[n=t].focus(),a()}),r[0].focus(),a()}}},{key:"_loadState",value:function(){var e=Me.getDomainState(this.DOMAIN_KEY);e&&"object"===h(e)?this.state=i(i({},Le),e):this.state=i({},Le)}},{key:"_getDOMElements",value:function(){this.elements.themeToggle=document.getElementById("theme-toggle"),this.elements.fontSizeToggle=document.getElementById("font-size-toggle"),this.elements.highContrastToggle=document.getElementById("high-contrast-toggle"),this.elements.reducedMotionToggle=document.getElementById("reduced-motion-toggle"),this.elements.accessibilityMenu=document.getElementById("accessibility-menu"),this.elements.accessibilityButton=document.getElementById("accessibility-button")}},{key:"_setupEventListeners",value:function(){var e=this;this.elements.themeToggle&&this.elements.themeToggle.addEventListener("click",function(){var t="light"===e.state.theme?"dark":"light";e.setPreference("theme",t),e.announce("Switched to ".concat(t," mode"))}),this.elements.fontSizeToggle&&this.elements.fontSizeToggle.addEventListener("click",function(){var t="normal"===e.state.fontSize?"large":"normal";e.setPreference("fontSize",t),e.announce("Font size set to ".concat(t))}),this.elements.highContrastToggle&&this.elements.highContrastToggle.addEventListener("click",function(){var t=!e.state.highContrast;e.setPreference("highContrast",t),e.announce("High contrast ".concat(t?"enabled":"disabled"))}),this.elements.reducedMotionToggle&&this.elements.reducedMotionToggle.addEventListener("click",function(){var t=!e.state.reducedMotion;e.setPreference("reducedMotion",t),e.announce("Animations ".concat(t?"reduced":"enabled"))})}},{key:"_initializeAccessibilityMenu",value:function(){var e=this,t=this.elements,r=t.accessibilityButton,n=t.accessibilityMenu;if(r&&n){var a=!1,o=function(t){if(a=t,n.hidden=!t,r.setAttribute("aria-expanded",String(t)),t){e.announce("Accessibility menu opened");var o=n.querySelector("button");null==o||o.focus()}else e.announce("Accessibility menu closed")};r.addEventListener("click",function(){return o(!a)}),document.addEventListener("keydown",function(e){"Escape"===e.key&&a&&(o(!1),r.focus())}),document.addEventListener("click",function(e){!a||n.contains(e.target)||r.contains(e.target)||o(!1)})}}},{key:"_updateUI",value:function(){var e=document.documentElement;e&&(e.setAttribute("data-theme",this.state.theme),e.setAttribute("data-font-size",this.state.fontSize),e.setAttribute("data-high-contrast",String(this.state.highContrast)),e.setAttribute("data-reduced-motion",String(this.state.reducedMotion)),this._updateButtonStates())}},{key:"_updateButtonStates",value:function(){var e=this.elements,t=e.themeToggle,r=e.fontSizeToggle,n=e.highContrastToggle,a=e.reducedMotionToggle;if(t){var o=t.querySelector("span");o&&(o.textContent="dark"===this.state.theme?"☀️":"🌙"),t.setAttribute("aria-label","dark"===this.state.theme?"Switch to light mode":"Switch to dark mode")}r&&r.setAttribute("aria-label","large"===this.state.fontSize?"Decrease font size":"Increase font size"),n&&n.setAttribute("aria-label",this.state.highContrast?"Disable high contrast":"Enable high contrast"),a&&a.setAttribute("aria-label",this.state.reducedMotion?"Enable animations":"Reduce animations")}}])}(),Oe=new Te,je="navigation",_e=!1,Re={currentSlideIndex:0,visitedSlides:[]},De=[];function Ne(){if(_e)throw new Error("NavigationState: Already initialized. Do not call initializeNavigationState() more than once.");var e=Me.getDomainState(je);e&&(Re=i(i({},Re),e)),_e=!0,console.log("[NavigationState] Initialized:",Re)}function Pe(){return Re.currentSlideIndex}function Be(e){if(!Array.isArray(e)||0===e.length)throw new Error("NavigationState: Invalid slides array. Must be non-empty array.");De=e}function Fe(){var e=De[Re.currentSlideIndex];return e?e.id:null}function Ve(e){if("number"!=typeof e||e<0)throw new Error("NavigationState: Invalid slide index provided: ".concat(e));if(De.length>0&&e>=De.length)throw new Error("NavigationState: Slide index ".concat(e," exceeds bounds (max: ").concat(De.length-1,")"));Re.currentSlideIndex=e,We()}function He(){return v(Re.visitedSlides)}function Ue(e){e&&!Re.visitedSlides.includes(e)&&(Re.visitedSlides.push(e),We())}function We(){Me.setDomainState(je,Re,{source:"navigation-state"})}var Ye=function(){return g(function e(){p(this,e),this.domain="engagement",this.isInitialized=!1,this.courseConfig=null},[{key:"initialize",value:function(e){var t=this;if(!this.isInitialized){if(!e||!e.structure)throw new Error("[EngagementManager] courseConfig with structure is REQUIRED");this.courseConfig=e,E.on("flag:updated",this._handleFlagUpdate.bind(this)),E.on("flag:removed",this._handleFlagUpdate.bind(this)),E.on("interaction:recorded",function(e){var r=Fe();if(r){var n="correct"===e.result;t.trackInteraction(r,e.id,!0,n)}}),this.isInitialized=!0,console.log("[EngagementManager] Initialized (refactored v2.0)")}}},{key:"_getRequirementsFromConfig",value:function(e){if(!this.courseConfig||!this.courseConfig.structure)throw new Error("[EngagementManager] CRITICAL: courseConfig not available when looking up slide: ".concat(e));var t=function(r){var n,a=b(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o.id===e)return o;if(o.children){var i=t(o.children);if(i)return i}}}catch(s){a.e(s)}finally{a.f()}return null},r=t(this.courseConfig.structure);if(!r)throw new Error('[EngagementManager] CRITICAL: Slide "'.concat(e,'" not found in courseConfig.structure'));if(!r.engagement)throw new Error('[EngagementManager] CRITICAL: Slide "'.concat(e,'" has no engagement config in courseConfig'));return r.engagement}},{key:"initSlide",value:function(e,t){if(!e||"string"!=typeof e)throw new Error("[EngagementManager] slideId must be a non-empty string");if(!t||"object"!==h(t))throw new Error('[EngagementManager] Slide "'.concat(e,'" has invalid engagement requirements'));if(!(t.required||!1))return console.log('[EngagementManager] Slide "'.concat(e,'" does not require tracking, skipping state initialization')),void E.emit("engagement:initialized",{slideId:e,requirements:t});var r=this._getState(),n=r[e];!0===(null==n?void 0:n.complete)?(r[e].required=!0,console.log('[EngagementManager] Slide "'.concat(e,'" was already completed'))):(r[e]={required:!0,tracked:{tabsViewed:[],tabsTotal:0,accordionPanelsViewed:[],accordionPanelsTotal:0,interactionsCompleted:{},scrollDepth:0},complete:!1,completedAt:null},console.log("[EngagementManager] Initialized tracking for: ".concat(e))),this._setState(r),E.emit("engagement:initialized",{slideId:e,requirements:t})}},{key:"cleanupSlide",value:function(e){if(e){var t=this.evaluateRequirements(e);t.complete||E.emit("engagement:incomplete",{slideId:e,unmetRequirements:t.unmetRequirements}),console.log("[EngagementManager] Cleaned up: ".concat(e),t)}}},{key:"registerTabs",value:function(e,t){if(e&&Array.isArray(t)){var r=this._getState();r[e]&&(r[e].tracked.tabsTotal=t.length,this._setState(r),console.log("[EngagementManager] Registered ".concat(t.length," tabs: ").concat(e)),this._checkAndEmitProgress(e))}}},{key:"trackTabView",value:function(e,t){if(e&&t){var r=this._getState();if(r[e]){var n=r[e].tracked;n.tabsViewed.includes(t)||(n.tabsViewed.push(t),this._setState(r),console.log("[EngagementManager] Tab viewed: ".concat(t," (").concat(n.tabsViewed.length,"/").concat(n.tabsTotal,")")),this._checkAndEmitProgress(e))}}}},{key:"registerAccordion",value:function(e,t){if(e&&Array.isArray(t)){var r=this._getState();r[e]&&(r[e].tracked.accordionPanelsTotal=t.length,this._setState(r),console.log("[EngagementManager] Registered ".concat(t.length," accordion panels: ").concat(e)),this._checkAndEmitProgress(e))}}},{key:"trackAccordionPanel",value:function(e,t){if(e&&t){var r=this._getState();if(r[e]){var n=r[e].tracked;n.accordionPanelsViewed.includes(t)||(n.accordionPanelsViewed.push(t),this._setState(r),console.log("[EngagementManager] Panel viewed: ".concat(t," (").concat(n.accordionPanelsViewed.length,"/").concat(n.accordionPanelsTotal,")")),this._checkAndEmitProgress(e))}}}},{key:"trackInteraction",value:function(e,t,r,n){if(e&&t){var a=this._getState();a[e]&&(a[e].tracked.interactionsCompleted[t]={completed:r,correct:n,timestamp:Date.now()},this._setState(a),console.log("[EngagementManager] Interaction: ".concat(t," (completed: ").concat(r,", correct: ").concat(n,")")),this._checkAndEmitProgress(e))}}},{key:"trackScrollDepth",value:function(e,t){if(e&&"number"==typeof t){var r=this._getState();if(r[e])t>r[e].tracked.scrollDepth&&(r[e].tracked.scrollDepth=Math.min(100,Math.max(0,t)),this._setState(r),console.log("[EngagementManager] Scroll: ".concat(t,"% for ").concat(e)),this._checkAndEmitProgress(e))}}},{key:"evaluateRequirements",value:function(e){var t=this._getState(),r=t[e];if(!r)try{var n=this._getRequirementsFromConfig(e);return{complete:!((null==n?void 0:n.required)||!1),progress:{},unmetRequirements:[]}}catch(m){return{complete:!0,progress:{},unmetRequirements:[]}}if(!(r.required||!1))return{complete:!0,progress:{},unmetRequirements:[]};var a,o=this._getRequirementsFromConfig(e),i=o.requirements||[],s=o.mode||"all",c=[],l=b(i);try{for(l.s();!(a=l.n()).done;){var d=a.value,u=this._evaluateRequirement(e,d,r.tracked);u.met||c.push(u)}}catch(g){l.e(g)}finally{l.f()}var p="all"===s?0===c.length:c.length<i.length;return p&&!r.complete&&(r.complete=!0,r.completedAt=Date.now(),this._setState(t),E.emit("engagement:complete",{slideId:e})),{complete:p,progress:this._calculateProgress(e,r.tracked,i),unmetRequirements:c}}},{key:"_evaluateRequirement",value:function(e,t,r){var n=t.type;switch(n){case"viewAllTabs":var a=r.tabsTotal;return{met:a>0&&r.tabsViewed.length>=a,type:n,message:t.message,viewed:r.tabsViewed.length,total:a};case"viewAllPanels":var o=r.accordionPanelsTotal;return{met:o>0&&r.accordionPanelsViewed.length>=o,type:n,message:t.message,viewed:r.accordionPanelsViewed.length,total:o};case"interactionComplete":var i=t.interactionId,s=r.interactionsCompleted[i],c=(null==s?void 0:s.completed)||!1,l=(null==s?void 0:s.correct)||!1;return{met:t.requireCorrect?c&&l:c,type:n,message:t.message,interactionId:i,completed:c,correct:l};case"allInteractionsComplete":var d,u=Object.values(r.interactionsCompleted).filter(function(e){return t.requireCorrect?e.completed&&e.correct:e.completed}).length,p=null===(d=window.SCORM_Framework)||void 0===d?void 0:d.interactionRegistry,m=((null==p?void 0:p.getAll())||[]).length;return{met:m>0&&u>=m,type:n,message:t.message,completed:u,total:m};case"scrollDepth":var g=t.percentage||t.minPercentage||95;return{met:r.scrollDepth>=g,type:n,message:t.message,current:r.scrollDepth,required:g};case"timeOnSlide":var f=((Me.getDomainState("sessionData")||{}).slideDurations||{})[e]||0,v=Math.floor(f/1e3),b=t.minSeconds||0;return{met:v>=b,type:n,message:t.message,current:v,required:b};case"flag":var y=(Me.getDomainState("flags")||{})[t.key];return{met:void 0!==t.equals?y===t.equals:!!y,type:n,message:t.message||'Flag "'.concat(t.key,'" must be set'),flagKey:t.key,currentValue:y,requiredValue:t.equals};case"allFlags":var w=Me.getDomainState("flags")||{},x=t.flags||[],k=x.map(function(e){var t="string"==typeof e?e:e.key,r=w[t];return{key:t,met:"object"===h(e)&&void 0!==e.equals?r===e.equals:!!r,value:r}}),S=k.filter(function(e){return e.met}).length;return{met:S===x.length,type:n,message:t.message||"Complete all required steps",flags:k,completed:S,total:x.length};default:throw new Error("[EngagementManager] Unknown requirement type: ".concat(n,". Valid types: viewAllTabs, viewAllPanels, interactionComplete, allInteractionsComplete, scrollDepth, timeOnSlide, flag, allFlags."))}}},{key:"_calculateProgress",value:function(e,t,r){var n,a=this,o=[],i=0,s=b(r);try{var c=function(){var r,s=n.value,c=a._evaluateRequirement(e,s,t),l=c.met?1:0;if(!c.met)switch(s.type){case"viewAllTabs":t.tabsTotal>0&&(l=t.tabsViewed.length/t.tabsTotal);break;case"viewAllPanels":t.accordionPanelsTotal>0&&(l=t.accordionPanelsViewed.length/t.accordionPanelsTotal);break;case"allInteractionsComplete":var d=null===(r=window.SCORM_Framework)||void 0===r?void 0:r.interactionRegistry,u=((null==d?void 0:d.getAll())||[]).length;if(u>0)l=Object.values(t.interactionsCompleted).filter(function(e){return s.requireCorrect?e.completed&&e.correct:e.completed}).length/u;break;case"scrollDepth":var p=s.percentage||s.minPercentage||95;l=Math.min(1,t.scrollDepth/p);break;case"timeOnSlide":var m=((Me.getDomainState("sessionData")||{}).slideDurations||{})[e]||0,g=Math.floor(m/1e3),f=s.minSeconds||0;l=f>0?Math.min(1,g/f):0;break;case"flag":l=c.met?1:0;break;case"allFlags":c.total>0&&(l=c.completed/c.total)}o.push({type:s.type,label:s.message||a._getDefaultLabel(s.type),complete:c.met}),i+=l};for(s.s();!(n=s.n()).done;)c()}catch(l){s.e(l)}finally{s.f()}return{percentage:r.length>0?Math.round(i/r.length*100):100,items:o}}},{key:"_getDefaultLabel",value:function(e){return{viewAllTabs:"View all tabs",viewAllPanels:"View all accordion panels",interactionComplete:"Complete interaction",allInteractionsComplete:"Complete all interactions",scrollDepth:"Scroll to bottom",timeOnSlide:"Spend required time",flag:"Complete required step",allFlags:"Complete all required steps"}[e]||e}},{key:"isSlideComplete",value:function(e){return this.evaluateRequirements(e).complete}},{key:"getSlideState",value:function(e){return this._getState()[e]||null}},{key:"getProgress",value:function(e){var t=this.getSlideState(e);if(!t)return null;var r=this._getRequirementsFromConfig(e),n=(null==r?void 0:r.requirements)||[];return this._calculateProgress(e,t.tracked,n)}},{key:"resetSlide",value:function(e){var t=this._getState();if(t[e]){var r=this._getRequirementsFromConfig(e);if(!r)throw new Error("[EngagementManager] No requirements found for slide: ".concat(e,". Ensure slide has engagement config in course-config.js."));delete t[e],this._setState(t),this.initSlide(e,r),console.log("[EngagementManager] Reset: ".concat(e))}}},{key:"resetAllSlides",value:function(){this._setState({}),console.log("[EngagementManager] Reset all engagement"),E.emit("engagement:reset-all")}},{key:"_handleFlagUpdate",value:function(e){var t=this,r=e.key,n=(e.value,this._getState());Object.entries(n).forEach(function(e){var n,o=a(e,2),i=o[0],s=o[1],c=t._getRequirementsFromConfig(i);c&&c.required&&(s.complete||(null===(n=c.requirements)||void 0===n?void 0:n.some(function(e){return"flag"===e.type||"allFlags"===e.type}))&&(console.log('[EngagementManager] Flag "'.concat(r,'" updated, re-evaluating: ').concat(i)),t._checkAndEmitProgress(i)))})}},{key:"_checkAndEmitProgress",value:function(e){var t=this.evaluateRequirements(e);E.emit("engagement:progress",{slideId:e,complete:t.complete,progress:t.progress})}},{key:"_getState",value:function(){var e=Me.getDomainState(this.domain)||{};return this._mergeWithDefaults(e)}},{key:"_mergeWithDefaults",value:function(e){for(var t={},r=0,n=Object.entries(e);r<n.length;r++){var o,i,s,c,l,d,u=a(n[r],2),p=u[0],m=u[1];t[p]={required:m.required||!1,tracked:{tabsViewed:(null===(o=m.tracked)||void 0===o?void 0:o.tabsViewed)||[],tabsTotal:(null===(i=m.tracked)||void 0===i?void 0:i.tabsTotal)||0,accordionPanelsViewed:(null===(s=m.tracked)||void 0===s?void 0:s.accordionPanelsViewed)||[],accordionPanelsTotal:(null===(c=m.tracked)||void 0===c?void 0:c.accordionPanelsTotal)||0,interactionsCompleted:(null===(l=m.tracked)||void 0===l?void 0:l.interactionsCompleted)||{},scrollDepth:(null===(d=m.tracked)||void 0===d?void 0:d.scrollDepth)||0},complete:m.complete||!1,completedAt:m.completedAt||null}}return t}},{key:"_setState",value:function(e){try{var t=this._stripDefaultValues(e);Me.setDomainState(this.domain,t)}catch(r){console.error("[EngagementManager] Failed to save state:",r)}}},{key:"_stripDefaultValues",value:function(e){for(var t={},r=0,n=Object.entries(e);r<n.length;r++){var o=a(n[r],2),i=o[0],s=o[1],c={required:s.required};if(s.tracked){var l,d,u={};(null===(l=s.tracked.tabsViewed)||void 0===l?void 0:l.length)>0&&(u.tabsViewed=s.tracked.tabsViewed),s.tracked.tabsTotal>0&&(u.tabsTotal=s.tracked.tabsTotal),(null===(d=s.tracked.accordionPanelsViewed)||void 0===d?void 0:d.length)>0&&(u.accordionPanelsViewed=s.tracked.accordionPanelsViewed),s.tracked.accordionPanelsTotal>0&&(u.accordionPanelsTotal=s.tracked.accordionPanelsTotal),s.tracked.interactionsCompleted&&Object.keys(s.tracked.interactionsCompleted).length>0&&(u.interactionsCompleted=s.tracked.interactionsCompleted),s.tracked.scrollDepth>0&&(u.scrollDepth=s.tracked.scrollDepth),Object.keys(u).length>0&&(c.tracked=u)}c.complete=s.complete||!1,s.completedAt&&(c.completedAt=s.completedAt),t[i]=c}return t}}])}(),Qe=new Ye;var Ge=new Map,Je=!1;function Ke(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Je||(document.addEventListener("click",function(e){if(!e.target.closest(".dropdown-trigger")){var t,r=b(Ge.entries());try{for(r.s();!(t=r.n()).done;){var n=a(t.value,2),o=n[0],i=n[1];i.menu.classList.contains("active")&&!i.element.contains(e.target)&&Ze(o)}}catch(s){r.e(s)}finally{r.f()}}}),Je=!0);var r,n=(r=e)?r instanceof Element?r:"string"==typeof r?document.querySelector(r):null:null;if(!n)throw new Error('Dropdown with selector "'.concat(e,'" not found'));var o=n.id;if(!o)throw new Error("Dropdown container element must have an ID.");var s=n.querySelector(".dropdown-trigger"),c=n.querySelector(".dropdown-menu"),l=n.querySelectorAll(".dropdown-item");if(!s||!c)throw new Error('Dropdown "'.concat(o,'" missing required elements (.dropdown-trigger or .dropdown-menu)'));var d=Se(n);if(!d.valid){var u=d.errors.map(function(e){return"".concat(e.message,": ").concat(e.context.fix)}).join("; ");throw new Error('Dropdown "'.concat(o,'" validation failed: ').concat(u))}var p=i({onChange:t.onChange||null},t);return Ge.set(o,{element:n,trigger:s,menu:c,items:l,config:p}),s.setAttribute("aria-haspopup","listbox"),s.setAttribute("aria-expanded","false"),l.forEach(function(e){e.setAttribute("role","option"),e.setAttribute("tabindex","0")}),n.addEventListener("click",function(e){var t=e.target.closest("[data-action]");if(t){var r=t.dataset.action;if("toggle-dropdown"===r){var n,i=b(Ge.entries());try{for(i.s();!(n=i.n()).done;){var s=a(n.value,1)[0];s!==o&&Ze(s)}}catch(d){i.e(d)}finally{i.f()}!function(e){var t=Ge.get(e);if(!t)return;t.menu.classList.contains("active")?Ze(e):function(e){var t=Ge.get(e);if(!t)return;var r,n=b(Ge.entries());try{for(n.s();!(r=n.n()).done;){var o=a(r.value,1)[0];o!==e&&Ze(o)}}catch(d){n.e(d)}finally{n.f()}t.menu.classList.add("active"),t.trigger.classList.add("active"),t.trigger.setAttribute("aria-expanded","true")}(e)}(o)}else if("select-item"===r){var c=Array.from(l).indexOf(t);c>-1&&$e(o,c)}}}),c.addEventListener("keydown",function(e){return function(e,t){var r=Ge.get(e);if(!r)return;var n=r.items,a=r.trigger,o=Array.from(n).indexOf(document.activeElement);switch(t.key){case"ArrowDown":t.preventDefault(),o<n.length-1&&n[o+1].focus();break;case"ArrowUp":t.preventDefault(),o>0&&n[o-1].focus();break;case"Escape":t.preventDefault(),Ze(e),a.focus();break;case"Enter":case" ":t.preventDefault(),o>-1&&$e(e,o)}}(o,e)}),{destroy:function(){Ge.delete(o)}}}function Ze(e){var t=Ge.get(e);t&&(t.menu.classList.remove("active"),t.trigger.classList.remove("active"),t.trigger.setAttribute("aria-expanded","false"))}function $e(e,t){var r=Ge.get(e);if(r){var n=r.items,a=r.trigger,o=r.config,i=n[t];n.forEach(function(e){return e.classList.remove("selected")}),i.classList.add("selected"),(a.querySelector(".dropdown-text")||a).textContent=i.textContent,Ze(e),a.focus(),o.onChange&&o.onChange(i.dataset.value||i.textContent,t);var s=new CustomEvent("dropdown:change",{bubbles:!0,detail:{value:i.dataset.value||i.textContent,index:t,text:i.textContent}});r.element.dispatchEvent(s)}}var Xe=null,et=null,tt=null,rt=null,nt=null,at={},ot=null,it=!1;function st(){if(!it){if(Xe=document.getElementById("global-modal"),nt=document.querySelector(".modal-backdrop"),!Xe||!nt)throw new Error("Modal elements (#global-modal, .modal-backdrop) not found in the DOM.");et=document.getElementById("global-modal-title"),tt=document.getElementById("global-modal-body"),rt=document.getElementById("global-modal-footer"),Xe.addEventListener("click",function(e){e.target.closest('[data-action="close-modal"]')&&dt()}),nt.addEventListener("click",function(){at.closeOnBackdrop&&dt()}),document.addEventListener("keydown",function(e){"Escape"===e.key&&isVisible()&&at.closeOnEscape&&dt()}),it=!0}}function ct(e){e.addEventListener("click",function(){var t=e.dataset.title||"Modal",r=e.dataset.body||"",n=e.dataset.footer||'<button class="btn btn-secondary" data-action="close-modal">Close</button>';if(r.startsWith("#")){var a=document.querySelector(r);a&&(r=a.innerHTML)}if(n.startsWith("#")){var o=document.querySelector(n);o&&(n=o.innerHTML)}lt({title:t,body:r,footer:n,config:{closeOnBackdrop:"false"!==e.dataset.closeOnBackdrop,closeOnEscape:"false"!==e.dataset.closeOnEscape}})})}function lt(e){var t=e.title,r=e.body,n=e.footer,a=void 0===n?"":n,o=e.config,i=void 0===o?{}:o,s=e.onOpen,c=e.onClose;if(!it)throw new Error("Modal system not initialized. Call init() first.");at={closeOnBackdrop:!1!==i.closeOnBackdrop,closeOnEscape:!1!==i.closeOnEscape,onOpen:s,onClose:c},et.textContent=t,tt.innerHTML=r,rt.innerHTML=a,ot=document.activeElement,nt.classList.add("active"),Xe.classList.add("active"),Xe.setAttribute("aria-hidden","false"),setTimeout(function(){var e=Xe.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');e.length>0&&e[0].focus()},100),Xe._focusTrapCleanup=w(Xe),at.onOpen&&at.onOpen(Xe),ht("Modal opened: ".concat(t))}function dt(){it&&Xe.classList.contains("active")&&(Xe.classList.remove("active"),Xe.setAttribute("aria-hidden","true"),nt.classList.remove("active"),Xe._focusTrapCleanup&&"function"==typeof Xe._focusTrapCleanup&&(Xe._focusTrapCleanup(),Xe._focusTrapCleanup=null),ot&&(ot.focus(),ot=null),at.onClose&&at.onClose(Xe),et.textContent="",tt.innerHTML="",rt.innerHTML="",at={},ht("Modal closed"))}var ut=Object.freeze(Object.defineProperty({__proto__:null,hide:dt,init:st,initModalTrigger:ct,show:lt},Symbol.toStringTag,{value:"Module"}));function pt(e,t){var r="string"==typeof e?document.getElementById(e):e;if(r){var n=r.querySelector(".progress-bar-fill"),a=r.querySelector(".progress-bar-text"),o=Math.max(0,Math.min(100,t));r.style.setProperty("--progress-percent","".concat(o,"%")),r.setAttribute("aria-valuenow",o),n&&(n.style.width="".concat(o,"%")),a&&(a.textContent="".concat(Math.round(o),"%"))}else console.error("updateProgress: Element not found.",e)}var mt=null;function gt(){mt||((mt=document.createElement("div")).className="tooltip-container",mt.setAttribute("role","tooltip"),document.body.appendChild(mt))}function ft(e){mt||gt();var t=e.getAttribute("data-tooltip");t&&(mt.textContent=t,mt.classList.add("active"),function(e){var t,r,n=e.getBoundingClientRect(),a=mt.getBoundingClientRect(),o=e.dataset.tooltipPosition||"bottom",i=8;switch(o){case"top":t=n.top-a.height-i,r=n.left+n.width/2-a.width/2;break;case"right":t=n.top+n.height/2-a.height/2,r=n.right+i;break;case"left":t=n.top+n.height/2-a.height/2,r=n.left-a.width-i;break;default:t=n.bottom+i,r=n.left+n.width/2-a.width/2}r<0&&(r=i);r+a.width>window.innerWidth&&(r=window.innerWidth-a.width-i);t<0&&(t=i);t+a.height>window.innerHeight&&(t=window.innerHeight-a.height-i);mt.style.top="".concat(t+window.scrollY,"px"),mt.style.left="".concat(r+window.scrollX,"px")}(e))}function vt(e){if(e){gt();var t=e.querySelectorAll("[data-tooltip]");return t.forEach(function(e){var t=function(){return ft(e)},r=function(){mt&&mt.classList.remove("active")};e.addEventListener("mouseenter",t),e.addEventListener("focus",t),e.addEventListener("mouseleave",r),e.addEventListener("blur",r),e._tooltipListeners={show:t,hide:r}}),{destroy:function(){t.forEach(function(e){e._tooltipListeners&&(e.removeEventListener("mouseenter",e._tooltipListeners.show),e.removeEventListener("focus",e._tooltipListeners.show),e.removeEventListener("mouseleave",e._tooltipListeners.hide),e.removeEventListener("blur",e._tooltipListeners.hide),delete e._tooltipListeners)})}}}}function ht(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"polite";Oe.announce(e,t)}function bt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=yt(e);if(!r)throw new Error("UIComponents.initTabs: container not found");var n=t.buttonSelector||r.dataset.buttonSelector||'[role="tab"], .tab-button',a=t.panelSelector||r.dataset.panelSelector||'[role="tabpanel"], .tab-content',o=yt(t.panelRoot||r.dataset.panelRoot)||r,i=t.activeClass||r.dataset.activeClass||"active",s="function"==typeof t.onChange?t.onChange:null,c=Array.from(r.querySelectorAll(n)),l=Array.from(o.querySelectorAll(a));if(!c.length)throw new Error("UIComponents.initTabs: no tab buttons found");var d=Fe();if(d){var u=c.map(function(e){return e.getAttribute("aria-controls")||e.dataset.tab}).filter(Boolean);Qe.registerTabs(d,u)}var p=Ee(r);if(!p.valid){var m=p.errors.map(function(e,t){return"  Tab button ".concat(t+1,": ").concat(e.message,"\n    Expected: ").concat(e.context.expected,"\n    Fix: ").concat(e.context.fix)}).join("\n");throw new Error("UIComponents.initTabs: Some tab buttons are missing data-action attributes.\n".concat(m))}var g=[];if(c.forEach(function(e,t){var r=e.getAttribute("aria-controls")||e.dataset.tab;if(r){var n=CSS.escape?CSS.escape(r):r;o.querySelector("#".concat(n))||g.push("Panel not found for button ".concat(t+1," (target ID: #").concat(r,")."))}else g.push("Button ".concat(t+1," is missing data-tab or aria-controls attribute."))}),g.length>0)throw new Error("UIComponents.initTabs: Invalid structure in #".concat(r.id||"tabs",":\n").concat(g.join("\n")));function f(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e){var n=e.getAttribute("aria-controls")||e.dataset.tab||"",a=function(e){if(!e)return"";if("undefined"!=typeof CSS&&"function"==typeof CSS.escape)return CSS.escape(e);return e.replace(/[^a-zA-Z0-9_-]/g,"\\$&")}(n),d=n&&a?o.querySelector("#".concat(a)):null;c.forEach(function(t){t.classList.remove(i),t.setAttribute("aria-selected","false"),t.setAttribute("tabindex",t===e?"0":"-1")}),l.forEach(function(e){e.classList.remove(i),e.setAttribute("hidden","hidden")}),e.classList.add(i),e.setAttribute("aria-selected","true"),d&&(d.classList.add(i),d.removeAttribute("hidden"));var u=Fe();r&&u&&n&&Qe.trackTabView(u,n),t&&ht("Switched to ".concat(e.textContent.trim()," tab")),s&&s({tabId:n,button:e,panel:d})}}function v(e){var t=e.target.closest('[data-action="select-tab"]');t&&c.includes(t)&&(e.preventDefault(),f(t))}function h(e){var t=e.target.closest('[data-action="select-tab"]');if(t&&c.includes(t)){var r=c.indexOf(t);if(-1!==r){var n=null;if("ArrowRight"===e.key||"ArrowDown"===e.key?n=(r+1)%c.length:"ArrowLeft"===e.key||"ArrowUp"===e.key?n=(r-1+c.length)%c.length:"Home"===e.key?n=0:"End"===e.key&&(n=c.length-1),null!==n){e.preventDefault();var a=c[n];a.focus(),f(a)}}}}r.addEventListener("click",v),r.addEventListener("keydown",h);var b=c.find(function(e){return e.classList.contains(i)})||c[0];return c.forEach(function(e){return e.setAttribute("tabindex",e===b?"0":"-1")}),l.forEach(function(e){return e.setAttribute("hidden","hidden")}),f(b,!1,!1),{activate:function(e){f("string"==typeof e?c.find(function(t){return t.dataset.tab===e||t.getAttribute("aria-controls")===e}):e)},destroy:function(){r.removeEventListener("click",v),r.removeEventListener("keydown",h)}}}function yt(e){return e?e instanceof Element?e:"string"==typeof e?document.querySelector(e):null:null}var wt=new(function(){return g(function e(){p(this,e),this.flags={},this.isInitialized=!1,this.DOMAIN_KEY="flags",this.SOURCE="flag-manager"},[{key:"initialize",value:function(){if(this.isInitialized)throw new Error("FlagManager: Already initialized. Do not call initialize() more than once.");var e=Me.getDomainState(this.DOMAIN_KEY);e&&"object"===h(e)&&(this.flags=e),this.isInitialized=!0,console.log("FlagManager initialized.",this.flags)}},{key:"getAllFlags",value:function(){return f(this.flags)}},{key:"getFlag",value:function(e){return this.flags[e]}},{key:"setFlag",value:function(e,t){if("string"!=typeof e||""===e.trim())throw new Error("FlagManager: setFlag requires a non-empty string key.");this.flags[e]=t,Me.setDomainState(this.DOMAIN_KEY,this.flags,{source:this.SOURCE}),E.emit("flag:updated",{key:e,value:t})}},{key:"removeFlag",value:function(e){this.flags.hasOwnProperty(e)&&(delete this.flags[e],Me.setDomainState(this.DOMAIN_KEY,this.flags,{source:this.SOURCE}),E.emit("flag:removed",{key:e}))}}])}());function xt(e){if("string"!=typeof e)throw new Error("Condition must be a string");var t=a(e.split("."),2),r=t[0],n=t[1];switch(r){case"engagement":return{type:"engagement",requirement:n};case"flag":return{type:"flag",key:n};case"interaction":return{type:"interaction",id:n};default:throw new Error("Unknown condition type: ".concat(r))}}function kt(e,t){switch(e.type){case"engagement":var r=Qe.evaluateRequirements(t);return"complete"===e.requirement?r.complete:!r.unmetRequirements.find(function(t){return t.type===e.requirement});case"flag":var n=wt.getFlag(e.key);return void 0!==e.equals?n===e.equals:!!n;case"interaction":var a=Qe.getSlideState(t);if(!a)return!1;var o=a.tracked.interactionsCompleted[e.id];return e.requireCorrect?(null==o?void 0:o.completed)&&(null==o?void 0:o.correct):(null==o?void 0:o.completed)||!1;default:throw new Error("[ConditionalDisplay] Unknown condition type: ".concat(e.type,". Valid types: slideVisited, objectiveStatus, assessmentStatus, flagSet, interactionComplete."))}}function St(e,t,r){if("all"===t)return e.every(function(e){return kt(e,r)});if("any"===t)return e.some(function(e){return kt(e,r)});throw new Error("Invalid mode: ".concat(t,". Must be 'all' or 'any'."))}function Et(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.transition,a=void 0===n||n,o=r.display,i=void 0===o?"block":o,s=r.onShow,c=void 0===s?null:s,l=r.onHide,d=void 0===l?null:l;if(e._conditionalTransitionHandler&&(e.removeEventListener("transitionend",e._conditionalTransitionHandler),e._conditionalTransitionHandler=null),t)a?(e.style.display=i,e.classList.remove("conditional-hidden"),e.classList.add("conditional-visible")):e.style.display=i,c&&c();else{if(a){e.classList.remove("conditional-visible"),e.classList.add("conditional-hidden");var u=function(){e.style.display="none",e.removeEventListener("transitionend",u),e._conditionalTransitionHandler=null};e._conditionalTransitionHandler=u,e.addEventListener("transitionend",u)}else e.style.display="none";d&&d()}}var At=function(){return g(function e(){p(this,e),this.trackedElements=new Map},[{key:"showWhen",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.mode,o=void 0===a?"all":a,i=n.showWhen,s=void 0===i||i,c=n.initialCheck,l=void 0===c||c,d=n.transition,u=void 0===d||d,p=n.display,m=void 0===p?"block":p,g=n.onShow,f=void 0===g?null:g,v=n.onHide,b=void 0===v?null:v,y=[];if("string"==typeof t)y=[xt(t)];else if(Array.isArray(t))y=t.map(function(e){return"string"==typeof e?xt(e):e});else{if("object"!==h(t))throw new Error("Invalid conditions format");y=[t]}e.style.display="none",e.classList.add("conditional-hidden");var w=function(){var t=Fe();if(t){var r=St(y,o,t);Et(e,s?r:!r,{transition:u,display:m,onShow:f,onHide:b})}},x=new Set;y.forEach(function(e){switch(e.type){case"engagement":x.add("engagement:progress"),x.add("engagement:complete");break;case"flag":x.add("flag:updated"),x.add("flag:removed");break;case"interaction":x.add("interaction:answered"),x.add("interaction:completed")}});var k=[];x.forEach(function(e){var t=function(){return w()};E.on(e,t),k.push({eventName:e,handler:t})}),l&&w();var S="".concat(Date.now(),"-").concat(Math.random());return this.trackedElements.set(S,{element:e,eventHandlers:k,checkConditions:w}),function(){var e=r.trackedElements.get(S);e&&(e.eventHandlers.forEach(function(e){var t=e.eventName,r=e.handler;E.off(t,r)}),r.trackedElements.delete(S))}}},{key:"hideWhen",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.showWhen(e,t,i(i({},r),{},{showWhen:!1}))}},{key:"evaluate",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.mode,a=void 0===n?"all":n,o=r.showWhen,i=void 0===o||o,s=r.transition,c=void 0!==s&&s,l=r.display,d=void 0===l?"block":l,u=r.onShow,p=void 0===u?null:u,m=r.onHide,g=void 0===m?null:m,f=[];f="string"==typeof t?[xt(t)]:Array.isArray(t)?t.map(function(e){return"string"==typeof e?xt(e):e}):[t];var v=Fe();if(!v)return!1;var h=St(f,a,v);return Et(e,i?h:!h,{transition:c,display:d,onShow:p,onHide:g}),h}},{key:"cleanup",value:function(){this.trackedElements.forEach(function(e){e.eventHandlers.forEach(function(e){var t=e.eventName,r=e.handler;E.off(t,r)})}),this.trackedElements.clear()}}])}(),Ct=new At;var zt=null,It=0,Mt=!1;function qt(){if(!Mt){if(!(zt=document.getElementById("notification-container")))throw new Error('Notification container with ID "notification-container" not found in DOM.');zt.addEventListener("click",function(e){var t=e.target.closest('[data-action="dismiss-notification"]');if(t){var r=t.closest(".notification");r&&Tt(r.id)}}),Mt=!0}}function Lt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(Mt||qt(),!e||"string"!=typeof e)throw new Error("Notification message must be a non-empty string");var a="notification-".concat(++It),o=document.createElement("div");o.id=a,o.className="notification notification-".concat(t),o.setAttribute("role","error"===t?"alert":"status"),o.setAttribute("data-testid","notification-".concat(t));var i=!1!==n.dismissible?'\n        <button class="notification-close" data-action="dismiss-notification" aria-label="Close notification" data-testid="notification-close">×</button>\n    ':"";return o.innerHTML='\n        <span class="notification-message">'.concat(e,"</span>\n        ").concat(i,"\n    "),zt.appendChild(o),r>0&&setTimeout(function(){return Tt(a)},r),ht(e,"error"===t?"assertive":"polite"),a}function Tt(e){var t=document.getElementById(e);t&&(t.style.animation="notificationSlideOut 0.3s ease-out forwards",setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t)},300))}var Ot={tabs:bt,accordion:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error("UIComponents.initAccordion: container not found");var n=r.id,a=r.dataset.mode||"multi",o="function"==typeof t.onToggle?t.onToggle:null;if(!n)throw new Error("UIComponents.initAccordion: The accordion container element must have an ID.");if("single"!==a&&"multi"!==a)throw new Error('UIComponents.initAccordion: data-mode attribute must be "single" or "multi"');if(0===r.querySelectorAll(".accordion-item").length){var i=Array.from(r.children).filter(function(e){return e.hasAttribute("data-title")});i.length>0&&i.forEach(function(e,t){var a=e.getAttribute("data-title"),o=e.innerHTML,i="item-".concat(t+1),s=document.createElement("div");s.className="accordion-item",s.setAttribute("data-panel-id",i),s.innerHTML='\n                    <button class="accordion-button collapsed" data-panel="'.concat(i,'" data-action="toggle-accordion-panel">\n                        <span class="accordion-title">').concat(a,'</span>\n                        <span class="accordion-icon"></span>\n                    </button>\n                    <div id="').concat(n,"-panel-").concat(i,'" class="accordion-content" hidden>\n                        <div class="accordion-body">').concat(o,"</div>\n                    </div>\n                "),r.replaceChild(s,e)})}var s=Array.from(r.querySelectorAll(".accordion-button")),c=Array.from(r.querySelectorAll(".accordion-item")).map(function(e){var t,r=e.querySelector(".accordion-button");return{id:e.dataset.panelId||(null==r?void 0:r.dataset.panel),title:(null===(t=e.querySelector(".accordion-title"))||void 0===t?void 0:t.textContent)||""}});if(!s.length)return{destroy:function(){}};var l=[];if(s.forEach(function(e,t){var a=e.dataset.panel;a?r.querySelector("#".concat(n,"-panel-").concat(a))||l.push("Panel content not found for button ".concat(t+1,' (expected id="').concat(n,"-panel-").concat(a,'").')):l.push("Button ".concat(t+1," is missing data-panel attribute."))}),l.length>0)throw new Error("UIComponents.initAccordion: Invalid structure in #".concat(n,":\n").concat(l.join("\n")));var d=new Set(s.filter(function(e){return"true"===e.getAttribute("aria-expanded")}).map(function(e){return e.dataset.panel}));s.forEach(function(e){var t=e.dataset.panel,a=r.querySelector("#".concat(n,"-panel-").concat(t));e.hasAttribute("aria-expanded")||e.setAttribute("aria-expanded","false"),!e.hasAttribute("aria-controls")&&a&&e.setAttribute("aria-controls",a.id),a&&(a.hasAttribute("role")||a.setAttribute("role","region"),!a.hasAttribute("aria-labelledby")&&e.id&&a.setAttribute("aria-labelledby",e.id))});var u=Fe();if(u){var p=c.map(function(e){return e.id});Qe.registerAccordion(u,p)}function m(e){var t=r.querySelector('[data-panel="'.concat(e,'"]')),i=r.querySelector("#".concat(n,"-panel-").concat(e));if(t&&i){var s=d.has(e);"single"!==a||s||d.forEach(function(t){t!==e&&f(t,!1)}),s?f(e):g(e),u&&!s&&Qe.trackAccordionPanel(u,e),o&&o({panelId:e,isOpen:!s,mode:a})}}function g(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=r.querySelector('[data-panel="'.concat(e,'"]')),o=r.querySelector("#".concat(n,"-panel-").concat(e));if(a&&o&&(d.add(e),a.classList.remove("collapsed"),a.setAttribute("aria-expanded","true"),o.classList.add("show"),o.removeAttribute("hidden"),t)){var i,s=(null===(i=a.querySelector(".accordion-title"))||void 0===i?void 0:i.textContent)||"Panel";ht("".concat(s," expanded"))}}function f(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=r.querySelector('[data-panel="'.concat(e,'"]')),o=r.querySelector("#".concat(n,"-panel-").concat(e));if(a&&o&&(d.delete(e),a.classList.add("collapsed"),a.setAttribute("aria-expanded","false"),o.classList.remove("show"),o.setAttribute("hidden","hidden"),t)){var i,s=(null===(i=a.querySelector(".accordion-title"))||void 0===i?void 0:i.textContent)||"Panel";ht("".concat(s," collapsed"))}}var v=function(e){var t=e.target.closest('[data-action="toggle-accordion-panel"]');if(t){e.preventDefault();var r=t.dataset.panel;r&&m(r)}},h=function(e){var t=e.target.closest(".accordion-button");if(t){var r=s.indexOf(t);switch(e.key){case"ArrowDown":case"ArrowRight":e.preventDefault();var n=(r+1)%s.length;s[n].focus();break;case"ArrowUp":case"ArrowLeft":e.preventDefault();var a=(r-1+s.length)%s.length;s[a].focus();break;case"Home":e.preventDefault(),s[0].focus();break;case"End":e.preventDefault(),s[s.length-1].focus()}}};return r.addEventListener("click",v),r.addEventListener("keydown",h),{togglePanel:m,openPanel:g,closePanel:f,openAll:function(){if("single"===a)throw new Error('UIComponents.initAccordion: openAll() is not available in single mode. Use mode="multi" or call togglePanel() individually.');c.forEach(function(e){return g(e.id,!1)}),ht("All panels expanded")},closeAll:function(){c.forEach(function(e){return f(e.id,!1)}),ht("All panels collapsed")},getOpenPanels:function(){return Array.from(d)},destroy:function(){r.removeEventListener("click",v),r.removeEventListener("keydown",h)}}},dropdown:Ke,alert:function(e){if(!e)throw new Error("initAlert: alertElement not found.");var t=e.querySelector('[data-action="dismiss-alert"]');if(!t)return{destroy:function(){}};var r=function(){e.style.opacity="0",e.style.transition="opacity 0.3s ease-out, transform 0.3s ease-out, max-height 0.3s 0.1s, padding 0.3s 0.1s, margin 0.3s 0.1s",e.style.transform="scaleY(0.8)",e.style.maxHeight="0",e.style.paddingTop="0",e.style.paddingBottom="0",e.style.marginTop="0",e.style.marginBottom="0",e.style.borderWidth="0",setTimeout(function(){e.remove()},400)};return t.addEventListener("click",r),{destroy:function(){t.removeEventListener("click",r)}}},collapse:function(e){if(!e)throw new Error("initCollapse: container not found.");var t=e.querySelector('[data-action="toggle-collapse"]');if(!t)throw new Error('initCollapse: No trigger found with data-action="toggle-collapse". Ensure collapse trigger button exists.');var r=t.getAttribute("aria-controls"),n=r?e.querySelector("#".concat(r)):null;if(!n)throw new Error('initCollapse: No panel found with ID "'.concat(r,"\". Ensure trigger's aria-controls matches panel ID."));var a="true"===t.getAttribute("aria-expanded");n.style.maxHeight=a?"".concat(n.scrollHeight,"px"):"0",e.classList.toggle("expanded",a);var o=function(){var r="true"===t.getAttribute("aria-expanded");t.setAttribute("aria-expanded",!r),e.classList.toggle("expanded",!r),r?n.style.maxHeight="0":(n.style.display="block",n.style.maxHeight="".concat(n.scrollHeight,"px"))};return n.addEventListener("transitionend",function(){"false"===t.getAttribute("aria-expanded")&&(n.style.display="none")}),"false"===t.getAttribute("aria-expanded")?n.style.display="none":n.style.display="block",t.addEventListener("click",o),{destroy:function(){t.removeEventListener("click",o)}}},progress:function(e){if(!e)throw new Error("initProgress: element not found.");var t=parseFloat(e.dataset.initialValue)||0;return pt(e,t),{update:function(t){return pt(e,t)},destroy:function(){}}},carousel:function(e){if(!e)throw new Error("initCarousel: container not found.");var t=e.querySelector(".carousel-track"),r=Array.from(e.querySelectorAll(".carousel-slide")),n=e.querySelector('[data-action="prev-slide"]'),a=e.querySelector('[data-action="next-slide"]'),o=e.querySelector(".carousel-dots");if(!t||!r.length)throw new Error("initCarousel: A track and slides are required. Ensure carousel HTML structure is correct with .carousel-track and .carousel-slide elements.");var i=0,s=function(){(t.style.transform="translateX(-".concat(100*i,"%)"),n&&(n.disabled=0===i),a&&(a.disabled=i===r.length-1),o)&&Array.from(o.children).forEach(function(e,t){e.classList.toggle("active",t===i)});r.forEach(function(e,t){e.setAttribute("aria-hidden",t!==i)})},c=function(e){e<0||e>=r.length||(i=e,s())};o&&(o.innerHTML="",r.forEach(function(e,t){var r=document.createElement("button");r.className="carousel-dot",r.setAttribute("aria-label","Go to slide ".concat(t+1)),r.addEventListener("click",function(){return c(t)}),o.appendChild(r)}));var l=function(e){var t=e.target.closest("[data-action]");if(t){var r=t.dataset.action;"next-slide"===r?c(i+1):"prev-slide"===r&&c(i-1)}};return e.addEventListener("click",l),s(),{destroy:function(){e.removeEventListener("click",l)}}},conditional:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t=e)?t instanceof Element?t:"string"==typeof t?document.querySelector(t):null:null;if(!n)throw new Error("ConditionalDisplay: element not found");if("true"===n.dataset.conditionalInitialized)throw new Error("[ConditionalDisplay] Element already initialized. Each element should only be initialized once.");n.dataset.conditionalInitialized="true";var a,o=r.condition||n.dataset.condition,i=r.conditions||n.dataset.conditions,s=r.mode||n.dataset.mode||"all",c=void 0!==r.showWhen?r.showWhen:"false"!==n.dataset.showWhen,l=void 0!==r.transition?r.transition:"false"!==n.dataset.transition,d=r.display||n.dataset.display||"block";if(i)a=i.split(",").map(function(e){return e.trim()});else{if(!o)throw new Error("ConditionalDisplay: No condition specified. Use data-condition or data-conditions attribute.");a=o}var u=Ct.showWhen(n,a,{mode:s,showWhen:c,transition:l,display:d,initialCheck:!0});return{destroy:function(){u(),delete n.dataset.conditionalInitialized},element:n}},"value-display":function(e){var t=e.dataset.source;if(t){var r=null;if(!(r=t.startsWith("#")?document.getElementById(t.substring(1)):document.querySelector(t)))throw new Error("[ValueDisplay] Source element not found: ".concat(t));var n=e.dataset.event||"change",a=e.dataset.key||"value",o=e.dataset.format||"{value}",i="true"===e.dataset.hideEmpty,s=function(t){var n;t.detail?n="value"!==a&&void 0!==t.detail[a]?t.detail[a]:t.detail:t.target&&void 0!==t.target[a]?n=t.target[a]:void 0!==r[a]&&(n=r[a]),function(t){if(""!==t&&null!=t||!i){var r=o;"object"===h(t)&&null!==t?Object.keys(t).forEach(function(e){var n=t[e],a=Array.isArray(n)?n.join(", "):n;r=r.replace(new RegExp("{".concat(e,"}"),"g"),a)}):r=r.replace("{value}",t),e.textContent=r}else e.textContent=""}(n)};return r.addEventListener(n,s),{destroy:function(){r.removeEventListener(n,s)}}}console.warn("[ValueDisplay] No data-source provided",e)},"checkbox-group":function(e){if(!e)throw new Error("CheckboxGroup: Container element is required");var t=e.querySelectorAll('input[type="checkbox"]');if(0===t.length)throw new Error("CheckboxGroup: No checkbox inputs found in container");var r=function(){var r=Array.from(t).filter(function(e){return e.checked}),n=r.map(function(e){return e.value}),a=r.map(function(e){var t=e.closest(".checkbox-option");if(t){var r=t.querySelector(".checkbox-label");if(r)return r.textContent}return e.labels&&e.labels.length>0?e.labels[0].textContent:e.value}),o=new CustomEvent("checkbox-group:change",{bubbles:!0,detail:{values:n,labels:a,count:r.length,value:a.join(", ")}});e.dispatchEvent(o)};return t.forEach(function(e){e.addEventListener("change",r)}),{destroy:function(){t.forEach(function(e){e.removeEventListener("change",r)})}}},"toggle-group":function(e){if(!e)throw new Error("ToggleGroup: Container element is required");var t=e.querySelectorAll('input[type="checkbox"]');if(0===t.length)throw new Error("ToggleGroup: No checkbox inputs found in container");var r=function(t){var r,n=t.target,a=n.dataset.label||(null===(r=n.nextElementSibling)||void 0===r||null===(r=r.nextElementSibling)||void 0===r?void 0:r.textContent)||"Toggle",o=n.checked?"enabled":"disabled",i=new CustomEvent("toggle:change",{bubbles:!0,detail:{label:a,checked:n.checked,status:o,value:"".concat(a," is now ").concat(o)}});e.dispatchEvent(i)};return t.forEach(function(e){e.addEventListener("change",r)}),{destroy:function(){t.forEach(function(e){e.removeEventListener("change",r)})}}},"form-validator":function(e){if(!e||"FORM"!==e.tagName)throw new Error("FormValidator: Element must be a <form> tag.");var t=e.dataset.successMessage||"Form submitted successfully!",r=e.dataset.errorMessage||"Please fill in all required fields.",n=function(n){if(n.preventDefault(),e.checkValidity()){if(Lt(t,"success"),e.reset(),e.dispatchEvent(new CustomEvent("form:success",{bubbles:!0})),"true"===e.dataset.closeModalOnSuccess){var a,o=null===(a=e.closest(".modal"))||void 0===a?void 0:a.querySelector('[data-action="close-modal"]');o&&o.click()}}else Lt(r,"error"),e.dispatchEvent(new CustomEvent("form:error",{bubbles:!0}))};return e.addEventListener("submit",n),{destroy:function(){e.removeEventListener("submit",n)}}},"modal-trigger":ct,"flip-card":function(e){if(e){e.hasAttribute("tabindex")||e.setAttribute("tabindex","0");var t=function(t){"keydown"===t.type&&t.preventDefault(),e.classList.toggle("is-flipped");var r=e.classList.contains("is-flipped");e.setAttribute("aria-expanded",r)};e.addEventListener("click",t),e.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||t(e)})}}};function jt(e){e&&"function"==typeof e.querySelectorAll&&(e.querySelectorAll("[data-component]").forEach(function(e){var t=e.dataset.component,r=Ot[t];if(r)try{r(e)}catch(n){console.error("[UI-Initializer] Failed to initialize '".concat(t,"' component:"),n,e),E.emit("initialization:error",{domain:"ui",operation:"initializeComponent",message:"Failed to initialize '".concat(t,"' component: ").concat(n.message),stack:n.stack,context:{component:t,element:e.outerHTML}})}else console.warn("[UI-Initializer] No initializer found for component: '".concat(t,"'. Available initializers: ").concat(Object.keys(Ot).join(", ")))}),vt(e),function(e){e.addEventListener("click",function(e){var t=e.target.closest('[data-action="show-notification"]');if(t){var r=t.dataset.type||"info";Lt(t.dataset.message||"Notification",r)}})}(e))}var _t={metadata:{title:"SCORM Template",description:"Advanced SCORM template for course development",version:"2.0.0",author:"Seth Vincent",language:"en"},branding:{logo:"./course/assets/logo.png",logoAlt:"Logo",companyName:"SV",courseTitle:"SCORM Template"},scoring:null,objectives:[{id:"visited-intro",description:"Visit the introduction slide",initialCompletion:"incomplete",initialSuccess:"unknown",criteria:{type:"slideVisited",slideId:"intro"}},{id:"core-content",description:"Visit all core content slides",initialCompletion:"incomplete",initialSuccess:"unknown",criteria:{type:"allSlidesVisited",slideIds:["content","ui-demo"]}},{id:"thorough-review",description:"Spend at least 2 minutes reviewing content",initialCompletion:"incomplete",initialSuccess:"unknown",criteria:{type:"timeOnSlide",slideId:"content",minSeconds:120}},{id:"custom-mastery",description:"Demonstrate mastery (custom logic)",initialCompletion:"incomplete",initialSuccess:"unknown"},{id:"intro-completed-flag",description:"Complete introduction (flag-based)",initialCompletion:"incomplete",initialSuccess:"unknown",criteria:{type:"flag",key:"intro-complete",equals:!0}},{id:"all-sections-unlocked",description:"Unlock all course sections",initialCompletion:"incomplete",initialSuccess:"unknown",criteria:{type:"allFlags",flags:["section-1-unlocked","section-2-unlocked",{key:"section-3-unlocked",equals:!0}]}}],structure:[{type:"slide",id:"intro",component:"@slides/intro.js",title:"Introduction",menu:{label:"Introduction",icon:"📚"},engagement:{required:!1},navigation:{sequential:!0,controls:{showPrevious:!1,showNext:!0,exitTarget:null}}},{type:"section",id:"course-content",menu:{label:"Course Content",icon:"📂",defaultExpanded:!0},children:[{type:"slide",id:"ui-demo",component:"@slides/ui-demo.js",title:"UI Components Demo",menu:{label:"UI Components Demo",icon:"🎨"},engagement:{required:!1},navigation:{sequential:!0,controls:{showPrevious:!0,showNext:!0}}},{type:"slide",id:"content",component:"@slides/content.js",title:"Learning Content",menu:{label:"Main Content",icon:"🔧"},engagement:{required:!0,mode:"all",requirements:[{type:"viewAllTabs"},{type:"interactionComplete",interactionId:"system-architecture-dd"},{type:"interactionComplete",interactionId:"requirements-spec-fillin"},{type:"interactionComplete",interactionId:"efficiency-calculation"}],showIndicator:!0},navigation:{sequential:!0,controls:{showPrevious:!0,showNext:!0}}}]},{type:"assessment",id:"assessment",component:"@slides/assessment.js",title:"Final Assessment",menu:{label:"Final Exam",icon:"📝"},engagement:{required:!1},navigation:{sequential:!0,controls:{showPrevious:!0,showNext:!0},gating:{mode:"all",message:"Complete the required content before starting the exam.",conditions:[{type:"objectiveStatus",objectiveId:"core-content",completion_status:"completed"}]}}},{type:"slide",id:"remedial",component:"@slides/remedial.js",title:"Remedial Content",menu:{hidden:!0},engagement:{required:!1},navigation:{sequential:!0,controls:{showPrevious:!0,showNext:!0,exitTarget:"assessment"},gating:{mode:"any",message:"Remedial content becomes available after an unsuccessful assessment attempt.",conditions:[{type:"assessmentStatus",assessmentId:"final-exam",requires:"failed"}]},sequence:{includeByDefault:!1,includeWhen:{type:"assessmentStatus",assessmentId:"final-exam",requires:"failed"},insert:{position:"after",slideId:"assessment"}}}},{type:"slide",id:"summary",component:"@slides/summary.js",title:"Course Summary",menu:{label:"Summary",icon:"🏆"},engagement:{required:!1},navigation:{sequential:!0,controls:{showPrevious:!0,showNext:!1},gating:{mode:"all",message:"Summary is locked until you pass the assessment.",conditions:[{type:"assessmentStatus",assessmentId:"final-exam",requires:"passed"}]}}}],navigation:{sidebar:{enabled:!0,position:"left",width:"280px",collapsible:!0,defaultCollapsed:!0,showProgress:!0}},features:{accessibility:{darkMode:!0,fontSize:!0,highContrast:!0,reducedMotion:!0,keyboardShortcuts:!0},security:!1,offline:!1,analytics:!0,feedback:!0},completion:{promptForComments:!0,promptForRating:!0},slideDefaults:{contentWidth:"full"},environment:{window:{width:1024,height:768},disableBeforeUnloadGuard:!0,development:{disableGating:!0},automation:{enabled:!0,disableBeforeUnloadGuard:!0,exposeCorrectAnswers:!0}}};function Rt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"local";if(!(e&&e instanceof HTMLElement))throw new Error("ViewManager: A valid container element is required.");var r={},n=null;function a(){return a=u(c().m(function a(i){var l,d,u,p,m,g=arguments;return c().w(function(a){for(;;)switch(a.n){case 0:if(l=g.length>1&&void 0!==g[1]?g[1]:{},r[i]){a.n=1;break}throw new Error("ViewManager: View '".concat(i,"' not found."));case 1:return d=null,n&&r[n]&&(u=r[n],(d=e.firstElementChild)&&"function"==typeof u.onHide&&u.onHide(d)),p=r[i],E.emit("view:before-change",{oldView:n,newView:i,scope:t,context:l}),a.n=2,p.render(l);case 2:if((m=a.v)instanceof HTMLElement){a.n=3;break}throw new Error("ViewManager: View '".concat(i,"' render function must return an HTMLElement."));case 3:s(m=o(m),i),e.innerHTML="",e.appendChild(m),jt(m),"function"==typeof p.onShow&&p.onShow(m,l),n=i,E.emit("view:change",{view:i,context:l});case 4:return a.a(2)}},a)})),a.apply(this,arguments)}function o(e,t){var r,n=e.getAttribute("data-content-width")||(null==_t||null===(r=_t.slideDefaults)||void 0===r?void 0:r.contentWidth);if(!n)return e;if(function(e){var t=["content-narrow","content-medium","content-wide","content-full"];if(e.classList&&t.some(function(t){return e.classList.contains(t)}))return!0;if(e.children&&e.children.length>0){var r,n=b(e.children);try{var a,o=function(){var e=r.value;if(e.classList&&t.some(function(t){return e.classList.contains(t)}))return{v:!0}};for(n.s();!(r=n.n()).done;)if(a=o())return a.v}catch(i){n.e(i)}finally{n.f()}}return!1}(e))return e;var a=document.createElement("div");return a.className="content-".concat(n),a.appendChild(e),a}function s(e,t){var r=Ce(e,t);if(!r.valid){r.errors.forEach(function(e){var r='View "'.concat(t,'" [').concat(e.type,"]: ").concat(e.message);E.emit("view:error",{domain:"view",operation:"validateRenderedContent",message:r,context:e.context,stack:new Error(r).stack}),console.error("[ViewManager Validation Error] ".concat(r),e.context)});var n=r.errors.map(function(e){return"[".concat(e.type,"] ").concat(e.message)}).join("; ");throw new Error('[ViewManager] View "'.concat(t,'" has ').concat(r.errors.length," validation error(s): ").concat(n))}}return{registerView:function(e,t){if(!e)throw new Error("ViewManager: View name is required.");if(!t||"function"!=typeof t.render)throw new Error("ViewManager: View '".concat(e,"' must be an object with a render function."));r[e]=i({},t)},showView:function(e){return a.apply(this,arguments)},getCurrentView:function(){return n},getContainer:function(){return e},destroy:function(){if(n&&r[n]){var t=e.firstElementChild,a=r[n];t&&"function"==typeof a.onHide&&a.onHide(t)}e.innerHTML="",n=null}}}var Dt=function(){return g(function e(){p(this,e),this.objectives={},this.isInitialized=!1,this.earlyQueue=[],this.DOMAIN_KEY="objectives",this.SOURCE="objective-manager",this.criteriaConfig=[]},[{key:"initialize",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this.isInitialized)throw new Error("ObjectiveManager: Already initialized. Do not call initialize() more than once.");var r=Me.getDomainState(this.DOMAIN_KEY);r&&"object"===h(r)&&(this.objectives=this._mergeWithDefaults(r)),this.isInitialized=!0,t.length>0&&(t.forEach(function(t){e.objectives[t.id]||e.setObjective({id:t.id,completion_status:t.initialCompletion||"incomplete",success_status:t.initialSuccess||"unknown",score:t.initialScore||null})}),console.log("[ObjectiveManager] Initialized ".concat(t.length," objective(s) from configuration.")),this.enableCriteriaTracking(t)),console.log("[ObjectiveManager] Initialized with objectives:",this.objectives),this._processEarlyQueue()}},{key:"_processEarlyQueue",value:function(){var e=this;this.earlyQueue.length>0&&(console.log("[ObjectiveManager] Processing ".concat(this.earlyQueue.length," early-queued call(s).")),this.earlyQueue.forEach(function(t){var r=t.method,n=t.args;"function"==typeof e[r]&&e[r].apply(e,v(n))}),this.earlyQueue=[])}},{key:"getObjectives",value:function(){return f(Object.values(this.objectives))}},{key:"getObjective",value:function(e){return e&&this.objectives[e]?f(this.objectives[e]):null}},{key:"setObjective",value:function(e){if(this.isInitialized){var t=e.id;if(!t)throw new Error("ObjectiveManager: setObjective requires an id.");var r=i(i({},this.objectives[t]||{id:t}),e);this.objectives[t]=r;var n=this._stripDefaultValues(this.objectives);return Me.setDomainState(this.DOMAIN_KEY,n,{source:this.SOURCE}),this._syncObjectiveToSCORM(r),E.emit("objective:updated",r),"number"==typeof r.score&&E.emit("objective:score:updated",{objectiveId:t,score:r.score}),f(r)}this.earlyQueue.push({method:"setObjective",args:[e]})}},{key:"setSuccessStatus",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.isInitialized){var n=this.getObjective(e);if(!n)throw new Error('ObjectiveManager: Objective with id "'.concat(e,'" not found.'));n.success_status=t,null!==r&&(n.score=r),this.setObjective(n)}else this.earlyQueue.push({method:"setSuccessStatus",args:[e,t,r]})}},{key:"setCompletionStatus",value:function(e,t){if(this.isInitialized){var r=this.getObjective(e);if(!r)throw new Error('ObjectiveManager: Objective with id "'.concat(e,'" not found.'));r.completion_status=t,this.setObjective(r)}else this.earlyQueue.push({method:"setCompletionStatus",args:[e,t]})}},{key:"setScore",value:function(e,t){if(this.isInitialized){var r=this.getObjective(e);if(!r)throw new Error('ObjectiveManager: Objective with id "'.concat(e,'" not found.'));if("number"!=typeof t||t<0||t>100)throw new Error("ObjectiveManager: Score must be a number between 0 and 100, got ".concat(t));r.score=t,this.setObjective(r)}else this.earlyQueue.push({method:"setScore",args:[e,t]})}},{key:"enableCriteriaTracking",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.criteriaConfig=t.filter(function(e){return e.criteria}),0!==this.criteriaConfig.length?(E.on("view:change",function(t){var r=t.view;e._handleSlideVisit(r),e._checkTimeBasedObjectives(r)}),E.on("flag:updated",function(t){var r=t.key,n=t.value;e._checkFlagBasedObjectives(r,n)}),console.log("[ObjectiveManager] Criteria tracking enabled for ".concat(this.criteriaConfig.length," objective(s)."))):console.log("[ObjectiveManager] No objectives with built-in criteria found.")}},{key:"_handleSlideVisit",value:function(e){var t=this,r=Me.getDomainState("navigation"),n=(null==r?void 0:r.visitedSlides)||[],a=new Set([].concat(v(n),[e]));this.criteriaConfig.forEach(function(r){var n=t.objectives[r.id];if(!n||"completed"!==n.completion_status){var o=r.criteria;switch(o.type){case"slideVisited":o.slideId===e&&(t.setCompletionStatus(r.id,"completed"),console.log('[ObjectiveManager] Objective "'.concat(r.id,'" completed: slideVisited')));break;case"allSlidesVisited":(o.slideIds||[]).every(function(e){return a.has(e)})&&(t.setCompletionStatus(r.id,"completed"),console.log('[ObjectiveManager] Objective "'.concat(r.id,'" completed: allSlidesVisited')))}}})}},{key:"_checkTimeBasedObjectives",value:function(e){var t=this,r=Me.getDomainState("sessionData"),n=(null==r?void 0:r.slideDurations)||{};this.criteriaConfig.forEach(function(r){var a=t.objectives[r.id];if(!a||"completed"!==a.completion_status){var o=r.criteria;if("timeOnSlide"===o.type&&o.slideId===e){var i=(n[e]||0)/1e3;i>=(o.minSeconds||0)&&(t.setCompletionStatus(r.id,"completed"),console.log('[ObjectiveManager] Objective "'.concat(r.id,'" completed: timeOnSlide (').concat(i.toFixed(1),"s)")))}}})}},{key:"_checkFlagBasedObjectives",value:function(e,t){var r=this,n=Me.getDomainState("flags")||{};this.criteriaConfig.forEach(function(a){var o=r.objectives[a.id];if(!o||"completed"!==o.completion_status){var i=a.criteria;if("flag"===i.type){if(i.key===e){(void 0!==i.equals?t===i.equals:!!t)&&(r.setCompletionStatus(a.id,"completed"),console.log('[ObjectiveManager] Objective "'.concat(a.id,'" completed: flag "').concat(e,'" = ').concat(t)))}}else if("allFlags"===i.type){(i.flags||[]).every(function(e){var t="string"==typeof e?e:e.key,r=n[t];return"object"===h(e)&&void 0!==e.equals?r===e.equals:!!r})&&(r.setCompletionStatus(a.id,"completed"),console.log('[ObjectiveManager] Objective "'.concat(a.id,'" completed: allFlags')))}}})}},{key:"_getObjectiveIndex",value:function(e){if(!e)throw new Error("[ObjectiveManager] Invalid objective ID: ".concat(e));if("function"!=typeof window.findObjective)throw new Error("[ObjectiveManager] SCORM wrapper findObjective() not available");return window.findObjective(e)}},{key:"_syncObjectiveToSCORM",value:function(e){if(!this.isInitialized)throw new Error("[ObjectiveManager] Cannot sync to SCORM: manager not initialized.");var t=this._getObjectiveIndex(e.id);if(e.success_status&&Me.setValue("cmi.objectives.".concat(t,".success_status"),e.success_status),e.completion_status&&Me.setValue("cmi.objectives.".concat(t,".completion_status"),e.completion_status),null!==e.score&&void 0!==e.score){var r=e.score,n=r/100;Me.setValue("cmi.objectives.".concat(t,".score.raw"),String(r)),Me.setValue("cmi.objectives.".concat(t,".score.scaled"),String(n)),Me.setValue("cmi.objectives.".concat(t,".score.min"),"0"),Me.setValue("cmi.objectives.".concat(t,".score.max"),"100")}var a=e.description||this._getDescriptionFromConfig(e.id);a&&Me.setValue("cmi.objectives.".concat(t,".description"),a),console.log('[ObjectiveManager] Synced objective "'.concat(e.id,'" to cmi.objectives.').concat(t))}},{key:"_getDescriptionFromConfig",value:function(e){var t=this.criteriaConfig.find(function(t){return t.id===e});return(null==t?void 0:t.description)||""}},{key:"syncAllObjectivesToSCORM",value:function(){var e=this;if(!this.isInitialized)throw new Error("[ObjectiveManager] Cannot sync all objectives: manager not initialized.");var t=Object.keys(this.objectives).sort();console.log("[ObjectiveManager] Syncing ".concat(t.length," objective(s) to SCORM CMI...")),t.forEach(function(t){e._syncObjectiveToSCORM(e.objectives[t])}),console.log("[ObjectiveManager] All objectives synced to SCORM CMI.")}},{key:"_stripDefaultValues",value:function(e){for(var t={},r=0,n=Object.entries(e);r<n.length;r++){var o=a(n[r],2),i=o[0],s=o[1],c={id:i};s.completion_status&&"incomplete"!==s.completion_status&&(c.completion_status=s.completion_status),s.success_status&&"unknown"!==s.success_status&&(c.success_status=s.success_status),null!==s.score&&void 0!==s.score&&(c.score=s.score),t[i]=c}return t}},{key:"_mergeWithDefaults",value:function(e){for(var t={},r=0,n=Object.entries(e);r<n.length;r++){var o,i=a(n[r],2),s=i[0],c=i[1];t[s]={id:s,completion_status:c.completion_status||"incomplete",success_status:c.success_status||"unknown",score:null!==(o=c.score)&&void 0!==o?o:null}}return t}}])}(),Nt=n("i",new Dt),Pt=function(){return g(function e(){p(this,e),this.interactions=[],this.isInitialized=!1,this.DOMAIN_KEY="interactions",this.SOURCE="interaction-manager"},[{key:"initialize",value:function(){if(this.isInitialized)throw new Error("InteractionManager: Already initialized. Do not call initialize() more than once.");var e=Me.getDomainState(this.DOMAIN_KEY);Array.isArray(e)&&(this.interactions=e),this.isInitialized=!0,console.log("InteractionManager initialized.",this.interactions)}},{key:"getAllInteractions",value:function(){return f(this.interactions)}},{key:"getInteraction",value:function(e){var t=this.interactions.find(function(t){return t.id===e});return t?f(t):null}},{key:"_validateInteractionData",value:function(e){if(!e||"object"!==h(e))throw new Error("[InteractionManager] Interaction data must be a non-null object");var t,r=[],n=function(e,t){var r,n=[],a=b(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;void 0!==e[o]&&null!==e[o]&&""!==e[o]||n.push('Missing required field "'.concat(o,'"'))}}catch(i){a.e(i)}finally{a.f()}return{valid:0===n.length,errors:n}}(e,["type"]);if(n.valid){var a=xe(e.type,ye,"type");a.valid||r.push(a.error)}else r.push.apply(r,v(n.errors));if(e.result){var o=xe(e.result,we,"result");o.valid||r.push(o.error)}if(e.timestamp&&!function(e){if("string"!=typeof e)return!1;try{var t=new Date(e);return t.toISOString()===e||!isNaN(t.getTime())}catch(r){return!1}}(e.timestamp)&&r.push('Invalid timestamp "'.concat(e.timestamp,'". Must be ISO 8601 format')),void 0!==e.weighting&&null!==e.weighting){var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r=Number(e);return isNaN(r)?{valid:!1,error:"Invalid ".concat(t,' "').concat(e,'". Must be a number')}:{valid:!0,error:null}}(e.weighting,"weighting");i.valid||r.push(i.error)}if(e.latency&&("string"!=typeof(t=e.latency)||!/^P(?:\d+Y)?(?:\d+M)?(?:\d+D)?(?:T(?:\d+H)?(?:\d+M)?(?:\d+(?:\.\d+)?S)?)?$/.test(t)||"P"===t||"PT"===t)&&r.push('Invalid latency "'.concat(e.latency,'". Must be ISO 8601 duration format (e.g., "PT1H30M")')),void 0===e.correct_responses||Array.isArray(e.correct_responses)||r.push('Field "correct_responses" must be an array'),void 0!==e.objectives){var s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";return Array.isArray(e)?e.some(function(e){return"string"!=typeof e})?{valid:!1,error:'Field "'.concat(t,'" must contain only string values')}:{valid:!0,error:null}:{valid:!1,error:'Field "'.concat(t,'" must be an array')}}(e.objectives,"objectives");s.valid||r.push(s.error)}if(r.length>0){var c="[InteractionManager] "+function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Validation failed",n=t?" for ".concat(t):"";return"".concat(r).concat(n,":\n  - ").concat(e.join("\n  - "))}(r,e.id?'interaction "'.concat(e.id,'"'):"interaction");throw new Error(c)}}},{key:"record",value:function(e){this._validateInteractionData(e);var t={id:e.id||y("interaction"),type:e.type,learner_response:e.learner_response||"",result:e.result||"neutral",description:e.description||"",timestamp:e.timestamp||(new Date).toISOString(),weighting:e.weighting,latency:e.latency,correct_responses:e.correct_responses,objectives:e.objectives};this.interactions.push(t);var r=this.interactions.length-1;try{Me.setDomainState(this.DOMAIN_KEY,this.interactions,{source:this.SOURCE})}catch(o){this.interactions.pop();var n=new Error('[InteractionManager] Failed to persist interaction "'.concat(t.id,'" to domain state: ').concat(o.message));throw this._emitError("record",n,{interactionId:t.id,phase:"domain-persistence"}),n}try{this._syncInteractionFieldsToSCORM(t,r)}catch(o){var a=new Error('[InteractionManager] Failed to sync interaction "'.concat(t.id,'" to SCORM CMI: ').concat(o.message));throw this._emitError("record",a,{interactionId:t.id,phase:"cmi-sync"}),a}return E.emit("interaction:recorded",t),f(t)}},{key:"_syncInteractionFieldsToSCORM",value:function(e,t){if(!this.isInitialized){var r=new Error("[InteractionManager] Cannot sync to SCORM: manager not initialized");throw this._emitError("_syncInteractionFieldsToSCORM",r,{interactionId:e.id,index:t}),r}if(t<0){var n=new Error("[InteractionManager] Invalid interaction index: ".concat(t));throw this._emitError("_syncInteractionFieldsToSCORM",n,{interactionId:e.id,index:t}),n}for(var a=0,o=[{key:"id",path:"cmi.interactions.".concat(t,".id"),required:!0},{key:"type",path:"cmi.interactions.".concat(t,".type"),required:!0},{key:"learner_response",path:"cmi.interactions.".concat(t,".learner_response")},{key:"result",path:"cmi.interactions.".concat(t,".result")},{key:"timestamp",path:"cmi.interactions.".concat(t,".timestamp")},{key:"description",path:"cmi.interactions.".concat(t,".description")},{key:"weighting",path:"cmi.interactions.".concat(t,".weighting"),transform:function(e){return String(e)}},{key:"latency",path:"cmi.interactions.".concat(t,".latency")}];a<o.length;a++){var i=o[a],s=e[i.key];if(i.required&&null==s){var c=new Error('[InteractionManager] Required field "'.concat(i.key,'" missing for interaction "').concat(e.id,'"'));throw this._emitError("_syncInteractionFieldsToSCORM",c,{interactionId:e.id,index:t,field:i.key}),c}if(null!=s){var l=i.transform?i.transform(s):s;Me.setValue(i.path,l)}}e.correct_responses&&Array.isArray(e.correct_responses)&&e.correct_responses.forEach(function(e,r){var n="cmi.interactions.".concat(t,".correct_responses.").concat(r,".pattern");Me.setValue(n,e)}),e.objectives&&Array.isArray(e.objectives)&&e.objectives.forEach(function(e,r){var n="cmi.interactions.".concat(t,".objectives.").concat(r,".id");Me.setValue(n,e)}),console.log('[InteractionManager] Synced interaction "'.concat(e.id,'" to cmi.interactions.').concat(t))}},{key:"addLikertInteraction",value:function(e){var t=e.id,r=e.response,n=e.description;if(!this.isInitialized){var a=new Error("[InteractionManager] Not initialized. Call initialize() first.");throw this._emitError("addLikertInteraction",a,{interactionId:t}),a}if(!t||"string"!=typeof t){var o=new Error("[InteractionManager] likert interaction id is required and must be a string");throw this._emitError("addLikertInteraction",o,{interactionId:t}),o}if(!r){var i=new Error("[InteractionManager] likert interaction response is required");throw this._emitError("addLikertInteraction",i,{interactionId:t}),i}return this.record({id:t,type:"likert",learner_response:String(r),description:n||"",result:"neutral"})}},{key:"syncAllInteractionsToSCORM",value:function(){var e=this;if(!this.isInitialized)throw new Error("[InteractionManager] Cannot sync all interactions: manager not initialized");console.log("[InteractionManager] Syncing ".concat(this.interactions.length," interaction(s) to SCORM CMI..."));var t=[],r=0;if(this.interactions.forEach(function(n,a){try{e._syncInteractionFieldsToSCORM(n,a),r++}catch(o){var i={interactionId:n.id||"unknown",index:a,message:o.message};t.push(i),console.error('[InteractionManager] Failed to sync interaction "'.concat(i.interactionId,'" at index ').concat(a,": ").concat(o.message))}}),console.log("[InteractionManager] Sync complete: ".concat(r,"/").concat(this.interactions.length," interactions synced successfully")),t.length>0){var n=t.map(function(e){return"  - [".concat(e.index,"] ").concat(e.interactionId,": ").concat(e.message)}).join("\n"),a="[InteractionManager] Failed to sync ".concat(t.length,"/").concat(this.interactions.length," interaction(s):\n").concat(n),o=new Error(a);throw E.emit("interaction:sync:error",{domain:"interaction",operation:"syncAllInteractionsToSCORM",message:o.message,stack:o.stack,context:{errors:t,successCount:r,totalCount:this.interactions.length}}),o}console.log("[InteractionManager] All interactions synced to SCORM CMI successfully.")}},{key:"_emitError",value:function(e,t,r){E.emit("interaction:error",{domain:"interaction",operation:e,message:t.message,stack:t.stack,context:r})}}])}(),Bt=n("k",new Pt),Ft=new(function(){return g(function e(){p(this,e),this.registry=new Map,this.isReady=!1},[{key:"register",value:function(e,t){if(!e||!e.id){var r=new Error("[InteractionRegistry] Cannot register interaction: configuration or ID is missing.");throw E.emit("interaction:registry:error",{domain:"interaction-registry",operation:"register",message:r.message,stack:r.stack,context:{config:e}}),r}if(this.registry.has(e.id)){var n=new Error('[InteractionRegistry] Interaction with ID "'.concat(e.id,'" is already registered. Duplicate interaction IDs are not allowed. Each interaction must have a unique ID.'));throw E.emit("interaction:registry:error",{domain:"interaction-registry",operation:"register",message:n.message,stack:n.stack,context:{interactionId:e.id}}),n}var a={id:e.id,type:e.type,description:e.prompt,config:e,instance:t};this.registry.set(e.id,a),E.emit("interaction:registered",a)}},{key:"getAll",value:function(){return Array.from(this.registry.values())}},{key:"clear",value:function(){this.registry.clear(),this.isReady=!1,console.log("[InteractionRegistry] Registry cleared.")}},{key:"setReady",value:function(){this.isReady=!0,E.emit("interaction:registry:ready",this.getAll()),console.log("[InteractionRegistry] Registry ready. ".concat(this.registry.size," interactions registered."))}}])}());var Vt=document.getElementById("menu"),Ht=document.getElementById("prevBtn"),Ut=document.getElementById("nextBtn"),Wt=document.getElementById("engagement-indicator"),Yt=null==Wt?void 0:Wt.querySelector(".engagement-progress"),Qt=null==Wt?void 0:Wt.querySelector(".engagement-checkmark"),Gt=!1;function Jt(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;if(Gt||function(){var e=[];if(Vt||e.push("#menu"),Ht||e.push("#prevBtn"),Ut||e.push("#nextBtn"),e.length>0)throw new Error("NavigationUI: Required DOM elements not found: ".concat(e.join(", "),". Check framework/index.html."));Gt=!0}(),!Array.isArray(e))throw new Error("NavigationUI.renderMenu: menuTree must be an array");if(!Array.isArray(t))throw new Error("NavigationUI.renderMenu: visitedSlides must be an array");if(!(r instanceof Map))throw new Error("NavigationUI.renderMenu: accessibilityMap must be a Map");Vt.innerHTML='<ul class="nav-list">'.concat(Zt(e,t,r),"</ul>"),Vt.querySelectorAll(".section-toggle").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault();var r=e.closest(".nav-section").classList.toggle("expanded");e.setAttribute("aria-expanded",r)})})}function Kt(e,t){if(!e||0===e.length)return!1;var r,n=!0,a=!1,o=b(e);try{for(o.s();!(r=o.n()).done;){var i=r.value;if("section"===i.type){if(!Kt(i.children||[],t)){n=!1;break}}else{a=!0;var s=t.get(i.id);if(!s||!1!==s.allowed){n=!1;break}}}}catch(c){o.e(c)}finally{o.f()}return a&&n}function Zt(e,t,r){return e.map(function(e){if("section"===e.type){var n=e.defaultExpanded?"expanded":"",a=!1!==e.collapsible?"collapsible":"",o=Kt(e.children||[],r),i=o?"all-children-locked":"";return o&&console.log('[NavigationUI] Section "'.concat(e.label,'" (').concat(e.id,") has all children locked")),'\n                <li class="nav-section '.concat(n," ").concat(a," ").concat(i,'" data-section-id="').concat(e.id,'" data-testid="nav-section-').concat(e.id,'">\n                    <button class="section-toggle" aria-expanded="').concat(e.defaultExpanded,'" aria-controls="section-').concat(e.id,'" data-testid="nav-section-toggle-').concat(e.id,'">\n                        ').concat(e.icon?'<span class="section-icon" aria-hidden="true">'.concat(e.icon,"</span>"):"",'\n                        <span class="section-label">').concat(e.label,'</span>\n                        <span class="toggle-indicator" aria-hidden="true">›</span>\n                    </button>\n                    <ul class="section-children" id="section-').concat(e.id,'">\n                        ').concat(Zt(e.children||[],t,r),"\n                    </ul>\n                </li>\n            ")}var s=t.includes(e.id)?"visited":"",c=r.get(e.id),l=c&&!1===c.allowed,d=l?"locked":"",u=l?'aria-disabled="true"':"",p=l?'tabindex="-1"':"",m=l&&c.message?"tooltip":"",g=l&&c.message?'data-tooltip="'.concat(c.message,'"'):"",f=l&&c.message?'aria-label="Go to '.concat(e.label," (").concat(c.message,')"'):'aria-label="Go to '.concat(e.label,'"');return'\n                <li class="nav-item '.concat(s," ").concat(d,'" data-slide-id="').concat(e.id,'" data-slide-index="').concat(e.slideIndex,'" data-action="nav-menu-item" data-testid="nav-menu-item-').concat(e.id,'">\n                    <a href="#" role="button" class="').concat(m,'" ').concat(f," ").concat(u," ").concat(p," ").concat(g,">\n                        ").concat(e.icon?'<span class="slide-icon" aria-hidden="true">'.concat(e.icon,"</span>"):"",'\n                        <span class="slide-label">').concat(e.label,"</span>\n                        ").concat(l?'<span class="lock-icon" aria-hidden="true">🔒</span>':"","\n                    </a>\n                </li>\n            ")}).join("")}function $t(e){if(!e||"string"!=typeof e)throw new Error("NavigationUI.setActiveItem: Invalid slideId: ".concat(e));Vt&&Vt.querySelectorAll(".nav-item").forEach(function(t){var r=t.dataset.slideId===e;t.classList.toggle("active",r),t.querySelector("a").setAttribute("aria-current",r?"page":"false")})}function Xt(e,t){var r,n,a;if("object"===h(e)?(r=e.isFirstSlide,t=e.isLastSlide,n=e.nextBlocked||!1,a=e.nextBlockedMessage||null):(r=e,n=!1,a=null),Ht&&(Ht.disabled=r,Ht.setAttribute("aria-disabled",String(r)),Ht.title=r?"No previous slide":"Go to previous slide"),Ut){var o=t||n;Ut.disabled=o,Ut.setAttribute("aria-disabled",String(o)),n&&a?(Ut.classList.add("tooltip"),Ut.setAttribute("data-tooltip",a),Ut.title="",Ut.setAttribute("aria-label","Next (".concat(a,")"))):t?(Ut.classList.remove("tooltip"),Ut.removeAttribute("data-tooltip"),Ut.title="No next slide",Ut.setAttribute("aria-label","Next (No next slide)")):(Ut.classList.remove("tooltip"),Ut.removeAttribute("data-tooltip"),Ut.title="Go to next slide",Ut.setAttribute("aria-label","Next"))}}function er(e){if(!e||"string"!=typeof e)throw new Error("NavigationUI.markAsVisited: Invalid slideId: ".concat(e));if(Vt){var t=Vt.querySelector('.nav-item[data-slide-id="'.concat(e,'"]'));t&&t.classList.add("visited")}}function tr(e){if(!e||"string"!=typeof e)throw new Error("NavigationUI.markAsUnvisited: Invalid slideId: ".concat(e));if(Vt){var t=Vt.querySelector('.nav-item[data-slide-id="'.concat(e,'"]'));t&&t.classList.remove("visited")}}function rr(e){if(!e||"string"!=typeof e)throw new Error("NavigationUI.markAsLocked: Invalid slideId: ".concat(e));if(Vt){var t=Vt.querySelector('.nav-item[data-slide-id="'.concat(e,'"]'));if(t){t.classList.add("locked");var r=t.querySelector("a");r&&(r.setAttribute("aria-disabled","true"),r.setAttribute("tabindex","-1"))}}}function nr(e){if(!e||"string"!=typeof e)throw new Error("NavigationUI.markAsUnlocked: Invalid slideId: ".concat(e));if(Vt){var t=Vt.querySelector('.nav-item[data-slide-id="'.concat(e,'"]'));if(t){t.classList.remove("locked");var r=t.querySelector("a");r&&(r.removeAttribute("aria-disabled"),r.removeAttribute("tabindex"))}}}function ar(e){if(!e||"number"!=typeof e.percentage)throw new Error("NavigationUI.showEngagementIndicator: Invalid progress object");if(Wt){Wt.hidden=!1,function(e,t){if(!Yt||!Qt)return;var r=e<5?0:e,n=2*Math.PI*14,a=n-r/100*n;Yt.style.strokeDasharray="".concat(n," ").concat(n),Yt.style.strokeDashoffset="".concat(a),t?(Qt.style.opacity="1",Yt.classList.add("complete")):(Qt.style.opacity="0",Yt.classList.remove("complete"));null==Wt||Wt.setAttribute("data-progress",e),null==Wt||Wt.setAttribute("data-complete",t?"true":"false")}(e.percentage,100===e.percentage),Wt.setAttribute("data-tooltip","Slide Progress: ".concat(e.percentage,"%"));var t="".concat(e.percentage,"% of content requirements completed");Wt.setAttribute("aria-label",t)}}function or(){Wt&&(Wt.hidden=!0)}function ir(){var e;return null===(e=_t.environment)||void 0===e||null===(e=e.development)||void 0===e||e.disableGating,!1}function sr(){return ir()}function cr(e,t,r){if(!e||"object"!==h(e))return!1;switch(e.type){case"objectiveStatus":var n,a=null===(n=t.getDomainState("objectives"))||void 0===n?void 0:n[e.objectiveId];return!!a&&(void 0!==e.completion_status?a.completion_status===e.completion_status:void 0!==e.success_status&&a.success_status===e.success_status);case"assessmentStatus":var o=t.getDomainState("assessment_".concat(e.assessmentId));if(!o)return!1;var i=o.summary;if(!i||!i.lastResults)return!1;var s=i.lastResults.passed;switch(e.requires){case"completed":return!0===i.submitted;case"passed":return!0===s;case"failed":return!0===i.submitted&&!1===s;default:return!1}case"assessmentAttempts":var c=t.getDomainState("assessment_".concat(e.assessmentId));if(!c)return!1;var l=c.summary,d=(null==l?void 0:l.attempts)||0;return!(void 0!==e.min&&d<e.min)&&!(void 0!==e.max&&d>e.max);case"assessmentConfig":var u=r.get(e.assessmentId);if(!u)return!1;var p=(v=u,e.property.split(".").reduce(function(e,t){return(e||{})[t]},v));return void 0!==p&&(void 0!==e.equals?p===e.equals:void 0!==e.greaterThan?"number"==typeof p&&p>e.greaterThan:void 0===e.lessThan||"number"==typeof p&&p<e.lessThan);case"stateFlag":var m=t.getDomainState("flags"),g=null==m?void 0:m[e.key];return void 0!==e.equals?g===e.equals:void 0!==e.exists?e.exists?void 0!==g:void 0===g:!!g;case"timeOnSlide":var f=t.getDomainState("sessionData");return(((null==f?void 0:f.slideDurations)||{})[e.slideId]||0)/1e3>=(e.minSeconds||0);case"custom":return"function"==typeof e.evaluate&&e.evaluate(t);default:throw new Error("Unknown gating condition type: ".concat(e.type,". Valid types: objectiveStatus, assessmentStatus, assessmentAttempts, assessmentConfig, stateFlag, timeOnSlide, custom."))}var v}function lr(e){if(0===e.length)return"Complete all requirements";if(1===e.length){var t=e[0];switch(t.type){case"viewAllTabs":return t.configError||0===t.total?"Configuration error: This slide requires tabs but has none. Contact course administrator.":"View all ".concat(t.total," tabs (").concat(t.viewed,"/").concat(t.total," viewed)");case"viewAllPanels":return t.configError||0===t.total?"Configuration error: This slide requires accordion panels but has none. Contact course administrator.":"Expand all ".concat(t.total," sections (").concat(t.viewed,"/").concat(t.total," viewed)");case"interactionComplete":return"Complete the practice exercise";case"allInteractionsComplete":return t.configError||0===t.total?"Configuration error: This slide requires interactions but has none. Contact course administrator.":"Complete all practice exercises (".concat(t.completed,"/").concat(t.total," complete)");case"scrollDepth":return"Scroll to the bottom (".concat(t.current,"% scrolled)");case"timeOnSlide":return"Spend at least ".concat(t.required," seconds (").concat(t.current,"s elapsed)");default:return t.message||"Complete all required content"}}var r={};e.forEach(function(e){r[e.type]=(r[e.type]||0)+1});var n=[],a=new Set;return e.forEach(function(e){var t=e.type;if(!a.has(t))switch(a.add(t),e.type){case"viewAllTabs":n.push("View all tabs (".concat(e.viewed,"/").concat(e.total,")"));break;case"viewAllPanels":n.push("Expand all sections (".concat(e.viewed,"/").concat(e.total,")"));break;case"interactionComplete":case"allInteractionsComplete":n.push("Complete exercises (".concat(e.completed,"/").concat(e.total,")"));break;case"scrollDepth":n.push("Scroll to bottom (".concat(e.current,"%)"));break;case"timeOnSlide":n.push("Spend ".concat(e.required,"s on slide"));break;default:n.push(e.message||"Complete requirement")}}),1===n.length?n[0]:"Complete: ".concat(n.join(", "))}function dr(e,t,r){var n;if(!e)return!1;var a=null===(n=e.navigation)||void 0===n?void 0:n.sequence;if(!a)return!0;var o=a.includeWhen||[],i=a.skipUntil||[],s=!1!==a.includeByDefault;(o.length>0&&(s=o.every(function(e){return cr(e,t,r)})),s&&i.length>0)&&(i.every(function(e){return cr(e,t,r)})||(s=!1));return s}function ur(e,t,r){if(ir(),!e||!e.navigation||!e.navigation.gating)return{allowed:!0,message:null};var n=e.navigation.gating,a=n.conditions||[];if(0===a.length)return{allowed:!0,message:null};var o=n.mode||"all",i=!1;return"all"===o?i=a.every(function(e){return cr(e,t,r)}):"any"===o&&(i=a.some(function(e){return cr(e,t,r)})),{allowed:i,message:i?null:n.message||"This content is currently locked.",reason:i?null:"gating-failed"}}function pr(e,t){if(ir(),!e)return{allowed:!0,message:null};if("assessment"===e.type){var r=t.get(e.assessmentId),n=null==r?void 0:r.completionRequirements;if(!0===(null==n?void 0:n.blockNavigation))if(!vo(e.assessmentId,n)){var a="You must complete the assessment before continuing.";return n.requirePass?a="You must pass the assessment before continuing.":n.requireSubmission&&(a="You must submit your assessment before continuing."),{allowed:!1,message:a,reason:"assessment-incomplete"}}}return{allowed:!0,message:null}}var mr=new WeakMap,gr=function(){return g(function t(){p(this,t),e(this,mr,void 0),r(mr,this,[])},[{key:"initialize",value:function(){r(mr,this,Me.getComments()),console.log("CommentManager initialized")}},{key:"addComment",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!e||"string"!=typeof e||""===e.trim())throw new Error("CommentManager: Comment text cannot be empty.");var n={text:e,location:r,timestamp:(new Date).toISOString()};t(mr,this).push(n),Me.addComment(n),console.log("Comment added and persisted to LMS:",n)}},{key:"addRating",value:function(e){null!=e&&(Bt.addLikertInteraction({id:"course-rating",response:String(e),description:"Overall course satisfaction rating on a 5-star scale."}),console.log("Rating added and persisted to LMS:",e))}},{key:"getComments",value:function(){return v(t(mr,this))}}])}(),fr=new gr,vr={isInitialized:!1,initializationError:null,currentModal:null,modalStack:[],loadingVisible:!0,sidebarCollapsed:!0,footerCompleteMode:!1,exitButtonMode:"exit",courseExitLocked:!1,exitInProgress:!1,isExitIntentional:!1};function hr(){if(vr.isInitialized)throw new Error("AppState: Already initialized. Do not call initAppState() more than once.");vr.isInitialized=!0,console.log("[AppState] Initialized")}function br(){return vr.isInitialized}function yr(e){vr.initializationError=e instanceof Error?e:new Error(String(e))}function wr(e){e&&vr.currentModal!==e&&vr.currentModal&&vr.modalStack.push(vr.currentModal),vr.currentModal=e}function xr(){vr.currentModal=null}function kr(e){vr.loadingVisible=!!e}function Sr(e){vr.sidebarCollapsed=!!e}function Er(e){vr.footerCompleteMode=!!e}function Ar(){return vr.footerCompleteMode}function Cr(e){if("exit"!==e&&"complete"!==e)throw new Error("[AppState] Invalid exit button mode: ".concat(e,". Valid modes: 'exit', 'complete'."));vr.exitButtonMode=e}function zr(e){vr.courseExitLocked=!!e}function Ir(){return vr.courseExitLocked}function Mr(e){vr.exitInProgress=!!e}function qr(e){vr.isExitIntentional=!!e}function Lr(){return vr.isExitIntentional}var Tr=Object.freeze(Object.defineProperty({__proto__:null,clearCurrentModal:xr,getCurrentModal:function(){return vr.currentModal},getExitButtonMode:function(){return vr.exitButtonMode},getInitializationError:function(){return vr.initializationError},getState:function(){return f(vr)},initAppState:hr,isCourseExitLocked:Ir,isExitInProgress:function(){return vr.exitInProgress},isExitIntentional:Lr,isFooterCompleteMode:Ar,isInitialized:br,isLoadingVisible:function(){return vr.loadingVisible},isSidebarCollapsed:function(){return vr.sidebarCollapsed},popModalStack:function(){return vr.modalStack.pop()||null},setCourseExitLocked:zr,setCurrentModal:wr,setExitButtonMode:Cr,setExitInProgress:Mr,setExitIntentional:qr,setFooterCompleteMode:Er,setInitializationError:yr,setLoadingVisible:kr,setSidebarCollapsed:Sr,toggleSidebar:function(){return vr.sidebarCollapsed=!vr.sidebarCollapsed,vr.sidebarCollapsed}},Symbol.toStringTag,{value:"Module"})),Or={correct:["✓ Excellent work!","✓ Perfect! You got it right.","✓ Outstanding! That's correct.","✓ Well done! Correct answer.","✓ Great job! You're right on target."],incorrect:["✗ Not quite right. Let's review this concept.","✗ That's incorrect, but good effort! Try again.","✗ Close, but not correct. Think about it differently.","✗ Not the right answer. Consider the key principles.","✗ Incorrect. Let me provide some guidance."],partial:["⚬ Partially correct. You're on the right track!","⚬ Good progress! Some parts are right.","⚬ You've got some of it! Keep working on the rest.","⚬ Partly there! Review the areas you missed."],encouragement:["Keep trying! Learning takes practice.","You're making good progress!","Don't give up - you're learning!","Every attempt helps you understand better.","Great effort! Keep going!"]};function jr(e){var t=Or[e];return t&&0!==t.length?t[Math.floor(Math.random()*t.length)]:"Good work!"}function _r(e){return e&&0!==e.length?e.reduce(function(e,t){return e+(t.score||0)},0)/e.length:0}function Rr(e){if(!e||0===e.length)return[];var t={};return e.forEach(function(e){var r=e.topic||"general";t[r]||(t[r]=[]),t[r].push(e.score||0)}),Object.entries(t).filter(function(e){var t=a(e,2),r=(t[0],t[1]);return r.reduce(function(e,t){return e+t},0)/r.length<.6&&r.length>=2}).map(function(e){return a(e,1)[0]})}function Dr(e){if(!e||0===e.length)return[];var t={};return e.forEach(function(e){var r=e.topic||"general";t[r]||(t[r]=[]),t[r].push(e.score||0)}),Object.entries(t).filter(function(e){var t=a(e,2),r=(t[0],t[1]);return r.reduce(function(e,t){return e+t},0)/r.length>.8&&r.length>=2}).map(function(e){return a(e,1)[0]})}function Nr(e){if(!e||e.length<3)return"multimodal";var t={};e.forEach(function(e){var r=e.type;r&&(t[r]||(t[r]={total:0,successful:0}),t[r].total++,(e.score||0)>.7&&t[r].successful++)});var r=null,n=0;Object.entries(t).forEach(function(e){var t=a(e,2),o=t[0],i=t[1];if(i.total>=3){var s=i.successful/i.total;s>n&&(n=s,r=o)}});return{hotspot:"visual","drag-drop":"hands-on","fill-in":"analytical",choice:"verbal",numeric:"analytical"}[r]||"multimodal"}function Pr(e){if(!e||e.length<3)return"normal";var t=e.slice(-5).map(function(e){return e.timeSpent||3e4}),r=t.reduce(function(e,t){return e+t},0)/t.length;return r<15e3?"fast":r>6e4?"careful":"normal"}function Br(e){if(!e||0===e.length)return.5;var t=0,r=0;return e.forEach(function(e,n){var a=Math.pow(1.2,n);t+=(e.score||0)*a,r+=a}),r>0?t/r:.5}function Fr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.correct,n=e.score,a=void 0===n?0:n,o=e.topic,i=void 0===o?"general":o,s=e.difficulty,c=void 0===s?1:s,l=e.attempts,d=void 0===l?1:l,u=function(e,t){if(!e||0===e.length)return{averageScore:0,strugglingWith:[],strongIn:[],preferredStyle:"multimodal",pace:"normal",confidence:.5};var r=e.filter(function(e){return e.topic===t});return{averageScore:_r(e.slice(-10)),strugglingWith:Rr(e),strongIn:Dr(e),preferredStyle:Nr(e),pace:Pr(e),confidence:Br(r)}}(t,i),p={immediate:"",detailed:"",suggestions:[],resources:[],encouragement:""};return r?(p.immediate=jr("correct"),a>=.9&&(p.immediate+=" You're mastering this topic!")):p.immediate=jr(a>.5?"partial":"incorrect"),u.strugglingWith.includes(i)&&(p.detailed="I notice you're finding ".concat(i," challenging. This is a complex concept that many learners work on. "),p.suggestions.push("Take some time to review the fundamentals"),p.resources.push("Review the ".concat(i," section again")),p.suggestions.push("Try breaking down the problem into smaller parts")),d>2&&(p.detailed+="You're showing persistence, which is great! ",p.suggestions.push("Consider a different approach to this problem"),p.encouragement=jr("encouragement")),"visual"===u.preferredStyle?p.suggestions.push("Try creating a diagram or visual representation"):"hands-on"===u.preferredStyle&&p.suggestions.push("Try working through a practical example"),u.averageScore<.6&&c>1?p.suggestions.push("Let's try some easier examples first to build confidence"):u.averageScore>.8&&c<3&&p.suggestions.push("You're ready for more challenging questions!"),p}function Vr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r={strugglingWith:Rr(e),strongIn:Dr(e),learningStyle:Nr(e),pace:Pr(e),averageScore:_r(e)};return{interactions:e,patterns:r,sessionDuration:t,totalInteractions:e.length,averageScore:r.averageScore}}function Hr(e,t,r){var n=Vr(e,t);return{sessionDuration:t,totalInteractions:n.interactions.length,averageScore:n.interactions.reduce(function(e,t){return e+(t.score||0)},0)/Math.max(1,n.interactions.length),learningStyle:n.patterns.learningStyle,strugglingWith:n.patterns.strugglingWith,strongIn:n.patterns.strongIn,pace:n.patterns.pace,objectives:r}}var Ur=Object.freeze(Object.defineProperty({__proto__:null,calculateTopicMastery:function(e){if(!e||0===e.length)return 0;var t=e.slice(-10),r=_r(t);if(t.length<2)return r;var n=t.map(function(e){return e.score||0}),a=n.reduce(function(e,t){return e+t},0)/n.length,o=n.reduce(function(e,t){return e+Math.pow(t-a,2)},0)/n.length,i=Math.sqrt(o);return.7*r+.3*Math.max(0,1-2*i)},displayEnhancedFeedback:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!(e&&e instanceof HTMLElement))throw new Error("displayEnhancedFeedback: container must be a valid HTMLElement");if(!t)throw new Error("displayEnhancedFeedback: feedback parameter is required");var n=r.showAnalytics,a=void 0!==n&&n,o=r.analytics,i=void 0===o?null:o,s=r.learnerHistory,c=void 0===s?[]:s,l=a&&c.length>0?{strengths:Dr(c),weaknesses:Rr(c),learningStyle:Nr(c),pace:Pr(c)}:null,d='\n      <div class="enhanced-feedback" role="region" aria-label="Feedback and Progress">\n        <div class="feedback-header">\n          <div class="result-indicator '.concat(t.immediate.startsWith("✓")?"success":"needs-improvement",'">\n            ').concat(t.immediate,"\n          </div>\n          ").concat(i&&void 0!==i.overallProgress?'\n            <div class="progress-indicator">\n              <span class="progress-label">Progress:</span>\n              <span class="progress-value">'.concat(Math.round(100*i.overallProgress),"%</span>\n            </div>\n          "):"","\n        </div>\n\n        ").concat(t.detailed?'\n          <div class="detailed-feedback">\n            <h4>Analysis:</h4>\n            <p>'.concat(t.detailed,"</p>\n          </div>\n        "):"","\n\n        ").concat(t.suggestions&&t.suggestions.length>0?'\n          <div class="improvement-suggestions">\n            <h4>Next Steps:</h4>\n            <ul>\n              '.concat(t.suggestions.map(function(e){return"<li>".concat(e,"</li>")}).join(""),"\n            </ul>\n          </div>\n        "):"","\n\n        ").concat(t.resources&&t.resources.length>0?'\n          <div class="additional-resources">\n            <h4>Resources:</h4>\n            <ul>\n              '.concat(t.resources.map(function(e){return"<li>".concat(e,"</li>")}).join(""),"\n            </ul>\n          </div>\n        "):"","\n\n        ").concat(t.encouragement?'\n          <div class="encouragement-message">\n            <p><strong>'.concat(t.encouragement,"</strong></p>\n          </div>\n        "):"","\n\n        ").concat(a&&i&&l?'\n          <div class="learning-insights">\n            <details>\n              <summary>View Your Learning Insights</summary>\n              <div class="insights-content">\n                '.concat(void 0!==i.topicMastery?'\n                  <div class="insight-item">\n                    <span class="insight-label">Topic Mastery:</span>\n                    <span class="insight-value">'.concat(Math.round(100*i.topicMastery),"%</span>\n                  </div>\n                "):"","\n                ").concat(void 0!==i.sessionProgress?'\n                  <div class="insight-item">\n                    <span class="insight-label">Session Interactions:</span>\n                    <span class="insight-value">'.concat(i.sessionProgress,"</span>\n                  </div>\n                "):"",'\n                <div class="insight-item">\n                  <span class="insight-label">Learning Pace:</span>\n                  <span class="insight-value">').concat(l.pace,"</span>\n                </div>\n                ").concat(l.strengths.length>0?'\n                  <div class="insight-item">\n                    <span class="insight-label">Your Strengths:</span>\n                    <span class="insight-value">'.concat(l.strengths.join(", "),"</span>\n                  </div>\n                "):"","\n              </div>\n            </details>\n          </div>\n        "):"","\n      </div>\n    ");e.innerHTML=d,ht(t.immediate),i&&void 0!==i.overallProgress&&setTimeout(function(){ht("Your overall progress is ".concat(Math.round(100*i.overallProgress),"%"))},1e3)},generateAdaptiveFeedback:Fr,generateContextualHint:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r={calculation:["Double-check your arithmetic","Make sure you're using the right formula","Check your units of measurement"],concept:["Think about the main principles we discussed","Consider how this relates to what you learned earlier","Try to connect this to a real-world example"],application:["Break the problem down into smaller steps","What information are you given? What do you need to find?","Have you seen a similar problem before?"]},n=r[e.category||"concept"]||r.concept,a=t.map(function(e){return e.hint}).filter(Boolean),o=n.filter(function(e){return!a.includes(e)});return o.length>0?o[Math.floor(Math.random()*o.length)]:"Take your time and think through the problem step by step."},generateLearningReport:Hr,getLearningAnalytics:Vr,getMotivationalMessage:function(e){return e>=.9?"🌟 Exceptional work! You're truly mastering this material!":e>=.7?"🎯 Great progress! You're doing really well!":e>=.5?"📈 Good work! You're making steady progress!":e>=.3?"💪 Keep going! Every step forward counts!":"🌱 Remember, learning takes time. You've got this!"}},Symbol.toStringTag,{value:"Module"}));function Wr(){document.body.addEventListener("click",function(){var e=u(c().m(function e(t){var r,n,a;return c().w(function(e){for(;;)switch(e.n){case 0:if(r=t.target.closest("[data-action]")){e.n=1;break}return e.a(2);case 1:n=r.dataset.action,a=n,e.n="exit-course"===a?2:"confirm-exit"===a?4:"confirm-complete"===a?5:"confirm-restart"===a?6:"complete-course"===a?7:"generate-report"===a?9:"provide-feedback"===a?10:11;break;case 2:return e.n=3,en();case 3:case 8:return e.a(3,11);case 4:return $r(),e.a(3,11);case 5:return Xr(),e.a(3,11);case 6:return ln(),e.a(3,11);case 7:return e.n=8,rn();case 9:return Yr(t),e.a(3,11);case 10:return Qr(),e.a(3,11);case 11:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),E.on("navigation:beforeChange",function(e){return on(e.fromSlideId)}),E.on("navigation:changed",function(e){return an(e.toSlideId)}),E.on("navigation:completeCheck",Jr),console.log("AppActions initialized.")}function Yr(e){var t=e.target.closest(".slide-view-container");if(t){var r=Hr(Bt.getAllInteractions(),sn(),Nt.getObjectives()),n=t.querySelector("#final-report");n&&(n.innerHTML='\n        <div class="learning-report">\n          <h4>📊 Detailed Learning Report</h4>\n          <pre>'.concat(JSON.stringify(r,null,2),"</pre>\n        </div>\n      "))}else console.error("[AppActions] Could not find root element for report generation.")}function Qr(){return Gr.apply(this,arguments)}function Gr(){return(Gr=u(c().m(function e(){var t;return c().w(function(e){for(;;)switch(e.n){case 0:(t=prompt("Please provide feedback about your learning experience:"))&&(fr.addComment(t,"course-feedback"),ht("Thank you for your feedback!"));case 1:return e.a(2)}},e)}))).apply(this,arguments)}function Jr(){return Kr.apply(this,arguments)}function Kr(){return Kr=u(c().m(function e(){var t,r,n,a,o,i,s,l,d,u,p;return c().w(function(e){for(;;)switch(e.n){case 0:if(t=Yn(),r=Me.getValue("cmi.completion_status")||"incomplete",t){e.n=1;break}return n="completed"===r&&Me.getValue("cmi.success_status")||"unknown",E.emit("course:statusChanged",{completionStatus:r,successStatus:n,isOnLastSlide:!1}),e.a(2,!1);case 1:if("completed"!==r){e.n=2;break}return E.emit("course:statusChanged",{completionStatus:"completed",successStatus:Me.getValue("cmi.success_status")||"unknown",isOnLastSlide:!0}),e.a(2,!0);case 2:return e.n=3,me("assessment");case 3:return a=e.v,e.n=4,fe();case 4:return o=e.v,i=a.filter(function(e){var t;return null===(t=o.get(e.assessmentId))||void 0===t||null===(t=t.completionRequirements)||void 0===t?void 0:t.requireSubmission}),s=i.every(function(e){return vo(e.assessmentId,{requireSubmission:!0})}),l=s?"completed":"incomplete",d=a.filter(function(e){var t;return null===(t=o.get(e.assessmentId))||void 0===t||null===(t=t.completionRequirements)||void 0===t?void 0:t.requirePass}),u="unknown",d.length>0?(p=d.every(function(e){return vo(e.assessmentId,{requirePass:!0})}),u=p?"passed":"failed"):"completed"===l&&(u="passed"),Me.setValue("cmi.completion_status",l),Me.setValue("cmi.success_status",u),E.emit("course:statusChanged",{completionStatus:l,successStatus:u,isOnLastSlide:!0}),e.a(2,!0)}},e)})),Kr.apply(this,arguments)}function Zr(){qr(!0)}function $r(){Zr(),Mr(!0);var e=Fe();if(e){Ue(e);var t=Un();if(t){var r=t.filter(function(e){var t;return!1!==(null===(t=e.navigation)||void 0===t||null===(t=t.sequence)||void 0===t?void 0:t.included)}).length;Me.updateProgressMeasure(r)}}Me.exitCourseWithSuspend()?E.emit("ui:lockCourseForExit"):za("We were unable to finalize the session automatically. Please close this window manually.","warning",6e3)}function Xr(){Zr(),Mr(!0);var e=Fe();if(e){Ue(e);var t=Un();if(t){var r=t.filter(function(e){var t;return!1!==(null===(t=e.navigation)||void 0===t||null===(t=t.sequence)||void 0===t?void 0:t.included)}).length;Me.updateProgressMeasure(r)}}var n=function(){var e=null;if(ca){var t=ca.getResponse();t&&t.overall&&(e=t.overall)}var r=document.getElementById("completion-comments-textarea"),n=r&&r.value.trim()?r.value:null;return{rating:e,comment:n}}(),a=n.rating,o=n.comment;a&&fr.addRating(a),o&&fr.addComment(o,"course-completion"),Me.exitCourseComplete()?E.emit("ui:lockCourseForExit"):za("We were unable to finalize the session automatically. Please close this window manually.","warning",6e3)}function en(){return tn.apply(this,arguments)}function tn(){return(tn=u(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Jr();case 1:if(!e.v){e.n=2;break}return cn(),e.a(2);case 2:E.emit("ui:showModal","exit");case 3:return e.a(2)}},e)}))).apply(this,arguments)}function rn(){return nn.apply(this,arguments)}function nn(){return(nn=u(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Jr();case 1:cn();case 2:return e.a(2)}},e)}))).apply(this,arguments)}function an(e){if(!e)throw new Error("[AppActions] startSessionTimer called without slideId");var t=Me.getDomainState("sessionData")||{};t.slideStartTimes=t.slideStartTimes||{},t.slideDurations=t.slideDurations||{};var r=t.slideStartTimes[e];if(r){var n=Date.now()-r;t.slideDurations[e]=(t.slideDurations[e]||0)+n}t.slideStartTimes[e]=Date.now(),Me.setDomainState("sessionData",t),console.log("[AppActions] Session timer started for: ".concat(e))}function on(e){if(!e)throw new Error("[AppActions] endSessionTimer called without slideId");var t=Me.getDomainState("sessionData")||{};t.slideStartTimes=t.slideStartTimes||{},t.slideDurations=t.slideDurations||{};var r=t.slideStartTimes[e];if(!r)return null;var n=Date.now()-r;return t.slideDurations[e]=(t.slideDurations[e]||0)+n,delete t.slideStartTimes[e],Me.setDomainState("sessionData",t),console.log("[AppActions] Session timer ended for: ".concat(e,", duration: ").concat(n,"ms")),n}function sn(){var e=(Me.getDomainState("sessionData")||{}).slideDurations||{};return Object.values(e).reduce(function(e,t){return e+t},0)}function cn(){var e=_t.completion||{};E.emit("ui:prepareCompletionModal",{promptForComments:!!e.promptForComments,promptForRating:!!e.promptForRating}),E.emit("ui:showModal","complete")}function ln(){try{Me.clearAllData(),window.location.reload()}catch(t){var e={domain:"app",operation:"restartCourse",message:"Failed to restart course: ".concat(t.message),stack:t.stack,context:{originalError:t}};throw E.emit("app:error",e),new Error(e.message)}}var dn,un=Object.freeze(Object.defineProperty({__proto__:null,checkCompletion:Jr,endSessionTimer:on,exit:$r,getSessionDuration:sn,initAppActions:Wr,restartCourse:ln,setExitFlag:Zr,showCompletionModal:cn,showNotification:za,startSessionTimer:an},Symbol.toStringTag,{value:"Module"})),pn=[],mn=[],gn=new Map,fn=!1,vn=!1,hn=[],bn=!1,yn=null,wn=null;function xn(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=new Error("Navigation failed: ".concat(t));return E.emit("navigation:error",{domain:"navigation",operation:e,message:n.message,stack:n.stack,context:r}),n}function kn(e,t){return Sn.apply(this,arguments)}function Sn(){return Sn=u(c().m(function e(t,r){var n,a,o,i,s,l,d,u=arguments;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=u.length>2&&void 0!==u[2]?u[2]:[],a=u.length>3&&void 0!==u[3]?u[3]:new Map,t&&Array.isArray(t)){e.n=1;break}throw new Error("NavigationActions.init() requires a valid slides array");case 1:if(r){e.n=2;break}throw new Error("NavigationActions.init() requires a valid viewManager instance");case 2:if(pn=t,dn=r,mn=n,gn=a,fn=!1,vn=!0,Ne(),Be(t),o=He(),i=Dn(),Jt(mn,o,i),document.body.addEventListener("click",function(e){var t=e.target.closest("[data-action]");if(t){var r=t.dataset.action;if(fn)e.preventDefault();else switch(r){case"nav-menu-item":qn(e);break;case"nav-prev":Fn().catch(function(e){console.warn("Navigation failed:",e.message)});break;case"nav-next":Pn().catch(function(e){console.warn("Navigation failed:",e.message)})}}}),E.on("state:changed",function(e){var t=e.domain;(t.startsWith("assessment_")||"objectives"===t||"flags"===t)&&Nn()}),E.on("ui:lockCourseForExit",function(){fn=!0}),s=Pe(),l=pn[s]){e.n=3;break}throw xn("initial-load","No slide found for initial index ".concat(s,". Check course-config.js ordering."),{slideIndex:s});case 3:return e.p=3,e.n=4,Ln(l.id);case 4:e.n=6;break;case 5:throw e.p=5,d=e.v,E.emit("navigation:error",{domain:"navigation",operation:"initial-load",message:d.message,stack:d.stack,context:{slideId:l.id,slideIndex:s}}),d;case 6:console.log("NavigationActions initialized.");case 7:return e.a(2)}},e,null,[[3,5]])})),Sn.apply(this,arguments)}function En(){if(!vn)throw new Error("NavigationActions not initialized. Call init() first.")}function An(){return vn}function Cn(e){if(e&&e.engagement){var t=e.engagement;if(t.required&&t.showIndicator){var r=Qe.getProgress(e.id);r&&ar(r)}else or()}else or()}function zn(e){yn&&E.off("engagement:progress",yn),wn&&E.off("engagement:complete",wn),e&&e.engagement&&e.engagement.required&&(yn=function(t){var r=t.slideId,n=t.progress;r===e.id&&(e.engagement.showIndicator&&ar(n),Nn())},wn=function(t){var r=t.slideId;if(r===e.id){if(e.engagement.showIndicator){var n=Qe.getProgress(r);n&&ar(n)}Nn()}},E.on("engagement:progress",yn),E.on("engagement:complete",wn))}function In(e){for(var t=e+1;t<pn.length;t++){var r=pn[t];if(dr(r,Me,gn))return{index:t,slide:r,accessCheck:ur(r,Me,gn)}}return{index:null,slide:null,accessCheck:{allowed:!0,message:null}}}function Mn(e){for(var t=e-1;t>=0;t--){var r=pn[t];if(dr(r,Me,gn))return{index:t,slide:r,accessCheck:ur(r,Me,gn)}}return{index:null,slide:null,accessCheck:{allowed:!0,message:null}}}function qn(e){e.preventDefault();var t=e.target.closest('[data-action="nav-menu-item"]');if(t){var r=t.querySelector("a");if(!(t.classList.contains("locked")||r&&"true"===r.getAttribute("aria-disabled"))){var n=t.dataset.slideId;n&&Ln(n).catch(function(e){console.warn("Navigation failed:",e.message)})}}}function Ln(e){return Tn.apply(this,arguments)}function Tn(){return Tn=u(c().m(function e(t){var r,n=arguments;return c().w(function(e){for(;;)if(0===e.n)return r=n.length>1&&void 0!==n[1]?n[1]:{},En(),e.a(2,new Promise(function(e,n){hn.push({slideId:t,context:r,resolve:e,reject:n}),On()}))},e)})),Tn.apply(this,arguments)}function On(){return jn.apply(this,arguments)}function jn(){return(jn=u(c().m(function e(){var t,r,n,a,o,i;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!bn&&0!==hn.length){e.n=1;break}return e.a(2);case 1:return bn=!0,t=hn.shift(),r=t.slideId,n=t.context,a=t.resolve,o=t.reject,e.p=2,e.n=3,_n(r,n);case 3:a(),e.n=5;break;case 4:e.p=4,i=e.v,o(i);case 5:return e.p=5,bn=!1,On(),e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}))).apply(this,arguments)}function _n(e){return Rn.apply(this,arguments)}function Rn(){return Rn=u(c().m(function e(t){var r,n,a,o,s,l,d,u,p,m,g,f,v,h,b,y,w,x=arguments;return c().w(function(e){for(;;)switch(e.n){case 0:if(r=x.length>1&&void 0!==x[1]?x[1]:{},!fn){e.n=1;break}throw xn("goToSlide","Navigation is locked. Course is in exit process.",{slideId:t});case 1:return e.n=2,se(t);case 2:if(null!=(n=e.v)){e.n=3;break}throw xn("goToSlide",'Slide "'.concat(t,'" not found in course structure. Check that the slide ID exists in course-config.js.'),{slideId:t,availableSlides:pn.map(function(e){return e.id})});case 3:if(a=pn[n]){e.n=4;break}throw xn("goToSlide","Slide at index ".concat(n," is undefined. This indicates a data consistency issue."),{slideId:t,slideIndex:n});case 4:if(dr(a,Me,gn)){e.n=5;break}throw za(s=(null===(o=a.navigation)||void 0===o||null===(o=o.sequence)||void 0===o?void 0:o.message)||"This content is not available right now.","info",3e3),E.emit("navigation:blocked",{slideId:a.id,slideIndex:n,message:s,reason:"sequence-excluded"}),xn("goToSlide",s,{slideId:a.id,reason:"sequence-excluded"});case 5:if((l=ur(a,Me,gn)).allowed){e.n=6;break}throw za(l.message,"info",3e3),E.emit("navigation:blocked",{slideId:a.id,slideIndex:n,message:l.message,reason:"gating-condition"}),xn("goToSlide",l.message,{slideId:a.id,reason:"gating-condition"});case 6:return d=Pe(),u=null,null!==d&&d!==n&&(p=pn[d])&&(u=p.id,Ue(p.id),Nn(),E.emit("navigation:beforeChange",{fromSlideId:p.id})),Ve(n),$t(a.id),e.n=7,dn.showView(a.id,i(i({},r),{},{fromSlide:u}));case 7:m=pr(a,gn,a.id),g=In(n),f=g.accessCheck,v=!0,h={complete:!0,unmetRequirements:[]},sr()||(h=Qe.evaluateRequirements(a.id),v=h.complete),b=!v||!m.allowed||!f.allowed,y=v?m.message||f.message:lr(h.unmetRequirements),Xt({isFirstSlide:0===n,isLastSlide:null===g.slide,nextBlocked:b,nextBlockedMessage:y}),zn(a),Cn(a),an(t),w=pn.filter(function(e){return dr(e,Me,gn)}).length,Me.updateProgressMeasure(w),Nn(),E.emit("navigation:changed",{toSlideId:a.id}),E.emit("navigation:completeCheck");case 8:return e.a(2)}},e)})),Rn.apply(this,arguments)}function Dn(){En();var e=new Map,t=He(),r=Pe(),n=pn[r];return pn.forEach(function(r,a){if(dr(r,Me,gn)){var o=ur(r,Me,gn);if(o.allowed)if(n&&r.id===n.id)e.set(r.id,{allowed:!0,message:null});else{var i=!1,s=null;if(!sr())for(var c=0;c<a;c++){var l=pn[c];if(dr(l,Me,gn)){var d=l.engagement;if(d&&!0===d.required){if(!t.includes(l.id)){i=!0,s=l.title||l.id;break}if(!Qe.evaluateRequirements(l.id).complete){i=!0,s=l.title||l.id;break}}}}if(i){var u=s?'Complete all required content in "'.concat(s,'" before continuing.'):"Complete all required content on previous slides before continuing.";e.set(r.id,{allowed:!1,message:u})}else e.set(r.id,{allowed:!0,message:null})}else e.set(r.id,o)}else{var p;e.set(r.id,{allowed:!1,message:(null===(p=r.navigation)||void 0===p||null===(p=p.sequence)||void 0===p?void 0:p.message)||"This content is not available right now."})}}),e}function Nn(){En();var e,t=Pe(),r=pn[t],n=b(Dn().entries());try{for(n.s();!(e=n.n()).done;){var o=a(e.value,2),i=o[0];o[1].allowed?nr(i):rr(i)}}catch(m){n.e(m)}finally{n.f()}var s=He();pn.forEach(function(e){var t=s.includes(e.id);if("assessment"===e.type){var r=gn.get(e.assessmentId),n=null==r?void 0:r.completionRequirements,a=!1;n&&(a=vo(e.assessmentId,n)),t&&a?er(e.id):tr(e.id)}else t?er(e.id):tr(e.id)});var c=pr(r,gn,null==r?void 0:r.id),l=In(t),d=l.accessCheck,u=!0,p={complete:!0,unmetRequirements:[]};sr()||(u=(p=Qe.evaluateRequirements(r.id)).complete),Xt({isFirstSlide:0===t,isLastSlide:null===l.slide,nextBlocked:!u||!c.allowed||!d.allowed,nextBlockedMessage:u?c.message||d.message:lr(p.unmetRequirements)})}function Pn(){return Bn.apply(this,arguments)}function Bn(){return(Bn=u(c().m(function e(){var t,r,n,a,o,i,s,l,d;return c().w(function(e){for(;;)switch(e.n){case 0:if(En(),!fn){e.n=1;break}throw xn("goToNextAvailableSlide","Navigation is locked. Course is in exit process.",{});case 1:if(r=Pe(),n=pn[r],sr()){e.n=2;break}if((a=Qe.evaluateRequirements(n.id)).complete){e.n=2;break}return E.emit("navigation:blocked",{reason:"engagement_incomplete",slideId:n.id,unmetRequirements:a.unmetRequirements}),e.a(2);case 2:if((o=pr(n,gn,n.id)).allowed){e.n=3;break}return za(o.message,"warning",3e3),e.a(2);case 3:if(i=null===(t=n.navigation)||void 0===t?void 0:t.controls,!(s=(null==i?void 0:i.nextTarget)||(null==i?void 0:i.exitTarget))){e.n=5;break}return e.n=4,Ln(s);case 4:case 7:return e.a(2);case 5:if(l=In(r),d=l.slide){e.n=6;break}return e.a(2);case 6:return e.n=7,Ln(d.id)}},e)}))).apply(this,arguments)}function Fn(){return Vn.apply(this,arguments)}function Vn(){return(Vn=u(c().m(function e(){var t,r,n,a,o,i,s;return c().w(function(e){for(;;)switch(e.n){case 0:if(En(),!fn){e.n=1;break}throw xn("goToPreviousAvailableSlide","Navigation is locked. Course is in exit process.",{});case 1:if(r=Pe(),n=pn[r],a=null===(t=n.navigation)||void 0===t?void 0:t.controls,!(o=null==a?void 0:a.previousTarget)){e.n=3;break}return e.n=2,Ln(o);case 2:case 5:return e.a(2);case 3:if(i=Mn(r),s=i.slide){e.n=4;break}return e.a(2);case 4:return e.n=5,Ln(s.id)}},e)}))).apply(this,arguments)}function Hn(){return En(),In(Pe())}function Un(){return En(),pn}function Wn(){En();var e=Pe();return pn[e]||null}function Yn(){return En(),null===Hn().slide}var Qn=Object.freeze(Object.defineProperty({__proto__:null,checkAllSlidesAccessibility:Dn,getAllSlides:Un,getCurrentSlide:Wn,getCurrentSlideId:function(){En();var e=Wn();return e?e.id:null},getMenuTree:function(){return En(),mn},getNextSequentialSlideInfo:Hn,getPreviousSequentialSlideInfo:function(){return En(),Mn(Pe())},goToNextAvailableSlide:Pn,goToPreviousAvailableSlide:Fn,goToSlide:Ln,init:kn,isOnLastSlide:Yn,isReady:An,resetNavigation:function(){var e,t;En(),Ve(0),Re.visitedSlides=[],We(),$t(null===(e=pn[0])||void 0===e?void 0:e.id);var r=pn[0],n=pr(r,gn,null==r?void 0:r.id);Xt({isFirstSlide:!0,isLastSlide:1===pn.length,nextBlocked:!n.allowed,nextBlockedMessage:n.message}),dn.showView(null===(t=pn[0])||void 0===t?void 0:t.id)},sync:Nn},Symbol.toStringTag,{value:"Module"}));function Gn(e,t){if(!e||"object"!==h(e))throw new Error("Interaction config must be an object");if(!e.id||"string"!=typeof e.id)throw new Error("Interaction must have a valid string id");if(!e.prompt||"string"!=typeof e.prompt)throw new Error('Interaction "'.concat(e.id,'" must have a valid prompt'));var r,n=b(t);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(void 0===e[a])throw new Error('Interaction "'.concat(e.id,'" is missing required property: ').concat(a))}}catch(o){n.e(o)}finally{n.f()}}function Jn(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(n){var a=n.target.closest("[data-action]");if(a){var o=a.dataset.action;if(a.dataset.interaction===t.id)switch(o){case"check-answer":var i=e.checkAnswer();if(!i)return;var s=Fe();s&&Qe.trackInteraction(s,t.id,!0,i.correct),t.controlled||Kn(t,i);break;case"reset":e.reset();break;case"show-hint":e.showHint&&e.showHint();break;default:r[o]&&r[o](n,a)}}}}function Kn(e,t){var r={id:e.id,type:e.scormType||"other",learner_response:t.response,result:t.correct?"correct":"incorrect",correct_responses:t.correctResponses||[{pattern:e.correctPattern||""}],description:e.prompt};try{Bt.record(r)}catch(n){throw E.emit("interaction:error",{domain:"interaction",operation:"record",message:'Failed to record interaction "'.concat(e.id,'": ').concat(n.message),stack:n.stack,context:{interactionId:e.id}}),n}}function Zn(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return"";var r=['<button type="button" class="btn btn-success" data-action="check-answer" data-interaction="'.concat(e,'" data-testid="').concat(e,'-check-answer">Check Answer</button>'),'<button type="button" class="btn btn-reset" data-action="reset" data-interaction="'.concat(e,'" data-testid="').concat(e,'-reset">Reset</button>')].concat(v(t));return'<div class="flex flex-wrap justify-center gap-3 m-4" data-testid="'.concat(e,'-controls">').concat(r.join(""),"</div>")}function $n(e){return'<div id="'.concat(e,'_feedback" class="feedback" aria-live="polite" data-testid="').concat(e,'-feedback"></div>')}function Xn(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"info";if(!e)throw new Error('Cannot display feedback: container is null for interaction "'.concat(t,'"'));var a=e.querySelector("#".concat(t,"_feedback, .feedback, .overall-feedback"));if(!a)throw new Error('Feedback element not found for interaction "'.concat(t,'"'));var o="correct"===n?"✓":"incorrect"===n?"✗":"";a.innerHTML='<div class="feedback '.concat(n,'">').concat(o," ").concat(r,"</div>")}function ea(e,t){if(e){var r=e.querySelector("#".concat(t,"_feedback, .feedback, .overall-feedback"));r&&(r.innerHTML="")}}function ta(e){return null==e||""===e?null:e}function ra(e){if("undefined"!=typeof CSS&&"function"==typeof CSS.escape)return CSS.escape(e);throw new Error("CSS.escape is not available and is required for safe selector escaping")}function na(e,t){if(!e)throw new Error('Container is null for interaction "'.concat(t,'". Ensure render() was called first.'));if(!(e instanceof Element))throw new Error('Container must be a DOM Element for interaction "'.concat(t,'"'))}function aa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any";if(null==e)return null;if("array"===t&&Array.isArray(e))return e;if("object"===t&&"object"===h(e)&&!Array.isArray(e))return e;if("string"==typeof e){var r=e.trim();if(!r)return null;try{var n=JSON.parse(r);if("array"===t&&!Array.isArray(n))throw new Error("Expected array, got ".concat(h(n)));if("object"===t&&("object"!==h(n)||Array.isArray(n)))throw new Error("Expected object, got ".concat(Array.isArray(n)?"array":h(n)));return n}catch(a){if("array"===t||"object"===t)throw new Error("Failed to parse response as JSON: ".concat(a.message));return r}}return e}function oa(e,t){Ft.register(e,t)}var ia={creator:"createLikertQuestion",scormType:"likert",showCheckAnswer:!0,isAnswered:function(e){return!(!e||"object"!==h(e))&&Object.keys(e).length>0},getCorrectAnswer:function(e){return JSON.stringify(e.correctAnswers||{})},formatCorrectAnswer:function(e,t){if(!t||0===Object.keys(t).length)return'<p class="correct-item">No correct answer (Survey)</p>';var r='<ul class="list-disc pl-4 m-0">',n="string"==typeof t?JSON.parse(t):t;return Object.entries(n).forEach(function(t){var n=a(t,2),o=n[0],i=n[1],s=e.questions.find(function(e){return e.id===o}),c=e.scale.find(function(e){return e.value===i});s&&c&&(r+='<li class="correct-item">'.concat(s.text,": <strong>").concat(c.text,"</strong></li>"))}),r+="</ul>"},formatUserResponse:function(e,t){var r='<ul class="list-disc pl-4 m-0">',n="string"==typeof t?JSON.parse(t):t;return Object.entries(n).forEach(function(t){var n=a(t,2),o=n[0],i=n[1],s=e.questions.find(function(e){return e.id===o}),c=e.scale.find(function(e){return e.value===i});s&&(r+='<li class="response-item">'.concat(s.text,": <strong>").concat(c?c.text:i,"</strong></li>"))}),r+="</ul>"}};function sa(e){Gn(e,["scale","questions"]);var t=e.id,r=e.prompt,n=e.scale,o=e.questions,i=e.correctAnswers,s=e.controlled,c=void 0!==s&&s;if(!Array.isArray(n)||0===n.length)throw new Error('Likert question "'.concat(t,'" must have at least one scale option'));if(!Array.isArray(o)||0===o.length)throw new Error('Likert question "'.concat(t,'" must have at least one question'));var l=null,d={id:t,type:"likert",render:function(a){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;na(a,t),l=a;var s=ta(i),u="object"===h(s)?s:{},p='\n                <div class="interaction likert" data-interaction-id="'.concat(t,'">\n                    <div class="question-prompt">\n                        <h3>').concat(r,'</h3>\n                    </div>\n                    <div class="likert-container">\n                        <table class="likert-table" role="presentation">\n                            <thead>\n                                <tr>\n                                    <th class="likert-header-question">Statement</th>\n            ');n.forEach(function(e){p+='<th class="likert-header-option">'.concat(e.text,"</th>")}),p+="\n                                </tr>\n                            </thead>\n                            <tbody>\n            ",o.forEach(function(e,r){p+='\n                    <tr class="likert-row '.concat(r%2==0?"even":"odd",'" role="radiogroup" aria-labelledby="q-label-').concat(e.id,'">\n                        <td class="likert-question-text" id="q-label-').concat(e.id,'">').concat(e.text,"</td>\n                "),n.forEach(function(r){var n=u[e.id]===r.value,a="likert-".concat(t,"-").concat(e.id,"-").concat(r.value);p+='\n                        <td class="likert-option">\n                            <label for="'.concat(a,'" class="sr-only">').concat(r.text,'</label>\n                            <input type="radio" \n                                   id="').concat(a,'" \n                                   name="likert-').concat(t,"-").concat(e.id,'" \n                                   value="').concat(r.value,'"\n                                   data-question-id="').concat(e.id,'"\n                                   ').concat(n?"checked":"",">\n                        </td>\n                    ")}),p+="</tr>"}),p+="\n                            </tbody>\n                        </table>\n                    </div>\n                    ".concat($n(),"\n                    ").concat(Zn(t,c),"\n                </div>\n            "),a.innerHTML=p,a.addEventListener("click",Jn(d,e))},getResponse:function(){var e={};l&&l.querySelectorAll('input[type="radio"]:checked').forEach(function(t){e[t.dataset.questionId]=t.value});return e},setResponse:function(e){e&&"object"===h(e)&&d.render(l,e)},checkAnswer:function(){var t,r,n={};l.querySelectorAll('input[type="radio"]:checked').forEach(function(e){n[e.dataset.questionId]=e.value}),Object.keys(n).length;var s=o.length,c=!0,d=0;if(i){var u=0;Object.entries(i).forEach(function(e){var t=a(e,2),r=t[0],o=t[1];n[r]!==o?c=!1:u++}),d=u/s}else c=!0,d=1;var p={correct:c,score:d,response:n,feedback:c?(null===(t=e.feedback)||void 0===t?void 0:t.correct)||"Thank you for your feedback.":(null===(r=e.feedback)||void 0===r?void 0:r.incorrect)||"Please review your answers."};return Xn(l,p.correct,p.feedback),p},reset:function(){ea(l),l.querySelectorAll('input[type="radio"]').forEach(function(e){return e.checked=!1})},showHint:function(){}};return d}var ca=null,la={exit:{title:"Exit Course",body:"\n            <p>Are you sure you want to exit the course?</p>\n            <p><strong>Your progress will be saved automatically.</strong> You can resume exactly where you left off when you return.</p>\n        ",footer:'\n            <button class="btn btn-secondary" data-action="close-modal" data-testid="modal-exit-cancel">Cancel</button>\n            <button class="btn btn-primary" data-action="confirm-exit" data-testid="modal-exit-confirm">Exit Course</button>\n        ',config:{closeOnBackdrop:!0,closeOnEscape:!0}},complete:{title:"Course Complete!",body:'\n            <p><strong>Congratulations!</strong> You have successfully completed this course.</p>\n            <p>Your completion status and final score have been recorded in the Learning Management System.</p>\n            <p>When you click "Complete & Exit" below, this window will close and you will be returned to the LMS.</p>\n            '.concat('\n  <div class="completion-feedback-container">\n    <div id="completion-rating-section" class="feedback-section" hidden>\n      <div id="completion-rating-container"></div>\n    </div>\n    <div id="completion-comments-section" class="feedback-section" hidden>\n      <label for="completion-comments-textarea">Leave a comment (optional):</label>\n      <textarea id="completion-comments-textarea" class="feedback-textarea" rows="4" data-testid="completion-comments"></textarea>\n    </div>\n  </div>\n',"\n        "),footer:'\n            <button class="btn btn-secondary" data-action="close-modal" data-testid="modal-complete-cancel">Cancel</button>\n            <button class="btn btn-primary" data-action="confirm-complete" data-testid="modal-complete-confirm">Complete & Exit</button>\n        ',config:{closeOnBackdrop:!0,closeOnEscape:!0}},postExit:{title:"Session Closed",body:"\n            <p>Your progress has been saved in the LMS. It is now safe to close this window.</p>\n            <p>If this window does not close automatically, please close it manually and return to the LMS.</p>\n        ",footer:"",config:{closeOnBackdrop:!1,closeOnEscape:!1}},restart:{title:"Restart Course",body:'\n            <p class="font-bold text-error">Are you sure you want to restart the entire course?</p>\n            <p>This will permanently erase ALL of your progress, including assessment scores and engagement history. This action cannot be undone.</p>\n        ',footer:'\n            <button class="btn btn-secondary" data-action="close-modal" data-testid="modal-restart-cancel">Cancel</button>\n            <button class="btn btn-primary" data-action="confirm-restart" data-testid="modal-restart-confirm">Restart Course</button>\n        ',config:{closeOnBackdrop:!0,closeOnEscape:!0}}};document.getElementById("app");var da=document.getElementById("loading"),ua=document.querySelector('footer[role="contentinfo"]'),pa=ua&&ua.style.display||"",ma=document.getElementById("exitBtn"),ga=ma?ma.innerHTML:"",fa=ma?ma.getAttribute("aria-label"):null,va=ma?ma.getAttribute("title"):null,ha=ma&&ma.dataset.action||"exit-course",ba=document.getElementById("prevBtn"),ya=document.getElementById("nextBtn"),wa=null,xa=null,ka=null;function Sa(){st(),qt(),console.log("AppUI initialized: Dynamic Modal and Notification systems are ready."),function(){if(wa=document.getElementById("sidebar-toggle"),xa=document.getElementById("sidebar"),ka=document.getElementById("sidebar-backdrop"),!wa||!xa)throw new Error("Sidebar toggle elements not found.");wa.addEventListener("click",Ia),ka&&ka.addEventListener("click",Ma);document.addEventListener("keydown",function(e){"Escape"!==e.key||xa.classList.contains("collapsed")||Ma()})}(),console.log("Sidebar toggle initialized."),function(){var e,t=document.getElementById("brand");if(!t)throw new Error("Brand container #brand not found.");var r=_t.branding,n=void 0===r?{}:r,a=n.logo,o=n.logoAlt,i=n.courseTitle||(null===(e=_t.metadata)||void 0===e?void 0:e.title)||"Course",s="";a&&(s+='<img src="'.concat(a,'" alt="').concat(o||n.companyName||"Logo",'" class="logo" />'));s+='<span class="brand-title">'.concat(i,"</span>"),t.innerHTML=s}(),console.log("Branding initialized."),E.on("ui:prepareCompletionModal",function(e){e.promptForComments,e.promptForRating}),E.on("ui:showModal",Aa),E.on("ui:hideModal",Ca),E.on("navigation:changed",function(){Ta()}),E.on("course:statusChanged",function(){Ta()}),E.on("ui:lockCourseForExit",ja),Ta()}function Ea(){da&&(da.style.display="none",kr(!1))}function Aa(e){var t=la[e];if(!t)throw new Error("[AppUI] Modal definition not found for key: ".concat(e));"complete"===e&&(t.onOpen=function(){var e=_t.completion||{},t=document.getElementById("completion-rating-section"),r=document.getElementById("completion-comments-section");t&&e.promptForRating&&(t.hidden=!1,function(){var e=document.getElementById("completion-rating-container");if(!e)return;e.innerHTML="",(ca=sa({id:"course-rating",prompt:"How would you rate this course?",scale:[{value:"1",text:"1 Star"},{value:"2",text:"2 Stars"},{value:"3",text:"3 Stars"},{value:"4",text:"4 Stars"},{value:"5",text:"5 Stars"}],questions:[{id:"overall",text:"Overall Rating"}],feedback:{correct:"Thank you for your rating!"}})).render(e)}()),r&&e.promptForComments&&(r.hidden=!1)}),wr(e),lt(t)}function Ca(){xr(),dt()}function za(e){Lt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3)}function Ia(){var e=xa.classList.toggle("collapsed");Sr(e),wa.setAttribute("aria-expanded",String(!e)),ka&&ka.classList.toggle("visible",!e)}function Ma(){xa.classList.add("collapsed"),Sr(!0),wa.setAttribute("aria-expanded","false"),ka&&ka.classList.remove("visible")}function qa(){ua&&(null==pa&&(pa=""),ua.style.display=pa)}function La(){ua&&(null==pa&&(pa=ua.style.display||""),ua.style.display="none")}function Ta(){return Oa.apply(this,arguments)}function Oa(){return(Oa=u(c().m(function e(){var t,r,n;return c().w(function(e){for(;;)switch(e.n){case 0:if(ma&&!Ir()){e.n=1;break}return e.a(2);case 1:if(An()){e.n=2;break}return e.a(2);case 2:if(t=Yn(),r=Me.getValue("cmi.completion_status")||"incomplete",(n=t&&"completed"===r)!==Ar()){e.n=3;break}return e.a(2);case 3:n?(ma.dataset.action="complete-course",ma.innerHTML='<span aria-hidden="true">✅</span> Complete Course',ma.setAttribute("aria-label","Complete Course"),ma.setAttribute("title","Complete the course and return to the LMS"),Er(!0),Cr("complete")):(ma.dataset.action=ha,ma.innerHTML=ga,fa?ma.setAttribute("aria-label",fa):ma.removeAttribute("aria-label"),va?ma.setAttribute("title",va):ma.removeAttribute("title"),Er(!1),Cr("exit"));case 4:return e.a(2)}},e)}))).apply(this,arguments)}function ja(){zr(!0),Er(!1),Mr(!0),ma&&(ma.removeAttribute("data-action"),ma.textContent="Course Complete",ma.disabled=!0),ba&&(ba.disabled=!0),ya&&(ya.disabled=!0),wa&&(wa.disabled=!0),Ma(),Ca(),Aa("postExit")}function _a(e,t,r){if(!e||!e.id)throw new Error("[AssessmentUI] config with id is required");var n=e.settings,a=e.review,o=e.resultsDisplay;function s(){var r=t.getSummary(),a=(null==r?void 0:r.attempts)||0,o=n.attemptsBeforeRemedial,i=n.attemptsBeforeRestart,s="";if(a>0)if(i&&a>=i)s=" | <strong>Attempts:</strong> ".concat(a," (course retake is required)");else if(o&&a>=o)if(i){var c=i-a;s=" | <strong>Attempts:</strong> ".concat(a," (").concat(c," before a course retake will be required)")}else s=" | <strong>Attempts:</strong> ".concat(a);else if(o){var l=o-a;s=" | <strong>Attempts:</strong> ".concat(a," (").concat(l," before additional review will be required)")}else if(i){var d=i-a;s=" | <strong>Attempts:</strong> ".concat(a," (").concat(d," before a course retake will be required)")}else s=" | <strong>Attempts:</strong> ".concat(a);var u=document.createElement("div");return u.className="content-medium stack-lg",u.innerHTML='\n        <div class="card no-hover text-center stack-md">\n            <h1 class="text-2xl font-bold">'.concat(e.title||"Assessment",'</h1>\n            <div class="bg-gray-50 border rounded p-4 text-sm">\n                <p class="m-0"><strong>Questions:</strong> ').concat(e.questions.length," | <strong>Passing Score:</strong> ").concat(n.passingScore,"%").concat(s,'</p>\n            </div>\n            <div class="d-flex justify-center">\n                <button data-action="start" class="btn btn-primary btn-lg" data-testid="assessment-start">Start Assessment</button>\n            </div>\n        </div>\n    '),u}function c(){var a=t.getCurrentQuestionIndex(),o=r[a];if(!o){var i="[AssessmentUI:".concat(e.id,"] Question instance not found for index ").concat(a," (assessment has ").concat(r.length," questions)");throw E.emit("assessment:error",i),new Error(i)}var s=document.createElement("div");s.className="content-medium";var c=document.createElement("div");c.className="card no-hover stack-md";var l=document.createElement("h1");if(l.className="text-xl font-bold m-0",l.textContent=e.title||"Assessment",c.appendChild(l),n.showProgress){var d=document.createElement("p");d.className="text-muted text-sm m-0",d.textContent="Question ".concat(a+1," of ").concat(e.questions.length),c.appendChild(d)}var u=document.createElement("div");o.render(u),o.restoreFromSCORM(),c.appendChild(u);var p=function(){var r=document.createElement("div"),a=t.getCurrentQuestionIndex(),o=0===a,i=a===e.questions.length-1,s=t.getSession(),c=(null==s?void 0:s.reviewReached)||!1,l='<button class="btn btn-secondary" data-action="prev" data-testid="assessment-nav-prev" '.concat(o?"disabled":"",">Previous</button>"),d=i?n.allowReview?"Review":"Submit":"Next",u='<button class="btn btn-primary" data-action="next" data-testid="assessment-nav-next">'.concat(d,"</button>"),p=c&&n.allowReview?'<button class="btn btn-secondary" data-action="jump-to-review" data-testid="assessment-jump-to-review">Jump to Review</button>':"",m="";n.showProgress&&(m='<span class="text-sm text-muted">Question '.concat(a+1," / ").concat(e.questions.length,"</span>"));return r.innerHTML="".concat(l).concat(m,'<div class="d-flex gap-2">').concat(p).concat(u,"</div>"),r}();return p.className="d-flex justify-between items-center mt-6 pt-4 border-top",c.appendChild(p),s.appendChild(c),s}function l(){var n=document.createElement("div");n.className="content-medium";var o=t.getSession();if(!o)throw new Error("Assessment '".concat(e.id,"' has no session - state corrupted"));var i=o.responses||{},s=e.questions.every(function(e,t){return r[t].metadata.isAnswered(i[t])}),c=e.questions.map(function(e,t){var n=i[t],a=r[t].metadata.isAnswered(n),o=a?"bg-success text-white":"bg-gray-200 text-muted",s=a?"Answered":"Not Answered",c=e.prompt||e.questionText||"Question",l=c.length>60?c.substring(0,60)+"...":c;return'\n        <li class="d-flex justify-between items-center p-3 bg-gray-50 rounded">\n          <div class="d-flex items-center gap-3 flex-1">\n            <span class="font-bold text-muted">Q'.concat(t+1,'</span>\n            <span class="text-sm">').concat(l,'</span>\n          </div>\n          <div class="d-flex items-center gap-3">\n            <span class="text-xs px-2 py-1 rounded ').concat(o,'">').concat(s,'</span>\n            <button class="btn btn-sm btn-outline-secondary" data-action="review-question" data-question-index="').concat(t,'" data-testid="assessment-review-question-').concat(t,'">Edit</button>\n          </div>\n        </li>\n      ')}).join("");return n.innerHTML='\n      <div class="card no-hover stack-md">\n        <div>\n            <h2 class="text-xl font-bold m-0">Review Your Answers</h2>\n            <p class="text-muted m-0">Please review your answers before submitting the assessment.</p>\n        </div>\n        \n        <ul class="list-none stack-sm m-0 p-0">'.concat(c,"</ul>\n        \n        ").concat(!s&&a.requireAllAnswered?'<div class="callout callout-error">You must answer all questions before submitting.</div>':"",'\n        \n        <div class="d-flex justify-between mt-4 pt-4 border-top">\n          <button class="btn btn-secondary" data-action="back-to-questions" data-testid="assessment-back-to-questions">Back to Questions</button>\n          <button class="btn btn-primary" data-action="submit" data-testid="assessment-submit" ').concat(!s&&a.requireAllAnswered?"disabled":"",">Submit Assessment</button>\n        </div>\n      </div>\n    "),n}function d(t){if(!t){var n=document.createElement("div");return n.textContent="No results to display.",n}var a=document.createElement("div");a.className="content-medium";var i=t.totalQuestions,s=t.correctCount,c=t.scorePercentage,l=t.passed,d=t.details,u="";o.showQuestions&&d&&(u=d.map(function(t,n){if(!t)return"";var a=e.questions[n],i=t.correct,s=i?"text-success":"text-error",c=i?"✔":"✖",l=i?"bg-green-50":"bg-red-50",d=a.prompt||a.questionText||"Question ".concat(n+1),u=r[n].metadata,p="";if(o.showUserResponses&&null!==t.response&&void 0!==t.response&&(p+='<div class="mt-2 p-3 bg-gray-50 rounded"><p class="text-xs font-bold text-muted uppercase mb-2 mt-0">Your Answer</p><div class="text-sm">'.concat(u.formatUserResponse(a,t.response),"</div></div>")),i&&o.showCorrectAnswers||!i&&o.showIncorrectAnswers){var m=u.getCorrectAnswer(a);p+='<div class="mt-2 p-3 bg-green-50 rounded"><p class="text-xs font-bold text-success uppercase mb-2 mt-0">Correct Answer</p><div class="text-sm">'.concat(u.formatCorrectAnswer(a,m),"</div></div>")}return'\n          <li class="p-4 rounded '.concat(l,'">\n            <div class="d-flex gap-3 items-start">\n              <span class="font-bold text-muted">Q').concat(n+1,'</span>\n              <div class="flex-1 stack-sm">\n                <div class="d-flex justify-between">\n                    <span class="font-semibold">').concat(d,"</span>\n                    ").concat(o.showCorrectness?'<span class="'.concat(s,' font-bold">').concat(c,"</span>"):"","\n                </div>\n                ").concat(p,"\n              </div>\n            </div>\n          </li>\n        ")}).join(""));var p="";if(t.actionButton){var m=t.actionButton,g="";if(m.message){var f="callout callout-".concat(m.messageType||"info"),v="restart"===m.type?"Maximum Attempts Reached":"Review Recommended";g='\n                    <div class="'.concat(f,'">\n                        <p class="font-bold">').concat(v,"</p>\n                        <p>").concat(m.message,"</p>\n                    </div>\n                ")}var h="";m.attemptsMessage&&(h='<p class="text-muted mt-2 text-sm text-center">'.concat(m.attemptsMessage,"</p>")),p='\n                <div class="stack-md mt-6 pt-4 border-top">\n                    '.concat(g,'\n                    <div class="d-flex justify-center">\n                        <button data-action="').concat(m.action,'" class="btn btn-primary btn-lg" data-testid="assessment-').concat(m.action,'">\n                            ').concat(m.label,"\n                        </button>\n                    </div>\n                    ").concat(h,"\n                </div>\n            ")}return a.innerHTML='\n      <div class="card no-hover stack-lg">\n        <div class="text-center stack-sm">\n            <h2 class="text-2xl font-bold m-0">Assessment Results</h2>\n            <p class="text-xl '.concat(l?"text-success":"text-error",' font-bold m-0">').concat(l?"Passed":"Failed",'</p>\n        </div>\n\n        <div class="cols-3 gap-4">\n            <div class="p-3 bg-gray-50 rounded text-center border">\n                <div class="text-xs font-bold text-muted uppercase">Score</div>\n                <div class="text-xl font-bold">').concat(c.toFixed(0),'%</div>\n            </div>\n            <div class="p-3 bg-gray-50 rounded text-center border">\n                <div class="text-xs font-bold text-muted uppercase">Correct</div>\n                <div class="text-xl font-bold">').concat(s," / ").concat(i,'</div>\n            </div>\n            <div class="p-3 bg-gray-50 rounded text-center border">\n                <div class="text-xs font-bold text-muted uppercase">Time</div>\n                <div class="text-xl font-bold">').concat(t.timeSpent||"--:--","</div>\n            </div>\n        </div>\n\n        ").concat(u?'<ul class="list-none stack-sm m-0 p-0">'.concat(u,"</ul>"):"","\n        ").concat(p,"\n      </div>\n    "),a}return{initialize:function(e){var t=Rt(e,"assessment");return t.registerView("intro",{render:s}),t.registerView("question",{render:c}),t.registerView("review",{render:l}),t.registerView("results",{render:d}),t},showUnansweredModal:function(e,t,r){return function(e,t,r){var n=e.length,a=1===n?"question":"questions",o=e.map(function(e){return e+1}).join(", "),s=null;lt(i(i({},t?{title:"Unanswered Questions",body:'\n            <p class="mb-3">You have <strong>'.concat(n," unanswered ").concat(a,"</strong> (").concat(o,').</p>\n            <p class="mb-3">Unanswered questions will be marked as incorrect.</p>\n            <p class="font-bold">Do you want to submit anyway?</p>\n        '),footer:'\n            <button class="btn btn-secondary" data-action="dismiss-unanswered-modal" data-testid="modal-unanswered-cancel">Go Back</button>\n            <button class="btn btn-primary" data-action="confirm-unanswered-submit" data-testid="modal-unanswered-confirm">Submit Anyway</button>\n        '}:{title:"All Questions Required",body:'\n            <p class="mb-3">You must answer all questions before submitting.</p>\n            <p class="mb-3">You have <strong>'.concat(n," unanswered ").concat(a,"</strong> (").concat(o,').</p>\n            <p class="font-bold">Please go back and complete all questions.</p>\n        '),footer:'\n            <button class="btn btn-primary" data-action="dismiss-unanswered-modal" data-testid="modal-unanswered-dismiss">Go Back</button>\n        '}),{},{config:{closeOnBackdrop:!0,closeOnEscape:!0},onOpen:function(){var e=document.getElementById("global-modal");e&&(s=function(e){var n=e.target.closest("[data-action]");if(n){var a=n.dataset.action;"confirm-unanswered-submit"===a&&t?(dt(),r()):"dismiss-unanswered-modal"===a&&dt()}},e.addEventListener("click",s))},onClose:function(){var e=document.getElementById("global-modal");e&&s&&e.removeEventListener("click",s)}}))}(e,t,r)}}}var Ra={creator:"createMultipleChoiceQuestion",scormType:"choice",showCheckAnswer:!0,isAnswered:function(e){return Array.isArray(e)&&e.length>0},getCorrectAnswer:function(e){return e.multiple?JSON.stringify(e.choices.filter(function(e){return e.correct}).map(function(e){return e.value})):e.correctAnswer||""},formatCorrectAnswer:function(e,t){var r='<ul class="list-disc pl-4 m-0">',n=Array.isArray(t)?t:[t],a=e.choices||[];return n.forEach(function(e){var t=a.find(function(t){return t.value===e||t.correct});r+='<li class="correct-item">'.concat(t?t.text:e,"</li>")}),r+="</ul>"},formatUserResponse:function(e,t){var r='<ul class="list-disc pl-4 m-0">',n=Array.isArray(t)?t:[t],a=e.choices||[];return n.forEach(function(e){var t=a.find(function(t){return t.value===e});r+='<li class="response-item">'.concat(t?t.text:e,"</li>")}),r+="</ul>"}};function Da(e){Gn(e,["choices"]);var t=e.id,r=e.prompt,n=e.choices,a=e.correctAnswer,o=e.multiple,s=void 0!==o&&o,c=e.controlled,l=void 0!==c&&c;if(!Array.isArray(n)||0===n.length)throw new Error('Multiple choice question "'.concat(t,'" must have at least one choice'));if(!s&&!a)throw new Error('Single-select multiple choice question "'.concat(t,'" must have correctAnswer defined'));var d=null,u={id:t,type:s?"multiple-choice-multiple":"multiple-choice-single",render:function(o){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;na(o,t),d=o;var p=ta(c),m=Array.isArray(p)?p:p?[p]:[],g='\n                <div class="interaction multiple-choice" data-interaction-id="'.concat(t,'">\n                    <div class="question-prompt">\n                        <h3>').concat(r,'</h3>\n                    </div>\n                    <div class="').concat(s?"checkbox-group":"radio-group",'">\n            ');if(n.forEach(function(e,r){var n=s?"checkbox":"radio",a="".concat(t,"_choice_").concat(r),o=s?"checkbox-option":"radio-option",i=s?"checkbox-custom":"radio-custom",c=s?"checkbox-label":"radio-label",l=m.includes(e.value);g+='\n                    <label class="'.concat(o,'" role="option" aria-selected="').concat(l,'">\n                        <input\n                          type="').concat(n,'"\n                          id="').concat(a,'"\n                          name="').concat(t,'_choice"\n                          value="').concat(e.value,'"\n                          ').concat(e.correct?'data-correct="true"':"","\n                          ").concat(l?"checked":"",'\n                          aria-describedby="').concat(t,"_feedback ").concat(a,'_description"\n                          aria-label="').concat(e.text,'"\n                          tabindex="0"\n                          data-testid="').concat(t,"-choice-").concat(r,'"\n                        />\n                        <span class="').concat(i,'"></span>\n                        <div class="').concat(c,'">\n                          ').concat(e.text,"\n                          ").concat(e.description?'<div id="'.concat(a,'_description" class="radio-description">').concat(e.description,"</div>"):"","\n                        </div>\n                    </label>\n                ")}),g+="\n                    </div>\n                    ".concat(Zn(t,l),"\n                    ").concat($n(t),"\n                </div>\n            "),o.innerHTML=g,function(e,t){var r=e.querySelectorAll('input[type="radio"], input[type="checkbox"]');r.forEach(function(r){r.addEventListener("change",function(){return Na(e)}),r.addEventListener("keydown",function(n){"Enter"!==n.key&&" "!==n.key||(n.preventDefault(),"multiple-choice-multiple"===t.type?r.checked=!r.checked:r.checked=!0,Na(e),r.dispatchEvent(new Event("change")))})}),Na(e)}(o,u),!l){var f=s?JSON.stringify(n.filter(function(e){return e.correct}).map(function(e){return e.value})):a;o.addEventListener("click",Jn(u,i(i({},e),{},{scormType:"choice",correctPattern:f})))}},evaluate:function(e){if(!e||!Array.isArray(e)||0===e.length)return!s||n.filter(function(e){return e.correct}).map(function(e){return e.value}),{score:0,correct:!1,response:s?JSON.stringify([]):"",error:"No answer selected"};if(s){var t=n.filter(function(e){return e.correct}).map(function(e){return e.value}),r=t.every(function(t){return e.includes(t)})&&e.every(function(e){return t.includes(e)});return{score:r?1:e.filter(function(e){return t.includes(e)}).length/t.length,correct:r,response:JSON.stringify(e)}}var o=1===e.length&&e[0]===a;return{score:o?1:0,correct:o,response:e[0]||""}},checkAnswer:function(){na(d,t);var e=d.querySelectorAll('input[type="radio"], input[type="checkbox"]'),r=Array.from(e).filter(function(e){return e.checked}).map(function(e){return e.value});if(0===r.length){var o="Please select an answer before checking.";return Xn(d,t,o,"error"),Oe.announce(o,"assertive"),null}var i=u.evaluate(r);if(i.correct){var c="Correct! Well done.";Xn(d,t,c,"correct"),Oe.announce(c)}else{var l,p=r.map(function(e){var t;return(null===(t=n.find(function(t){return t.value===e}))||void 0===t?void 0:t.text)||e}).join(", "),m=s?n.filter(function(e){return e.correct}).map(function(e){return e.text}).join(", "):(null===(l=n.find(function(e){return e.value===a}))||void 0===l?void 0:l.text)||a,g="Incorrect. You selected: ".concat(p,". Expected: ").concat(m);Xn(d,t,g,"incorrect"),Oe.announce(g)}return i},reset:function(){na(d,t);var e=d.querySelectorAll('input[type="radio"], input[type="checkbox"]'),r=d.querySelectorAll(".radio-option, .checkbox-option");e.forEach(function(e){e.checked=!1,e.setAttribute("aria-checked","false")}),r.forEach(function(e){e.setAttribute("aria-selected","false"),e.classList.remove("selected")}),ea(d,t),Oe.announce("Question reset. All selections cleared.")},setResponse:function(e){na(d,t);var r=Array.isArray(e)?e:e?[e]:[],n=d.querySelectorAll('input[type="radio"], input[type="checkbox"]');if(0===n.length)throw new Error('No input elements found for multiple choice question "'.concat(t,'"'));n.forEach(function(e){e.checked=r.includes(e.value)}),Na(d)},getResponse:function(){na(d,t);var e=d.querySelectorAll('input[type="radio"]:checked, input[type="checkbox"]:checked');return Array.from(e).map(function(e){return e.value})},getCorrectAnswer:function(){return s?n.filter(function(e){return e.correct}).map(function(e){return e.value}):a}};return l||oa(e,u),u}function Na(e){e.querySelectorAll(".radio-option, .checkbox-option").forEach(function(e){var t=e.querySelector("input");if(t){var r=t.checked;e.setAttribute("aria-selected",r.toString()),r?e.classList.add("selected"):e.classList.remove("selected")}})}var Pa={creator:"createTrueFalseQuestion",scormType:"true-false",showCheckAnswer:!0,isAnswered:function(e){return null!=e},getCorrectAnswer:function(e){return e.correctAnswer.toString()},formatCorrectAnswer:function(e,t){return'<p class="correct-item">'.concat(t,"</p>")},formatUserResponse:function(e,t){return'<p class="response-item">'.concat(t,"</p>")}};function Ba(e){Gn(e,["correctAnswer"]);var t=e.id,r=e.prompt,n=e.correctAnswer,a=e.controlled,o=void 0!==a&&a,s=e.autoCheck,c=void 0!==s&&s,l=e.feedback,d=void 0===l?{}:l,u=null,p={id:t,type:"true-false",render:function(a){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;na(a,t),u=a;var l=ta(s),d='\n                <div class="interaction true-false" data-interaction-id="'.concat(t,'">\n                    <div class="question-prompt">\n                        <h3>').concat(r,'</h3>\n                    </div>\n                    <div class="true-false-options">\n                        <label>\n                            <input type="radio" name="').concat(t,'_choice" value="true" ').concat("true"===l?"checked":"",' data-testid="').concat(t,'-choice-true"> True\n                        </label>\n                        <label>\n                            <input type="radio" name="').concat(t,'_choice" value="false" ').concat("false"===l?"checked":"",' data-testid="').concat(t,'-choice-false"> False\n                        </label>\n                    </div>\n                    ').concat(c?"":Zn(t,o),"\n                    ").concat($n(t),"\n                </div>\n            ");(a.innerHTML=d,o||a.addEventListener("click",Jn(p,i(i({},e),{},{scormType:"true-false",correctPattern:n.toString()}))),c&&!o)&&a.querySelectorAll('input[name="'.concat(t,'_choice"]')).forEach(function(e){e.addEventListener("change",function(){var e=p.checkAnswer();if(e){var r=Fe();r&&Qe.trackInteraction(r,t,!0,e.correct)}e&&!e.correct&&setTimeout(function(){p.reset()},2e3)})})},evaluate:function(e){if(null==e||""===e)return{score:0,correct:!1,response:"",error:"No answer provided"};var t=e===n.toString();return{score:t?1:0,correct:t,response:e}},checkAnswer:function(){na(u,t);var e=u.querySelector('input[name="'.concat(t,'_choice"]:checked'));if(!e)return Xn(u,t,"Please select an answer.","error"),null;var r=e.value,a=p.evaluate(r),o=e.closest("label");if(a.correct){var i=d.correct||"Correct! The answer is ".concat(n,".");Xn(u,t,i,"correct"),o&&(o.classList.add("answer-correct"),o.classList.remove("answer-incorrect"))}else{var s=d.incorrect||"Incorrect. The correct answer is ".concat(n,".");Xn(u,t,s,"incorrect"),o&&(o.classList.add("answer-incorrect"),o.classList.remove("answer-correct"))}return a},reset:function(){na(u,t);var e=u.querySelectorAll('input[name="'.concat(t,'_choice"]')),r=u.querySelectorAll(".true-false-options label");e.forEach(function(e){e.checked=!1}),r.forEach(function(e){e.classList.remove("answer-correct","answer-incorrect")}),ea(u,t)},setResponse:function(e){if(na(u,t),null!=e){var r=u.querySelector('input[name="'.concat(t,'_choice"][value="').concat(e,'"]'));if(!r)throw new Error('Invalid response value "'.concat(e,'" for true-false question "').concat(t,'". Must be "true" or "false".'));r.checked=!0}},getResponse:function(){na(u,t);var e=u.querySelector('input[name="'.concat(t,'_choice"]:checked'));return e?e.value:null},getCorrectAnswer:function(){return n.toString()}};return o||oa(e,p),p}var Fa={creator:"createFillInQuestion",scormType:"fill-in",showCheckAnswer:!0,isAnswered:function(e){return!(!e||"object"!==h(e))&&Object.values(e).some(function(e){return e&&String(e).trim().length>0})},getCorrectAnswer:function(e){return e.blanks&&Array.isArray(e.blanks)?JSON.stringify(e.blanks.map(function(e){return e.correct})):""},formatCorrectAnswer:function(e,t){var r="";return e.blanks?(r+='<ul class="list-disc pl-4 m-0">',e.blanks.forEach(function(e){r+='<li class="correct-item">'.concat(e.correct,"</li>")}),r+="</ul>"):r+='<p class="correct-item">'.concat(t,"</p>"),r},formatUserResponse:function(e,t){var r='<ul class="list-disc pl-4 m-0">',n=aa(t,"object")||{};return Object.entries(n).forEach(function(e){var t=a(e,2),n=(t[0],t[1]);r+='<li class="response-item">'.concat(n,"</li>")}),r+="</ul>"}};function Va(e){Gn(e,["blanks"]);var t=e.id,r=e.prompt,n=e.blanks,a=e.feedback,o=e.caseSensitive,s=void 0!==o&&o,c=e.controlled,l=void 0!==c&&c;if(!Array.isArray(n)||0===n.length)throw new Error('Fill-in question "'.concat(t,'" must have at least one blank'));var d=null,u={id:t,type:"fill-in",render:function(o){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;na(o,t),d=o;var p=ta(c),m=p&&"object"===h(p)?p:{},g='\n                <div class="interaction fill-in" data-interaction-id="'.concat(t,'">\n                    <div class="question-prompt">\n                        <h3>').concat(r,'</h3>\n                    </div>\n                    <div class="fill-in-container">\n            ');if(n.forEach(function(e,r){var n="".concat(t,"_blank_").concat(r),a=m[n]||"";g+='\n                    <div class="fill-in-item">\n                        <label for="'.concat(t,"_blank_").concat(r,'">').concat(e.label||"Blank ".concat(r+1,":"),'</label>\n                        <input\n                          type="text"\n                          id="').concat(t,"_blank_").concat(r,'"\n                          name="').concat(n,'"\n                          placeholder="').concat(e.placeholder||"",'"\n                          value="').concat(a,'"\n                          data-correct="').concat(e.correct,'"\n                          data-case-sensitive="').concat(s,'"\n                          aria-describedby="').concat(t,"_feedback_").concat(r,'"\n                          data-testid="').concat(t,"-blank-").concat(r,'"\n                        />\n                        <div id="').concat(t,"_feedback_").concat(r,'" class="feedback" aria-live="polite"></div>\n                    </div>\n                ')}),g+="\n                    </div>\n                    ".concat(Zn(t,l,a?['<button type="button" class="btn btn-info" data-action="show-hint" data-interaction="'.concat(t,'">Show Hint</button>')]:[]),'\n                    <div class="overall-feedback" id="').concat(t,'_overall_feedback" aria-live="polite"></div>\n                </div>\n            '),o.innerHTML=g,!l){var f=JSON.stringify(n.map(function(e){return e.correct}));o.addEventListener("click",Jn(u,i(i({},e),{},{scormType:"fill-in",correctPattern:f}),{"show-hint":function(){return u.showHint()}}))}},evaluate:function(e){if(!e||"object"!==h(e))return{score:0,correct:!1,results:n.map(function(e){return{response:"",correct:!1,expected:e.correct}}),response:JSON.stringify({}),error:"Invalid response format"};var r=0,a=n.map(function(n,a){var o="".concat(t,"_blank_").concat(a),i=e[o]||"",c=s?i===n.correct:i.toLowerCase()===n.correct.toLowerCase();return c&&r++,{response:i,correct:c,expected:n.correct}});return{score:r/n.length,correct:r===n.length,results:a,response:JSON.stringify(e)}},checkAnswer:function(){na(d,t);var e=d.querySelectorAll('input[type="text"]');if(0===e.length)throw new Error('No input elements found for fill-in question "'.concat(t,'"'));var r={};return e.forEach(function(e){r[e.name]=e.value.trim();var t=e.dataset.correct,n="true"===e.dataset.caseSensitive,a=d.querySelector("#".concat(e.getAttribute("aria-describedby"))),o=n?e.value.trim()===t:e.value.trim().toLowerCase()===t.toLowerCase();a&&(o?(a.textContent="✓ Correct!",a.className="feedback correct",e.classList.add("correct"),e.classList.remove("incorrect")):(a.textContent="✗ Incorrect. Expected: ".concat(t),a.className="feedback incorrect",e.classList.add("incorrect"),e.classList.remove("correct")))}),u.evaluate(r)},reset:function(){na(d,t),d.querySelectorAll('input[type="text"]').forEach(function(e){e.value="",e.classList.remove("correct","incorrect")}),d.querySelectorAll(".feedback").forEach(function(e){e.innerHTML="",e.className="feedback"});var e=d.querySelector(".overall-feedback");e&&(e.innerHTML="")},showHint:function(){if(na(d,t),a){var e=d.querySelector(".overall-feedback");if(!e)throw new Error('Overall feedback element not found for fill-in question "'.concat(t,'"'));e.innerHTML='<div class="hint">'.concat(a,"</div>")}},setResponse:function(e){na(d,t);var r=aa(e,"object");if(r){if(0===d.querySelectorAll('input[type="text"]').length)throw new Error('No input elements found for fill-in question "'.concat(t,'"'));Object.keys(r).forEach(function(e){var t=d.querySelector('input[name="'.concat(CSS.escape(e),'"]'));t&&(t.value=r[e])})}},getResponse:function(){if(!d){var e={};return n.forEach(function(r,n){e["".concat(t,"_blank_").concat(n)]=""}),e}var r={},a=d.querySelectorAll('input[type="text"]');if(0===a.length)throw new Error('No input elements found for fill-in question "'.concat(t,'"'));return a.forEach(function(e){r[e.name]=e.value.trim()}),r},getCorrectAnswer:function(){return n.map(function(e){return e.correct})}};return l||oa(e,u),u}var Ha={creator:"createMatchingQuestion",scormType:"matching",showCheckAnswer:!0,isAnswered:function(e){return!(!e||"object"!==h(e))&&(Object.keys(e).length>0&&Object.values(e).some(function(e){return e&&String(e).trim().length>0}))},getCorrectAnswer:function(e){return e.pairs&&Array.isArray(e.pairs)?JSON.stringify(e.pairs.reduce(function(e,t){return e[t.id]=t.match,e},{})):""},formatCorrectAnswer:function(e,t){var r="";return e.pairs&&Array.isArray(e.pairs)?(r+='<ul class="list-disc pl-4 m-0">',e.pairs.forEach(function(e){var t=e.match||"";r+='<li class="correct-item">'.concat(e.text," → ").concat(t,"</li>")}),r+="</ul>"):r+='<p class="correct-item">'.concat(t,"</p>"),r},formatUserResponse:function(e,t){var r="";try{var n="string"==typeof t?JSON.parse(t):t;e.pairs&&Array.isArray(e.pairs)?(r+='<ul class="list-disc pl-4 m-0">',e.pairs.forEach(function(e){var t=n[e.id]||"(not matched)";r+='<li class="response-item">'.concat(e.text," → ").concat(t,"</li>")}),r+="</ul>"):r+='<p class="response-item">'.concat(JSON.stringify(n),"</p>")}catch(a){r+='<p class="response-item">'.concat(t,"</p>")}return r}};function Ua(e){Gn(e,["pairs"]);var t=e.id,r=e.prompt,n=e.pairs,o=e.controlled,s=void 0!==o&&o,c=e.feedbackMode,l=void 0===c?"deferred":c;if(!Array.isArray(n)||0===n.length)throw new Error('Matching question "'.concat(t,'" must have at least one pair'));n.forEach(function(e,r){if(!e.id||!e.text||!e.match)throw new Error('Matching question "'.concat(t,'" pair at index ').concat(r," must have id, text, and match properties"))});var d=null,u=null,p=["#9333ea","#ec4899","#f59e0b","#3b82f6","#6366f1","#8b5cf6","#06b6d4","#14b8a6"],m={id:t,type:"matching",pairs:n,feedbackMode:l,render:function(a){na(a,t),d=a;var o=n.map(function(e){return{id:e.id,match:e.match}});!function(e){for(var t=e.length-1;t>0;t--){var r=Math.floor(Math.random()*(t+1)),n=[e[r],e[t]];e[t]=n[0],e[r]=n[1]}}(o),u={items:n.map(function(e){return{id:e.id,text:e.text}}),matches:o,correctAnswers:n.reduce(function(e,t){return e[t.id]=t.match,e},{})};var c="immediate"===l?"Click an item on the left, then its correct match on the right.":"Click an item on the left, then click its match on the right.",g='\n                <div class="interaction matching-interaction '.concat("immediate"===l?"matching-immediate":"matching-deferred",'" data-interaction-id="').concat(t,'" data-feedback-mode="').concat(l,'">\n                    <div class="question-prompt">\n                        <h3>').concat(r,'</h3>\n                        <p class="matching-instruction">').concat(c,'</p>\n                    </div>\n                    <div class="matching-container">\n                        <div class="matching-column matching-items">\n                            <h4 class="matching-column-header">Items</h4>\n                            <div class="matching-list">\n            ');if(n.forEach(function(e){g+='\n                    <button type="button" \n                            class="matching-item" \n                            data-item-id="'.concat(e.id,'" \n                            data-testid="').concat(t,"-match-item-").concat(e.id,'"\n                            aria-label="Match item: ').concat(e.text,'">\n                        <span class="matching-item-text">').concat(e.text,"</span>\n                        ").concat("immediate"===l?'<span class="matching-feedback-icon" aria-hidden="true"></span>':"","\n                    </button>\n                ")}),g+='\n                            </div>\n                        </div>\n                        <div class="matching-column matching-targets">\n                            <h4 class="matching-column-header">Matches</h4>\n                            <div class="matching-list">\n            ',o.forEach(function(e){g+='\n                    <button type="button" \n                            class="matching-target" \n                            data-match-id="'.concat(e.id,'" \n                            data-testid="').concat(t,"-match-target-").concat(e.id,'"\n                            aria-label="Match target: ').concat(e.match,'">\n                        <span class="matching-target-text">').concat(e.match,"</span>\n                        ").concat("deferred"===l?'<span class="matching-connection-indicator" aria-hidden="true"></span>':"","\n                    </button>\n                ")}),g+="\n                            </div>\n                        </div>\n                    </div>\n                    ".concat("deferred"===l?Zn(t,s):"","\n                    ").concat($n(t),"\n                </div>\n            "),a.innerHTML=g,function(e,t,r,n,a){e._matchingState={matches:{},selectedItem:null,selectedTarget:null,pairsData:r,colorIndex:0},e.addEventListener("click",function(t){var o=e._matchingState,i=t.target.closest(".matching-item");if(i&&!i.disabled)return o.selectedTarget?void Wa(e,o,i,o.selectedTarget,r,n,a):void function(e,t,r,n,a){if(r.classList.contains("matched"))return void function(e,t,r){var n=r.dataset.itemId,a=t.matches[n];if(!a)return;var o=Array.from(e.querySelectorAll(".matching-target")).find(function(e){var t;return(null===(t=e.querySelector(".matching-target-text"))||void 0===t?void 0:t.textContent.trim())===a});o&&(o.classList.remove("matched","correct"),o.style.removeProperty("--pair-color"));r.classList.remove("matched","correct"),r.style.removeProperty("--pair-color"),delete t.matches[n]}(e,t,r);if(t.selectedItem=r,t.selectedTarget=null,"deferred"===n&&a){var o=a[t.colorIndex%a.length];r.style.setProperty("--selection-color",o)}e.querySelectorAll(".matching-item").forEach(function(e){e.classList.remove("selected"),e!==r&&e.style.removeProperty("--selection-color")}),e.querySelectorAll(".matching-target").forEach(function(e){e.classList.remove("selected"),e.style.removeProperty("--selection-color")}),r.classList.add("selected")}(e,o,i,n,a);var s=t.target.closest(".matching-target");if(s&&!s.disabled){if(o.selectedItem)return void Wa(e,o,o.selectedItem,s,r,n,a);if(s.classList.contains("matched"))return void function(e,t,r){var n=r.querySelector(".matching-target-text").textContent.trim(),a=Object.keys(t.matches).find(function(e){return t.matches[e]===n});if(!a)return;var o=e.querySelector('.matching-item[data-item-id="'.concat(ra(a),'"]'));o&&(o.classList.remove("matched","correct"),o.style.removeProperty("--pair-color"));r.classList.remove("matched","correct"),r.style.removeProperty("--pair-color"),delete t.matches[a]}(e,o,s);!function(e,t,r,n,a){if(t.selectedTarget=r,t.selectedItem=null,"deferred"===n&&a){var o=a[t.colorIndex%a.length];r.style.setProperty("--selection-color",o)}e.querySelectorAll(".matching-item").forEach(function(e){e.classList.remove("selected"),e.style.removeProperty("--selection-color")}),e.querySelectorAll(".matching-target").forEach(function(e){e.classList.remove("selected"),e!==r&&e.style.removeProperty("--selection-color")}),r.classList.add("selected")}(e,o,s,n,a)}}),e.addEventListener("keydown",function(e){if("Enter"===e.key||" "===e.key){e.preventDefault();var t=e.target;(t.classList.contains("matching-item")||t.classList.contains("matching-target"))&&t.click()}})}(a,0,u,l,p),!s&&"deferred"===l){var f=JSON.stringify(u.correctAnswers);a.addEventListener("click",Jn(m,i(i({},e),{},{scormType:"matching",correctPattern:f})))}},evaluate:function(e){if(!e||"object"!==h(e))return{score:0,correct:!1,results:[],response:JSON.stringify({}),error:"Invalid matches format"};var t=0,r=[];return n.forEach(function(n){var a=e[n.id],o=n.match,i=a&&o&&a.trim()===o.trim();i&&t++,r.push({itemId:n.id,userAnswer:a||null,correctAnswer:n.match,correct:i})}),{score:t/n.length,correct:t===n.length,results:r,response:JSON.stringify(e)}},checkAnswer:function(){na(d,t);var r,n=m.getResponse(),a=m.evaluate(n);if("deferred"===l&&(r=d,a.results.forEach(function(e){var t=r.querySelector('.matching-item[data-item-id="'.concat(ra(e.itemId),'"]')),n=Array.from(r.querySelectorAll(".matching-target")).find(function(t){var r;return(null===(r=t.querySelector(".matching-target-text"))||void 0===r?void 0:r.textContent.trim())===e.userAnswer});if(e.correct)t&&(t.classList.remove("matched"),t.classList.add("correct")),n&&(n.classList.remove("matched"),n.classList.add("correct"));else{t&&(t.classList.add("flash-incorrect"),setTimeout(function(){t.classList.remove("flash-incorrect","matched"),t.disabled=!1,t.style.removeProperty("--pair-color")},1e3)),n&&(n.classList.add("flash-incorrect"),setTimeout(function(){n.classList.remove("flash-incorrect","matched"),n.disabled=!1,n.style.removeProperty("--pair-color")},1e3));var a=r._matchingState;a&&setTimeout(function(){delete a.matches[e.itemId]},1e3)}})),a.correct){var o,i=(null===(o=e.feedback)||void 0===o?void 0:o.correct)||"Excellent! All matches are correct.";Xn(d,t,i,"correct")}else{var s,c=(null===(s=e.feedback)||void 0===s?void 0:s.incorrect)||"".concat(Math.round(100*a.score),"% correct. Review your matches.");Xn(d,t,c,"incorrect")}return a},reset:function(){na(d,t),d.querySelectorAll(".matching-item").forEach(function(e){e.classList.remove("selected","matched","correct","incorrect","flash-incorrect"),e.disabled=!1,e.style.removeProperty("--pair-color")}),d.querySelectorAll(".matching-target").forEach(function(e){e.classList.remove("selected","matched","correct","incorrect"),e.disabled=!1,e.style.removeProperty("--pair-color")}),ea(d,t);var e=d._matchingState;e&&(e.matches={},e.selectedItem=null,e.selectedTarget=null,e.colorIndex=0)},getResponse:function(){na(d,t);var e=d._matchingState;return e?i({},e.matches):{}},setResponse:function(e){na(d,t);var r=e;if(Array.isArray(e)&&(r={},e.forEach(function(e){if(e.source&&e.target){var t=e.target,n=u.matches.find(function(e){return e.id===t}),a=n?n.match:e.target;r[e.source]=a}})),!r||"object"!==h(r))throw new Error('setResponse expects an object for matching question "'.concat(t,'"'));m.reset();var n=d._matchingState;n&&(n.matches=i({},r),Object.entries(r).forEach(function(e){var t=a(e,2),r=t[0],o=t[1],i=d.querySelector('.matching-item[data-item-id="'.concat(ra(r),'"]')),s=Array.from(d.querySelectorAll(".matching-target")).find(function(e){var t;return(null===(t=e.querySelector(".matching-target-text"))||void 0===t?void 0:t.textContent.trim())===o});if(i&&s&&(i.classList.add("matched"),s.classList.add("matched"),i.disabled=!0,s.disabled=!0,"deferred"===l)){var c=p[n.colorIndex%p.length];i.style.setProperty("--pair-color",c),s.style.setProperty("--pair-color",c),n.colorIndex++}}))},getCorrectAnswer:function(){return n.reduce(function(e,t){return e[t.id]=t.match,e},{})}};return s||oa(e,m),m}function Wa(e,t,r,n,a,o,i){var s=r.dataset.itemId,c=n.querySelector(".matching-target-text").textContent.trim();if("deferred"===o){var l=i[t.colorIndex%i.length];n.style.setProperty("--selection-color",l)}var d=a.correctAnswers[s];if("immediate"===o)return c===d?(r.classList.remove("selected"),r.classList.add("matched","correct"),r.disabled=!0,n.classList.remove("selected"),n.classList.add("matched","correct"),n.disabled=!0,t.matches[s]=c):(r.classList.add("incorrect"),n.classList.add("incorrect"),setTimeout(function(){r.classList.remove("incorrect","selected"),n.classList.remove("incorrect","selected")},600)),t.selectedItem=null,void(t.selectedTarget=null);var u=Object.keys(t.matches).find(function(e){return t.matches[e]===c});if(u&&u!==s){var p=e.querySelector('.matching-item[data-item-id="'.concat(ra(u),'"]'));p&&(p.classList.remove("matched"),p.style.removeProperty("--pair-color")),delete t.matches[u]}if(t.matches[s]){var m=t.matches[s],g=Array.from(e.querySelectorAll(".matching-target")).find(function(e){var t;return(null===(t=e.querySelector(".matching-target-text"))||void 0===t?void 0:t.textContent.trim())===m});g&&(g.classList.remove("matched"),g.style.removeProperty("--pair-color"))}var f=i[t.colorIndex%i.length];t.colorIndex++,r.classList.remove("selected"),r.classList.add("matched"),r.style.setProperty("--pair-color",f),n.classList.remove("selected"),n.classList.add("matched"),n.style.setProperty("--pair-color",f),t.matches[s]=c,t.selectedItem=null,t.selectedTarget=null}var Ya={creator:"createDragDropQuestion",scormType:"other",showCheckAnswer:!0,isAnswered:function(e){return!(!e||"object"!==h(e))&&Object.keys(e).length>0},getCorrectAnswer:function(e){var t={};return e.dropZones&&Array.isArray(e.dropZones)&&e.dropZones.forEach(function(e){e.accepts&&Array.isArray(e.accepts)&&e.accepts.forEach(function(r){t[r]=e.id})}),JSON.stringify(t)},formatCorrectAnswer:function(e,t){return'<p class="correct-item">See correct placements above</p>'},formatUserResponse:function(e,t){try{var r="string"==typeof t?JSON.parse(t):t,n=Object.keys(r).length;return'<p class="response-item">'.concat(n," item(s) placed</p>")}catch(a){return'<p class="response-item">'.concat(t,"</p>")}}};function Qa(e){Gn(e,["items","dropZones"]);var t=e.id,r=e.prompt,n=e.items,o=e.dropZones,s=e.controlled,c=void 0!==s&&s;if(!Array.isArray(n)||0===n.length)throw new Error('Drag-drop question "'.concat(t,'" must have at least one item'));if(!Array.isArray(o)||0===o.length)throw new Error('Drag-drop question "'.concat(t,'" must have at least one drop zone'));var l=null,d={id:t,type:"drag-drop",render:function(a){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;na(a,t),l=a;var u=aa(ta(s),"object")||{},p='\n                <div class="interaction drag-drop" data-interaction-id="'.concat(t,'">\n                    <div class="question-prompt">\n                        <h3>').concat(r,'</h3>\n                    </div>\n                    <div class="drag-drop-container">\n                        <div class="drag-items" data-droppable="true">\n                            <h4>Drag these items:</h4>\n            ');if(n.forEach(function(e,r){var n=void 0!==u[e.id];p+='\n                    <div\n                      class="drag-item'.concat(n?" d-none":"",'"\n                      draggable="true"\n                      data-item-id="').concat(e.id,'"\n                      data-index="').concat(r,'"\n                      tabindex="0"\n                      role="button"\n                      aria-grabbed="false"\n                      data-testid="').concat(t,"-drag-item-").concat(e.id,'"\n                    >\n                        ').concat(e.content,"\n                    </div>\n                ")}),p+='\n                        </div>\n                        <div class="drop-zones">\n                            <h4>Drop into correct zones:</h4>\n            ',o.forEach(function(e){var r=Object.keys(u).filter(function(t){return u[t]===e.id}),a=e.maxItems||1;p+='\n                    <div\n                      class="drop-zone"\n                      data-zone-id="'.concat(e.id,'"\n                      data-accepts="').concat(e.accepts.join(","),'"\n                      data-max-items="').concat(a,'"\n                      role="region"\n                      aria-label="').concat(e.label,'"\n                      tabindex="0"\n                      data-testid="').concat(t,"-drop-zone-").concat(e.id,'"\n                    >\n                        <div class="zone-label">').concat(e.label,'</div>\n                        <div class="zone-content">'),r.forEach(function(e){var r=n.find(function(t){return t.id===e});r&&(p+='\n                            <div class="drag-item dropped" data-item-id="'.concat(r.id,'" draggable="true" data-testid="').concat(t,"-dropped-item-").concat(r.id,'">\n                                ').concat(r.content,'\n                                <button type="button" class="remove-item" data-action="remove-item" data-item-id="').concat(r.id,'" aria-label="Remove ').concat(r.content,'" title="Remove this item" data-testid="').concat(t,"-remove-").concat(r.id,'">×</button>\n                            </div>\n                        '))}),p+="\n                        </div>\n                    </div>\n                "}),p+="\n                        </div>\n                    </div>\n                    ".concat(Zn(t,c),'\n                    <div class="overall-feedback" id="').concat(t,'_overall_feedback" aria-live="polite"></div>\n                </div>\n            '),a.innerHTML=p,function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e._dragDropState={placements:i({},r),draggedElement:null,selectedForDrop:null};var n=e._dragDropState,a=function(e){if(e.target.classList.contains("remove-item")){e.stopPropagation();var t=e.target.closest(".drag-item");t&&(t.draggable=!1,setTimeout(function(){t.draggable=!0},100))}};e.addEventListener("mousedown",a,!0),e.addEventListener("touchstart",a,{capture:!0,passive:!1});var o=e.querySelectorAll(".drag-item");o.forEach(function(t){t.addEventListener("dragstart",function(e){e.target.classList.contains("remove-item")||e.target.closest(".remove-item")?e.preventDefault():(n.draggedElement=e.currentTarget,e.currentTarget.setAttribute("aria-grabbed","true"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",e.currentTarget.dataset.itemId))}),t.addEventListener("dragend",function(e){e.target.setAttribute("aria-grabbed","false")}),t.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e.querySelectorAll(".drag-item").forEach(function(e){return e.classList.remove("keyboard-selected")}),n.selectedForDrop=t.currentTarget,t.currentTarget.classList.add("keyboard-selected"))})});var s=e.querySelectorAll(".drop-zone");s.forEach(function(t){t.addEventListener("dragover",function(e){e.preventDefault(),e.dataTransfer.dropEffect="move",e.currentTarget.classList.add("drag-over")}),t.addEventListener("dragleave",function(e){e.currentTarget.classList.remove("drag-over")}),t.addEventListener("drop",function(t){t.preventDefault(),t.currentTarget.classList.remove("drag-over"),n.draggedElement&&Ga(e,n,n.draggedElement,t.currentTarget)}),t.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||!n.selectedForDrop||(t.preventDefault(),Ga(e,n,n.selectedForDrop,t.currentTarget))})});var c=e.querySelector(".drag-items");c&&(c.addEventListener("dragover",function(e){e.preventDefault(),e.dataTransfer.dropEffect="move",e.currentTarget.classList.add("drag-over")}),c.addEventListener("dragleave",function(e){e.currentTarget.classList.remove("drag-over")}),c.addEventListener("drop",function(t){if(t.preventDefault(),t.currentTarget.classList.remove("drag-over"),n.draggedElement&&n.draggedElement.classList.contains("dropped")){var r=n.draggedElement.dataset.itemId;Ja(e,r)}}),c.addEventListener("keydown",function(t){if(("Enter"===t.key||" "===t.key)&&n.selectedForDrop&&n.selectedForDrop.classList.contains("dropped")){t.preventDefault();var r=n.selectedForDrop.dataset.itemId;Ja(e,r),n.selectedForDrop=null}}))}(a,d,u),!c){var m=JSON.stringify(o.reduce(function(e,t){return t.accepts.forEach(function(r){return e[r]=t.id}),e},{}));a.addEventListener("click",Jn(d,i(i({},e),{},{scormType:"other",correctPattern:m})))}var g=function(e){if(e.target.classList.contains("remove-item")){e.stopPropagation(),e.preventDefault();var t=e.target.dataset.itemId;t&&Ja(a,t)}};a.addEventListener("click",g,!0),a.addEventListener("mousedown",g,!0),a.addEventListener("touchstart",g,{capture:!0,passive:!1})},evaluate:function(e){if(!e||"object"!==h(e))return{score:0,correct:!1,results:[],response:JSON.stringify({}),error:"Invalid placements format"};var t=0,r=[];return Object.entries(e).forEach(function(e){var n=a(e,2),i=n[0],s=n[1],c=o.find(function(e){return e.id===s}),l=c&&c.accepts.includes(i);l&&t++,r.push({itemId:i,zoneId:s,correct:l})}),{score:t/n.length,correct:t===n.length,results:r,response:JSON.stringify(e)}},checkAnswer:function(){na(l,t);var e=d.getResponse(),r=d.evaluate(e);return r.correct?Xn(l,t,"Excellent! All items are in the correct zones.","correct"):Xn(l,t,"".concat(Math.round(100*r.score),"% correct. Review your placements."),"incorrect"),r},reset:function(){na(l,t),l.querySelectorAll(".drag-item").forEach(function(e){e.style.display="block",e.classList.remove("keyboard-selected","dropped")}),l.querySelectorAll(".drop-zone .zone-content").forEach(function(e){return e.innerHTML=""}),ea(l,t);var e=l._dragDropState;e&&(e.placements={},e.selectedForDrop=null)},getResponse:function(){na(l,t);var e={};return l.querySelectorAll(".drop-zone").forEach(function(t){t.querySelectorAll(".drag-item.dropped").forEach(function(r){e[r.dataset.itemId]=t.dataset.zoneId})}),e},setResponse:function(e){if(na(l,t),!e||"object"!==h(e))throw new Error('setResponse expects an object for drag-drop question "'.concat(t,'"'));l.querySelectorAll(".drag-item").forEach(function(e){return e.style.display="block"}),l.querySelectorAll(".drop-zone .zone-content").forEach(function(e){return e.innerHTML=""}),Object.keys(e).forEach(function(t){var r=e[t],n=l.querySelector('.drag-item[data-item-id="'.concat(ra(t),'"]')),a=l.querySelector('.drop-zone[data-zone-id="'.concat(ra(r),'"] .zone-content'));if(n&&a){var o=n.cloneNode(!0);o.classList.add("dropped"),o.draggable=!1,a.appendChild(o),n.style.display="none"}});var r=l._dragDropState;r&&(r.placements=i({},e))},getCorrectAnswer:function(){var e={};return o.forEach(function(t){t.accepts&&Array.isArray(t.accepts)&&t.accepts.forEach(function(r){e[r]=t.id})}),e}};return c||oa(e,d),d}function Ga(e,t,r,n){var a=r.dataset.itemId,o=n.dataset.zoneId,i=n.querySelector(".zone-content");if(!i)throw new Error("Drop zone content element not found");var s=parseInt(n.dataset.maxItems)||1;if(i.querySelectorAll(".drag-item.dropped").length>=s)console.warn('Zone "'.concat(o,'" is full (max: ').concat(s,")"));else{if(r.classList.contains("dropped")){var c=r.closest(".drop-zone");c&&(c.dataset.zoneId,delete t.placements[a]),r.remove();var l=e.querySelector('.drag-items .drag-item[data-item-id="'.concat(ra(a),'"]'));l&&(l.style.display="block")}var d=r.cloneNode(!0);if(d.classList.add("dropped"),d.classList.remove("keyboard-selected"),d.draggable=!0,!d.querySelector(".remove-item")){var u=document.createElement("button");u.type="button",u.className="remove-item",u.dataset.action="remove-item",u.dataset.itemId=a,u.setAttribute("aria-label","Remove ".concat(r.textContent||r.innerText)),u.setAttribute("title","Remove this item"),u.textContent="×",d.appendChild(u)}i.appendChild(d),function(e,t,r){e.addEventListener("dragstart",function(e){e.target.classList.contains("remove-item")||e.target.closest(".remove-item")?e.preventDefault():(r.draggedElement=e.currentTarget,e.currentTarget.setAttribute("aria-grabbed","true"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",e.currentTarget.dataset.itemId))}),e.addEventListener("dragend",function(e){e.target.setAttribute("aria-grabbed","false")}),e.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t.querySelectorAll(".drag-item").forEach(function(e){return e.classList.remove("keyboard-selected")}),r.selectedForDrop=e.currentTarget,e.currentTarget.classList.add("keyboard-selected"))})}(d,e,t),t.placements[a]=o,r.style.display="none",t.selectedForDrop=null,t.draggedElement=null}}function Ja(e,t){var r=e._dragDropState;if(r){var n=e.querySelector('.drop-zone .drag-item[data-item-id="'.concat(ra(t),'"]'));n&&n.remove();var a=e.querySelector('.drag-items .drag-item[data-item-id="'.concat(ra(t),'"]'));a&&(a.style.display="block"),delete r.placements[t]}}var Ka={creator:"createNumericQuestion",scormType:"numeric",showCheckAnswer:!0,isAnswered:function(e){return null!=e&&String(e).trim().length>0},getCorrectAnswer:function(e){return JSON.stringify(e.correctRange||{})},formatCorrectAnswer:function(e,t){var r="";return e.correctRange?void 0!==e.correctRange.exact?r+='<p class="correct-item">'.concat(e.correctRange.exact,"</p>"):void 0!==e.correctRange.min&&void 0!==e.correctRange.max&&(r+='<p class="correct-item">'.concat(e.correctRange.min," - ").concat(e.correctRange.max,"</p>")):r+='<p class="correct-item">'.concat(t,"</p>"),r},formatUserResponse:function(e,t){return'<p class="response-item">'.concat(t,"</p>")}};function Za(e){Gn(e,["correctRange"]);var t=e.id,r=e.prompt,n=e.correctRange,a=e.units,o=void 0===a?"":a,s=e.tolerance,c=void 0===s?0:s,l=e.controlled,d=void 0!==l&&l,u=null,p={id:t,type:"numeric",render:function(a){var s,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;na(a,t),u=a;var l=null!==(s=ta(c))&&void 0!==s?s:"",m='\n                <div class="interaction numeric" data-interaction-id="'.concat(t,'">\n                    <div class="question-prompt">\n                        <h3>').concat(r,'</h3>\n                    </div>\n                    <div class="numeric-input-container">\n                        <label for="').concat(t,'_input">Your answer:</label>\n                        <input\n                          type="number"\n                          id="').concat(t,'_input"\n                          name="').concat(t,'_input"\n                          step="any"\n                          value="').concat(l,'"\n                          aria-describedby="').concat(t,'_feedback"\n                          ').concat(void 0!==n.min?'min="'.concat(n.min,'"'):"","\n                          ").concat(void 0!==n.max?'max="'.concat(n.max,'"'):"",'\n                          data-testid="').concat(t,'-input"\n                        />\n                        ').concat(o?'<span class="units">'.concat(o,"</span>"):"","\n                    </div>\n                    ").concat(Zn(t,d),"\n                    ").concat($n(t),"\n                </div>\n            ");a.innerHTML=m,a.querySelector('input[type="number"]').addEventListener("keydown",function(e){"Enter"===e.key&&(e.preventDefault(),p.checkAnswer())}),d||a.addEventListener("click",Jn(p,i(i({},e),{},{scormType:"numeric",correctPattern:JSON.stringify(n)})))},evaluate:function(e){if(null==e||""===e)return{score:0,correct:!1,response:"",error:"No answer provided"};var t=parseFloat(e);if(isNaN(t))return{score:0,correct:!1,response:e,error:"Invalid numeric value"};var r=!1;return void 0!==n.exact?r=Math.abs(t-n.exact)<=c:void 0!==n.min&&void 0!==n.max?r=t>=n.min&&t<=n.max:void 0!==n.min?r=t>=n.min:void 0!==n.max&&(r=t<=n.max),{score:r?1:0,correct:r,response:e,value:t}},checkAnswer:function(){na(u,t);var e=u.querySelector('input[type="number"]');if(!e)throw new Error('Input element not found for numeric question "'.concat(t,'"'));var r=e.value.trim();if(""===r)return Xn(u,t,"Please enter a number.","error"),null;var a=p.evaluate(r);if(a.correct)Xn(u,t,"Correct! ".concat(a.value).concat(o),"correct");else{var i="";void 0!==n.exact?i="Expected: ".concat(n.exact).concat(o):void 0!==n.min&&void 0!==n.max?i="Expected: between ".concat(n.min," and ").concat(n.max).concat(o):void 0!==n.min?i="Expected: at least ".concat(n.min).concat(o):void 0!==n.max&&(i="Expected: at most ".concat(n.max).concat(o)),Xn(u,t,"Incorrect. ".concat(i),"incorrect")}return a},reset:function(){na(u,t);var e=u.querySelector('input[type="number"]');e&&(e.value=""),ea(u,t)},setResponse:function(e){if(na(u,t),null!=e){var r=u.querySelector('input[type="number"]');if(!r)throw new Error('Input element not found for numeric question "'.concat(t,'"'));r.value=e}},getResponse:function(){na(u,t);var e=u.querySelector('input[type="number"]');if(!e)throw new Error('Input element not found for numeric question "'.concat(t,'"'));return e.value||null},getCorrectAnswer:function(){return n}};return d||oa(e,p),p}var $a={appearance:{correct:{default:{fill:"rgba(187, 247, 208, 0.3)",stroke:"#15803d",strokeWidth:3},hover:{fill:"rgba(187, 247, 208, 0.5)",stroke:"#15803d",strokeWidth:4},selected:{fill:"rgba(0, 200, 0, 0.3)",stroke:"#00cc00",strokeWidth:4}},incorrect:{default:{fill:"rgba(254, 205, 211, 0.3)",stroke:"#be123c",strokeWidth:3},hover:{fill:"rgba(254, 205, 211, 0.5)",stroke:"#be123c",strokeWidth:4},selected:{fill:"rgba(255, 0, 0, 0.3)",stroke:"#cc0000",strokeWidth:4}},primary:{default:{fill:"rgba(199, 210, 254, 0.3)",stroke:"#4338ca",strokeWidth:3},hover:{fill:"rgba(199, 210, 254, 0.5)",stroke:"#4338ca",strokeWidth:4},selected:{fill:"rgba(0, 200, 0, 0.3)",stroke:"#00cc00",strokeWidth:4}},accent:{default:{fill:"rgba(186, 230, 253, 0.3)",stroke:"#0369a1",strokeWidth:3},hover:{fill:"rgba(186, 230, 253, 0.5)",stroke:"#0369a1",strokeWidth:4},selected:{fill:"rgba(0, 200, 0, 0.3)",stroke:"#00cc00",strokeWidth:4}}}};function Xa(e){if(e.position&&!e.pos)return e;var t,r=e.pos?{x:e.pos[0],y:e.pos[1],width:e.pos[2],height:e.pos[3]}:e.position;t=e.appearance?e.appearance:e.theme&&$a.appearance[e.theme]?$a.appearance[e.theme]:e.correct?$a.appearance.correct:$a.appearance.incorrect;var n="string"==typeof e.feedback?{onSelect:e.feedback,onDeselect:null}:e.feedback||{onSelect:null,onDeselect:null};return{id:e.id,shape:e.shape||"rectangle",position:r,correct:e.correct,label:e.label,appearance:t,feedback:n}}var eo={creator:"createHotspotQuestion",scormType:"other",showCheckAnswer:!0,isAnswered:function(e){return Array.isArray(e)&&e.length>0},getCorrectAnswer:function(e){var t=no(null==e?void 0:e.hotspots,null==e?void 0:e.id);if(!t.length)return"";var r=t.filter(function(e){return e.correct}).map(function(e){return e.id});return r.length?JSON.stringify(r):""},formatCorrectAnswer:function(e,t){var r=no(null==e?void 0:e.hotspots,null==e?void 0:e.id),n=new Map(r.map(function(e){return[e.id,e]})),a=ro(t,new Set(n.keys())),o=(a.length?a:r.filter(function(e){return e.correct})).map(function(e){return n.get(e)}).filter(Boolean);return o.length?'<ul class="list-disc pl-4 m-0">'+o.map(function(e){return'<li class="correct-item">'.concat(e.label,"</li>")}).join("")+"</ul>":'<p class="correct-item">No correct hotspots configured</p>'},formatUserResponse:function(e,t){var r=no(null==e?void 0:e.hotspots,null==e?void 0:e.id),n=new Map(r.map(function(e){return[e.id,e]})),a=ro(t,new Set(n.keys()));return a.length?'<ul class="list-disc pl-4 m-0">'+a.map(function(e){var t=n.get(e);return'<li class="response-item">'.concat(t?t.label:e,"</li>")}).join("")+"</ul>":'<p class="response-item">No hotspots selected</p>'}};function to(e){Gn(e,["id","prompt","image","hotspots"]);var t=e.id,r=e.prompt,n=e.image,a=void 0===n?{}:n,o=e.hotspots,s=void 0===o?[]:o,c=e.feedback,l=e.controlled,d=void 0!==l&&l;if(null==a||!a.src)throw new Error('Hotspot question "'.concat(t,'" is missing an image source.'));if(!Array.isArray(s)||0===s.length)throw new Error('Hotspot question "'.concat(t,'" has no hotspot regions configured.'));var u=function(e){var t=new Set;return e.map(function(e,r){var n=e.id;n||(n="hotspot_".concat(r+1));for(var a=1;t.has(n);)a+=1,n="".concat(e.id||"hotspot_".concat(r+1),"_").concat(a);return t.add(n),i(i({},e),{},{id:n})})}(no(s.map(Xa),t)),p=new Map(u.map(function(e){return[e.id,e]})),m=new Set(p.keys()),g=u.filter(function(e){return e.correct}).map(function(e){return e.id}),f=null,v={id:t,type:"hotspot",render:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;na(e,t),f=e;var o=ro(n,m);o.length&&console.log("[Hotspot] Initializing with ".concat(o.length," saved selection(s)")),e._hotspotState={selectedSpots:o};var i=u.map(function(e,r){var n=o.includes(e.id),a=["hotspot-area"];n&&a.push("selected");var i=["position: absolute","left: ".concat(e.cssLeft),"top: ".concat(e.cssTop),"width: ".concat(e.cssWidth),"height: ".concat(e.cssHeight),"background: ".concat(n?e.selectedBackgroundColor:e.backgroundColor),"border-color: ".concat(n?e.selectedBorderColor:e.borderColor),"border-width: ".concat(n?e.selectedBorderWidth:e.borderWidth,"px"),"border-style: ".concat(n?e.selectedBorderStyle||e.borderStyle||"solid":e.borderStyle||"solid"),"border-radius: ".concat(e.borderRadius),"cursor: pointer","z-index: 10"];return e.style&&i.push(e.style),'\n          <button\n            type="button"\n            role="checkbox"\n            class="'.concat(a.join(" "),'"\n            data-hotspot-id="').concat(e.id,'"\n            data-correct="').concat(e.correct,'"\n            data-default-bg="').concat(e.backgroundColor,'"\n            data-selected-bg="').concat(e.selectedBackgroundColor,'"\n            data-default-border="').concat(e.borderColor,'"\n            data-selected-border="').concat(e.selectedBorderColor,'"\n            data-default-border-width="').concat(e.borderWidth,'"\n            data-selected-border-width="').concat(e.selectedBorderWidth,'"\n            data-default-border-style="').concat(e.borderStyle||"solid",'"\n            data-selected-border-style="').concat(e.selectedBorderStyle||e.borderStyle||"solid",'"\n            data-hover="false"\n            aria-label="').concat(e.label,'"\n            aria-checked="').concat(n,'"\n            title="').concat(e.label,'"\n            style="').concat(i.join("; "),'"\n            data-testid="').concat(t,"-hotspot-").concat(e.id,'"\n          >\n            <span class="sr-only">').concat(e.label||"Hotspot ".concat(r+1),"</span>\n          </button>")}).join(""),s='\n        <div class="interaction hotspot" data-interaction-id="'.concat(t,'">\n          <div class="question-prompt">\n            <h3>').concat(r,'</h3>\n          </div>\n          <div class="hotspot-container">\n            <div class="image-container position-relative">\n              <img\n                src="').concat(a.src,'"\n                alt="').concat(a.alt||"",'"\n                class="w-full h-auto"\n                id="').concat(t,'_image"\n              />\n              ').concat(i,'\n            </div>\n          </div>\n          <div class="hotspot-feedback" id="').concat(t,'_feedback" aria-live="polite"></div>\n          ').concat(Zn(t,d),"\n        </div>");e.innerHTML=s,o.length&&v.setResponse(o),setupHotspotInteraction(e,v,{controlled:d,validSpotIds:m,hotspotMap:p})},evaluate:function(e){var t=ro(Array.isArray(e)?e:[],m),r=u.filter(function(e){return e.correct}).map(function(e){return e.id}),n=new Set(r),a=r.every(function(e){return t.includes(e)}),o=t.every(function(e){return n.has(e)}),i=t.length>0&&a&&o;return{score:i?1:0,correct:i,results:{selected:t,correct:r},response:JSON.stringify(t)}},checkAnswer:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||f;na(e,t);var r=v.getResponse(e)||[];if(!r.length)return Xn(e,"Select at least one hotspot before checking your answer.","error"),null;var n=v.evaluate(r);if(n.correct)Xn(e,"✓ Excellent! You found all the correct areas.","correct");else{var a=n.results.correct.length,o=r.length;Xn(e,"✗ Keep trying. ".concat(o," selected / ").concat(a," required."),"incorrect")}return Kn(t,"other",n.response,n.correct,JSON.stringify(u.filter(function(e){return e.correct}).map(function(e){return e.id}))),n},reset:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||f;na(e,t),v.setResponse([],e),ea(e)},setResponse:function(e){var r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||f;na(r,t);var n=ro(e,m);r._hotspotState||(r._hotspotState={selectedSpots:[]}),r._hotspotState.selectedSpots=n,r.querySelectorAll(".hotspot-area").forEach(function(e){var t=e.dataset.hotspotId,r=n.includes(t),a=p.get(t);(e.classList.toggle("selected",r),e.setAttribute("aria-checked",r?"true":"false"),a)&&function(e,t,r){var n=r.selected,a=r.hover;if(!e||!t)return;var o=a&&t.hoverBackgroundColor?t.hoverBackgroundColor:n?t.selectedBackgroundColor:t.backgroundColor,i=a&&t.hoverBorderColor?t.hoverBorderColor:n?t.selectedBorderColor:t.borderColor,s=a&&void 0!==t.hoverBorderWidth?t.hoverBorderWidth:n?t.selectedBorderWidth:t.borderWidth,c=a&&t.hoverBorderStyle?t.hoverBorderStyle:n?t.selectedBorderStyle:t.borderStyle;e.style.background=o,e.style.borderColor=i,e.style.borderWidth="".concat(Math.max(0,so(s,t.borderWidth)),"px"),e.style.borderStyle=c||"solid"}(e,a,{selected:r,hover:"true"===e.dataset.hover})})},getResponse:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||f;return na(e,t),e._hotspotState?e._hotspotState.selectedSpots.slice():[]},getCorrectAnswer:function(){return g.slice()},hotspots:u,prompt:r,feedback:c,controlled:d};return d||oa(e,v),v}function ro(e,t){var r=new Set;return(aa(e,"array")||[]).forEach(function(e){t.has(String(e))&&r.add(String(e))}),Array.from(r)}function no(e,t){return Array.isArray(e)?e.map(function(){var e=arguments.length>1?arguments[1]:void 0,r=i({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return function(e,t,r){var n="".concat(t||"hotspot","_").concat(r+1);e.id="string"==typeof e.id&&e.id.trim()?e.id.trim():n,e.label="string"==typeof e.label&&e.label.trim()?e.label.trim():"Hotspot ".concat(r+1)}(r,t,e),function(e){var t,r,n,a,o="object"===h(e.position)&&null!==e.position?e.position:{},i=Object.keys(o).length>0,s=ao(o.xUnit||o.unit||e.xUnit,i?"px":"%"),c=ao(o.yUnit||o.unit||e.yUnit,i?"px":"%"),l=ao(o.widthUnit||o.unit||e.widthUnit,i?"px":"%"),d=ao(o.heightUnit||o.unit||e.heightUnit,i?"px":"%");e.cssLeft=oo(null!==(t=o.x)&&void 0!==t?t:e.x,{fallback:0,unit:s,clampToPercent:"%"===s,min:0}),e.cssTop=oo(null!==(r=o.y)&&void 0!==r?r:e.y,{fallback:0,unit:c,clampToPercent:"%"===c,min:0}),e.cssWidth=oo(null!==(n=o.width)&&void 0!==n?n:e.width,{fallback:i?80:5,unit:l,clampToPercent:"%"===l,min:1}),e.cssHeight=oo(null!==(a=o.height)&&void 0!==a?a:e.height,{fallback:i?80:5,unit:d,clampToPercent:"%"===d,min:1}),e.x=Number.parseFloat(e.cssLeft)||0,e.y=Number.parseFloat(e.cssTop)||0,e.width=Number.parseFloat(e.cssWidth)||(i?80:5),e.height=Number.parseFloat(e.cssHeight)||(i?80:5)}(r),function(e){var t,r,n,a=e.appearance||{},o=a.default||{},i=a.selected||{},s=a.hover||{};e.backgroundColor=o.fill||e.backgroundColor||"rgba(255, 0, 0, 0.3)",e.selectedBackgroundColor=i.fill||e.selectedBackgroundColor||"rgba(0, 150, 255, 0.5)",e.hoverBackgroundColor=s.fill||e.hoverBackgroundColor||"",e.borderColor=o.stroke||e.borderColor||"#ff0000",e.borderWidth=so(null!==(t=o.strokeWidth)&&void 0!==t?t:e.borderWidth,2),e.selectedBorderColor=i.stroke||e.selectedBorderColor||e.borderColor,e.selectedBorderWidth=so(null!==(r=i.strokeWidth)&&void 0!==r?r:e.selectedBorderWidth,e.borderWidth),e.hoverBorderColor=s.stroke||e.hoverBorderColor||"",e.hoverBorderWidth=so(null!==(n=s.strokeWidth)&&void 0!==n?n:e.hoverBorderWidth,e.borderWidth),e.borderStyle=o.strokeStyle||e.borderStyle||"solid",e.selectedBorderStyle=i.strokeStyle||e.selectedBorderStyle||e.borderStyle,e.hoverBorderStyle=s.strokeStyle||e.hoverBorderStyle||e.borderStyle}(r),function(e){e.borderRadius="string"==typeof e.borderRadius?e.borderRadius:e.shape&&"rectangle"===e.shape.toLowerCase()?"0":"50%",e.correct=!0===e.correct||"true"===e.correct||1===e.correct,e.style="string"==typeof e.style?e.style:""}(r),r}):[]}function ao(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"%";if(!e&&0!==e)return t;var r=String(e).trim().toLowerCase();return r?"%"===r||"percent"===r||"percentage"===r?"%":"px"===r||"pixel"===r||"pixels"===r?"px":r:t}function oo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.fallback,n=void 0===r?0:r,a=t.unit,o=void 0===a?"%":a,i=t.clampToPercent,s=void 0!==i&&i,c=t.min,l=void 0===c?null:c,d=t.max,u=void 0===d?null:d,p=ao(o,"%");if("string"==typeof e&&e.trim())return e.trim();var m=Number.parseFloat(e);if(Number.isFinite(m))return io(m,p,{clampToPercent:s,min:l,max:u});if("string"==typeof n&&n.trim())return n.trim();var g=Number.parseFloat(n);return Number.isFinite(g)?io(g,p,{clampToPercent:s,min:l,max:u}):io(0,p,{clampToPercent:s,min:l,max:u})}function io(e,t,r){var n=r.clampToPercent,a=r.min,o=r.max,i=e;return"number"==typeof a&&(i=Math.max(a,i)),"number"==typeof o&&(i=Math.min(o,i)),n&&(i=Math.min(100,Math.max(0,i))),"".concat(i).concat(t)}function so(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=Number.parseFloat(e);if(Number.isFinite(r))return Math.max(0,r);var n=Number.parseFloat(t);return Number.isFinite(n)?Math.max(0,n):0}var co={creator:"createSequencingQuestion",scormType:"sequencing",showCheckAnswer:!0,isAnswered:function(e){return Array.isArray(e)&&e.length>0},getCorrectAnswer:function(e){return JSON.stringify(e.correctOrder||[])},formatCorrectAnswer:function(e,t){var r='<ol class="list-decimal pl-4 m-0">',n=Array.isArray(t)?t:[],a=e.items||[];return n.forEach(function(e){var t=a.find(function(t){return t.id===e});t&&(r+="<li>".concat(t.text,"</li>"))}),r+="</ol>"},formatUserResponse:function(e,t){var r='<ol class="list-decimal pl-4 m-0">',n=Array.isArray(t)?t:[],a=e.items||[];return n.forEach(function(e){var t=a.find(function(t){return t.id===e});t&&(r+="<li>".concat(t.text,"</li>"))}),r+="</ol>"}};var lo=Object.freeze({"multiple-choice":{creator:Da,metadata:Ra},"multiple-choice-single":{creator:Da,metadata:Ra},"multiple-choice-multiple":{creator:Da,metadata:Ra},"true-false":{creator:Ba,metadata:Pa},"fill-in":{creator:Va,metadata:Fa},matching:{creator:Ua,metadata:Ha},"drag-drop":{creator:Qa,metadata:Ya},numeric:{creator:Za,metadata:Ka},hotspot:{creator:to,metadata:eo},sequencing:{creator:function(e){Gn(e,["items","correctOrder"]);var t=e.id,r=e.prompt,n=e.items,a=e.correctOrder,o=e.controlled,i=void 0!==o&&o;if(!Array.isArray(n)||n.length<2)throw new Error('Sequencing question "'.concat(t,'" must have at least two items'));if(!Array.isArray(a)||a.length!==n.length)throw new Error('Sequencing question "'.concat(t,'" correctOrder length must match items length'));var s=null,c=[],l={id:t,type:"sequencing",render:function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;na(a,t),s=a;var u=[],p=ta(o);u=Array.isArray(p)&&p.length===n.length?p:n.map(function(e){return e.id}).sort(function(){return Math.random()-.5}),c=v(u);var m='\n                <div class="interaction sequencing" data-interaction-id="'.concat(t,'">\n                    <div class="question-prompt">\n                        <h3>').concat(r,'</h3>\n                    </div>\n                    <div class="sequencing-list" role="list">\n            ');u.forEach(function(e,t){var r=n.find(function(t){return t.id===e});r&&(m+='\n                        <div class="sequence-item" \n                             draggable="true" \n                             data-item-id="'.concat(r.id,'" \n                             role="listitem"\n                             tabindex="0"\n                             aria-label="').concat(r.text,'. Press Up or Down arrow to reorder.">\n                            <span class="drag-handle" aria-hidden="true">☰</span>\n                            <span class="item-text">').concat(r.text,"</span>\n                        </div>\n                    "))}),m+="\n                    </div>\n                    ".concat($n(),"\n                    ").concat(Zn(t,i),"\n                </div>\n            "),a.innerHTML=m;var g,f,h=a.querySelector(".sequencing-list");f=null,(g=h).addEventListener("dragstart",function(e){(f=e.target.closest(".sequence-item"))&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",f.dataset.itemId),f.classList.add("dragging"),f.setAttribute("aria-grabbed","true"))}),g.addEventListener("dragend",function(e){f&&(f.classList.remove("dragging"),f.setAttribute("aria-grabbed","false"),f=null),g.querySelectorAll(".sequence-item").forEach(function(e){e.classList.remove("drag-over-top","drag-over-bottom")}),d(g)}),g.addEventListener("dragover",function(e){e.preventDefault();var t=e.target.closest(".sequence-item");if(t&&t!==f){var r=t.getBoundingClientRect(),n=r.top+r.height/2;t.classList.remove("drag-over-top","drag-over-bottom"),e.clientY<n?t.classList.add("drag-over-top"):t.classList.add("drag-over-bottom")}}),g.addEventListener("dragleave",function(e){var t=e.target.closest(".sequence-item");t&&t.classList.remove("drag-over-top","drag-over-bottom")}),g.addEventListener("drop",function(e){e.preventDefault();var t=e.target.closest(".sequence-item");if(t&&f&&t!==f){var r=t.getBoundingClientRect(),n=r.top+r.height/2;e.clientY<n?g.insertBefore(f,t):g.insertBefore(f,t.nextSibling),t.classList.remove("drag-over-top","drag-over-bottom"),d(g)}}),function(e){e.addEventListener("keydown",function(t){var r=t.target.closest(".sequence-item");if(r&&("ArrowUp"===t.key||"ArrowDown"===t.key))if(t.preventDefault(),"ArrowUp"===t.key){var n=r.previousElementSibling;n&&(e.insertBefore(r,n),r.focus(),d(e))}else if("ArrowDown"===t.key){var a=r.nextElementSibling;a&&(e.insertBefore(r,a.nextSibling),r.focus(),d(e))}})}(h),a.addEventListener("click",Jn(l,e))},getResponse:function(){return v(c)},setResponse:function(e){Array.isArray(e)&&(c=v(e),l.render(s,c))},checkAnswer:function(){var t,r,n=JSON.stringify(c)===JSON.stringify(a),o={correct:n,score:n?1:0,response:c,feedback:n?(null===(t=e.feedback)||void 0===t?void 0:t.correct)||"Correct sequence!":(null===(r=e.feedback)||void 0===r?void 0:r.incorrect)||"Incorrect sequence. Try again."};return Xn(s,o.correct,o.feedback),o},reset:function(){ea(s),l.render(s,null)},showHint:function(){}};function d(e){var t=Array.from(e.querySelectorAll(".sequence-item"));c=t.map(function(e){return e.dataset.itemId})}return l},metadata:co},likert:{creator:sa,metadata:ia}});var uo={render:"function",getResponse:"function",setResponse:"function",evaluate:"function"};function po(e,t,r,n){var o=e.type,s=lo[o];if(!s){var l="[AssessmentFactory:".concat(n,"] Unknown question type: ").concat(o);throw E.emit("assessment:error",l),new Error(l)}var d=s.creator(i(i({},e),{},{controlled:!0}));return function(e,t,r){for(var n=[],o=0,i=Object.entries(uo);o<i.length;o++){var s=a(i[o],2),c=s[0],l=s[1];h(e[c])!==l&&n.push("Missing required method '".concat(c,"' (expected ").concat(l,", got ").concat(h(e[c]),")"))}if(n.length>0){var d="[AssessmentFactory:".concat(r,"] Question type '").concat(t.type,"' (ID: ").concat(t.id,") has invalid interface:\n  - ").concat(n.join("\n  - "));throw E.emit("assessment:error",d),new Error(d)}}(d,e,n),i(i({},d),{},{metadata:s.metadata,persistToSCORM:function(){return u(c().m(function e(){var n;return c().w(function(e){for(;;)switch(e.n){case 0:return n=d.getResponse(),e.n=1,r.saveResponse(t,n);case 1:return e.a(2)}},e)}))()},restoreFromSCORM:function(){var e=r.getResponse(t);null!=e&&d.setResponse(e)}})}function mo(e){if(!e.id){var t=new Error("Assessment ID required");throw E.emit("assessment:error",{domain:"assessment",operation:"createAssessmentInstance",message:t.message,context:{config:e}}),t}if(!e.questions&&!e.questionBanks){var r=new Error("Assessment '".concat(e.id,"' needs questions or questionBanks"));throw E.emit("assessment:error",{domain:"assessment",operation:"createAssessmentInstance",message:r.message,context:{assessmentId:e.id}}),r}var n=e.id,a=function(e,t){if(!e||!e.id){var r="AssessmentState requires a config object with an id";throw E.emit("assessment:error",r),new Error(r)}if(!t){var n="[AssessmentState:".concat(e.id,"] StateManager instance is required");throw E.emit("assessment:error",n),new Error(n)}var a,o=(a=e.id,"assessment_".concat(a)),s="assessment-state",l={currentView:"intro",currentQuestionIndex:0,startTime:null,submitted:!1,attemptNumber:1,responses:{},selectedQuestions:null,reviewReached:!1};function d(){return t.getDomainState(o)||{}}function p(e){return m.apply(this,arguments)}function m(){return m=u(c().m(function e(r){var n,a=arguments;return c().w(function(e){for(;;)switch(e.n){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:s,e.n=1,t.setDomainState(o,r,{source:n});case 1:return e.a(2)}},e)})),m.apply(this,arguments)}function g(){var e=d();return e.session||(e.session=i({},l)),e}function v(){var e=d();return e.summary?f(e.summary):null}function h(){return h=u(c().m(function e(){var t,r,n,a,o=arguments;return c().w(function(e){for(;;)switch(e.n){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},r=o.length>1&&void 0!==o[1]?o[1]:s,n=d(),a=n.summary||{},n.summary=i(i({},a),t),e.n=1,p(n,r);case 1:return e.a(2)}},e)})),h.apply(this,arguments)}function b(){var e=d();return e.session?f(e.session):null}function y(){return(y=u(c().m(function e(){var t;return c().w(function(e){for(;;)switch(e.n){case 0:return t=g(),e.n=1,p(t,"".concat(s,":init"));case 1:return e.a(2)}},e)}))).apply(this,arguments)}function w(){return x.apply(this,arguments)}function x(){return x=u(c().m(function e(){var t,r,n,a=arguments;return c().w(function(e){for(;;)switch(e.n){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},r=a.length>1&&void 0!==a[1]?a[1]:s,(n=g()).session=i(i({},n.session),t),e.n=1,p(n,r);case 1:return e.a(2)}},e)})),x.apply(this,arguments)}function k(){return k=u(c().m(function e(){var t,r,n=arguments;return c().w(function(e){for(;;)switch(e.n){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:"".concat(s,":clear"),delete(r=d()).session,e.n=1,p(r,t);case 1:return e.a(2)}},e)})),k.apply(this,arguments)}function S(){var e,t=b(),r=v();return null!=t&&t.attemptNumber?t.attemptNumber:(null==(e=r)?void 0:e.attempts)>0?e.attempts+1:1}function A(){return A=u(c().m(function e(t){var r,n=arguments;return c().w(function(e){for(;;)switch(e.n){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:"".concat(s,":view"),e.n=1,w({currentView:t},r);case 1:return e.a(2)}},e)})),A.apply(this,arguments)}function C(){return C=u(c().m(function e(t){var r,n=arguments;return c().w(function(e){for(;;)switch(e.n){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:"".concat(s,":question"),e.n=1,w({currentQuestionIndex:t},r);case 1:return e.a(2)}},e)})),C.apply(this,arguments)}function z(){return z=u(c().m(function e(t){var r,n=arguments;return c().w(function(e){for(;;)switch(e.n){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:"".concat(s,":start"),e.n=1,w({startTime:t},r);case 1:return e.a(2)}},e)})),z.apply(this,arguments)}function I(){return I=u(c().m(function e(t){var r,n=arguments;return c().w(function(e){for(;;)switch(e.n){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:"".concat(s,":submit"),e.n=1,w({submitted:t},r);case 1:return e.a(2)}},e)})),I.apply(this,arguments)}function M(){return M=u(c().m(function e(t){var r,n=arguments;return c().w(function(e){for(;;)switch(e.n){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:"".concat(s,":attempt"),e.n=1,w({attemptNumber:t},r);case 1:return e.a(2)}},e)})),M.apply(this,arguments)}function q(){return(q=u(c().m(function e(t,r){var n,a,o;return c().w(function(e){for(;;)switch(e.n){case 0:return n=String(t),a=void 0===r?null:f(r),(o=g()).session.responses=o.session.responses||{},o.session.responses[n]=a,e.n=1,p(o,"".concat(s,":response"));case 1:return e.a(2)}},e)}))).apply(this,arguments)}function L(){return(L=u(c().m(function e(t){var r;return c().w(function(e){for(;;)switch(e.n){case 0:return(r=g()).session.selectedQuestions=t.map(function(e){return e.id}),e.n=1,p(r,"".concat(s,":selected-questions"));case 1:return e.a(2)}},e)}))).apply(this,arguments)}function T(){return(T=u(c().m(function t(r,n){var a,o,i;return c().w(function(t){for(;;)switch(t.n){case 0:if(null===(a=e.settings)||void 0===a?void 0:a.archiveDiscardedAttempts){t.n=1;break}return console.log("[AssessmentState:".concat(e.id,"] Discarded attempt archive disabled (to enable, set settings.archiveDiscardedAttempts: true)")),t.a(2);case 1:return(o=d()).discardedAttempts||(o.discardedAttempts=[]),i={timestamp:Date.now(),attemptNumber:S(),questions:r.map(function(e){var t,r;return{id:e.id,type:e.type,bankId:null===(t=e._meta)||void 0===t?void 0:t.bankId,originalIndex:null===(r=e._meta)||void 0===r?void 0:r.originalIndex}}),responses:f(n)},o.discardedAttempts.push(i),o.discardedAttempts.length>5&&(o.discardedAttempts=o.discardedAttempts.slice(-5)),t.n=2,p(o,"".concat(s,":archive"));case 2:console.log("[AssessmentState:".concat(e.id,"] Archived discarded attempt #").concat(i.attemptNumber));case 3:return t.a(2)}},t)}))).apply(this,arguments)}return{getSummary:v,updateSummary:function(){return h.apply(this,arguments)},getSession:b,initializeSession:function(){return y.apply(this,arguments)},updateSession:w,clearSession:function(){return k.apply(this,arguments)},getCurrentView:function(){var e=b();return(null==e?void 0:e.currentView)||"intro"},getCurrentQuestionIndex:function(){var e=b();return(null==e?void 0:e.currentQuestionIndex)||0},getStartTime:function(){var e=b();return(null==e?void 0:e.startTime)||null},isSubmitted:function(){var e=b();return(null==e?void 0:e.submitted)||!1},getAttemptNumber:S,getLastResults:function(){var e=v();return(null==e?void 0:e.lastResults)||null},setCurrentView:function(e){return A.apply(this,arguments)},setCurrentQuestionIndex:function(e){return C.apply(this,arguments)},setStartTime:function(e){return z.apply(this,arguments)},setSubmitted:function(e){return I.apply(this,arguments)},setAttemptNumber:function(e){return M.apply(this,arguments)},getResponse:function(e){var t=b();if(null==t||!t.responses)return null;var r=String(e);return Object.prototype.hasOwnProperty.call(t.responses,r)?f(t.responses[r]):null},saveResponse:function(e,t){return q.apply(this,arguments)},getSelectedQuestions:function(){var e=b();return null!=e&&e.selectedQuestions?f(e.selectedQuestions):null},setSelectedQuestions:function(e){return L.apply(this,arguments)},archiveDiscardedResponses:function(e,t){return T.apply(this,arguments)},getDiscardedAttempts:function(){var e=d();return e.discardedAttempts?f(e.discardedAttempts):[]}}}(e,Me),o=e.questions||[],l=[],d=e;function p(){var t,r,n,o=a.getSelectedQuestions();if(o&&Array.isArray(o)){var s=function(){if(e.questionBanks&&Array.isArray(e.questionBanks))return e.questionBanks.flatMap(function(e){return e.questions||[]});return e.questions||[]}(),c=new Map(s.map(function(e){return[e.id,e]}));return o.map(function(e){return c.get(e)}).filter(function(e){return void 0!==e})}if(e.questionBanks&&Array.isArray(e.questionBanks)&&e.questionBanks.length>0){var l,d=(r=e.questionBanks,n=[],r.forEach(function(e){var t=e.id,r=e.questions,a=e.selectCount;"all"!==a?k(r).slice(0,a).forEach(function(e,a){var o=r.indexOf(e);n.push(i(i({},e),{},{_meta:{bankId:t,originalIndex:o}}))}):r.forEach(function(e,r){n.push(i(i({},e),{},{_meta:{bankId:t,originalIndex:r}}))})}),n);return null!==(l=e.settings)&&void 0!==l&&l.randomizeQuestions&&(d=k(d)),d}return null!==(t=e.settings)&&void 0!==t&&t.randomizeQuestions&&Array.isArray(e.questions)?k(e.questions):e.questions||[]}var m=null,g=null;return{render:function(t){var r,f,v,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t){var b="[AssessmentFactory:".concat(n,"] targetContainer is required for render()");throw E.emit("assessment:error",b),new Error(b)}t.className="assessment-navigator";var y=a.getSummary(),w=a.getSession();y||(a.updateSummary({attempts:0}).catch(function(e){E.emit("assessment:error",{domain:"assessment",operation:"initialize-summary",message:"Failed to initialize summary: ".concat(e.message),context:{assessmentId:n}})}),y={attempts:0}),o=p(),!e.questionBanks||null!=w&&w.selectedQuestions||a.setSelectedQuestions(o).catch(function(e){E.emit("assessment:error",{domain:"assessment",operation:"persist-selected-questions",message:"Failed to persist selected questions: ".concat(e.message),context:{assessmentId:n}})}),l=o.map(function(e,t){return po(e,t,a,n)});var x=_a(d=i(i({},e),{},{questions:o}),a,l);m=x.initialize(t),g=function(e,t,r,n,a){if(!n||!n.id)throw new Error("[AssessmentActions] config with id is required");if(!a)throw new Error("[AssessmentActions:".concat(n.id,"] assessmentUI parameter is required"));var o=n.settings;function l(){return d.apply(this,arguments)}function d(){return(d=u(c().m(function t(){var n,a;return c().w(function(t){for(;;)switch(t.n){case 0:if(n=e.getCurrentQuestionIndex(),!(a=r[n])||"function"!=typeof a.persistToSCORM){t.n=1;break}return t.n=1,a.persistToSCORM();case 1:return t.a(2)}},t)}))).apply(this,arguments)}function p(e){"question"===e||"review"===e?La():qa()}function m(){return g.apply(this,arguments)}function g(){return(g=u(c().m(function r(){var n,a;return c().w(function(r){for(;;)switch(r.n){case 0:return n=e.getSummary(),a=((null==n?void 0:n.attempts)||0)+1,r.n=1,e.clearSession();case 1:return r.n=2,e.setCurrentView("question");case 2:return r.n=3,e.setCurrentQuestionIndex(0);case 3:return r.n=4,e.setStartTime(Date.now());case 4:return r.n=5,e.setSubmitted(!1);case 5:return r.n=6,e.setAttemptNumber(a);case 6:p("question"),t.showView("question");case 7:return r.a(2)}},r)}))).apply(this,arguments)}function f(){return v.apply(this,arguments)}function v(){return(v=u(c().m(function r(){var n;return c().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,l();case 1:if(!((n=e.getCurrentQuestionIndex())>0)){r.n=3;break}return r.n=2,e.setCurrentQuestionIndex(n-1);case 2:t.showView("question");case 3:return r.a(2)}},r)}))).apply(this,arguments)}function h(){return b.apply(this,arguments)}function b(){return(b=u(c().m(function r(){var a;return c().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,l();case 1:if((a=e.getCurrentQuestionIndex())!==n.questions.length-1){r.n=6;break}if(!o.allowReview){r.n=4;break}return r.n=2,e.updateSession({reviewReached:!0});case 2:return r.n=3,e.setCurrentView("review");case 3:p("review"),t.showView("review"),r.n=5;break;case 4:return r.n=5,C();case 5:r.n=8;break;case 6:return r.n=7,e.setCurrentQuestionIndex(a+1);case 7:t.showView("question");case 8:return r.a(2)}},r)}))).apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return(w=u(c().m(function r(a){var o,i;return c().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,l();case 1:if(o=parseInt(a.target.closest("[data-question-index]").dataset.questionIndex,10),!isNaN(o)){r.n=2;break}throw i="[AssessmentActions:".concat(n.id,"] Invalid question index from review screen"),E.emit("assessment:error",i),new Error(i);case 2:return r.n=3,e.setCurrentView("question");case 3:return r.n=4,e.setCurrentQuestionIndex(o);case 4:p("question"),t.showView("question");case 5:return r.a(2)}},r)}))).apply(this,arguments)}function x(){return k.apply(this,arguments)}function k(){return(k=u(c().m(function r(){return c().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,l();case 1:return r.n=2,e.setCurrentView("question");case 2:p("question"),t.showView("question");case 3:return r.a(2)}},r)}))).apply(this,arguments)}function S(){return A.apply(this,arguments)}function A(){return(A=u(c().m(function r(){return c().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,l();case 1:return r.n=2,e.setCurrentView("review");case 2:p("review"),t.showView("review");case 3:return r.a(2)}},r)}))).apply(this,arguments)}function C(){return z.apply(this,arguments)}function z(){return(z=u(c().m(function t(){var i,s,d,p,m,g,f;return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,l();case 1:for(i=e.getSession(),s=(null==i?void 0:i.responses)||{},d=[],p=0;p<n.questions.length;p++)n.questions[p],m=s[p],(g=r[p].metadata)&&g.isAnswered(m)||d.push(p);if(f=!0===o.allowUnansweredSubmission,!(d.length>0)){t.n=2;break}return a.showUnansweredModal(d,f,u(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,D();case 1:return e.a(2)}},e)}))),t.a(2);case 2:return t.n=3,D();case 3:return t.a(2)}},t)}))).apply(this,arguments)}function I(){var t=e.getCurrentQuestionIndex(),n=r[t];n&&"function"==typeof n.checkAnswer&&n.checkAnswer()}function M(){var t=e.getCurrentQuestionIndex(),n=r[t];n&&"function"==typeof n.reset&&n.reset()}function q(){var t=e.getCurrentQuestionIndex(),n=r[t];n&&"function"==typeof n.showHint&&n.showHint()}function L(){return T.apply(this,arguments)}function T(){return(T=u(c().m(function a(){var i,s,l,d;return c().w(function(a){for(;;)switch(a.n){case 0:if(!((i=e.getSession())&&i.responses&&Object.keys(i.responses).length>0)){a.n=1;break}return a.n=1,e.archiveDiscardedResponses(n.questions,i.responses);case 1:return r.forEach(function(e){if(e&&"function"==typeof e.reset)try{e.reset()}catch(t){}}),a.n=2,e.clearSession();case 2:return a.n=3,e.setCurrentView("intro");case 3:return a.n=4,e.setCurrentQuestionIndex(0);case 4:return a.n=5,e.setStartTime(null);case 5:return a.n=6,e.setSubmitted(!1);case 6:return a.n=7,e.updateSession({reviewReached:!1});case 7:if(s=!1!==o.randomizeOnRetake,l=n.questionBanks||o.randomizeQuestions,!s||!l){a.n=9;break}return a.n=8,e.setSelectedQuestions(null);case 8:if(!(d=Fe())){a.n=9;break}return Ln(d,{refreshAssessment:!0}),a.a(2);case 9:p("intro"),t.showView("intro");case 10:return a.a(2)}},a)}))).apply(this,arguments)}function O(){E.emit("ui:showModal","restart")}function j(t){var r=e.getSummary(),n=(null==r?void 0:r.attempts)||0,a=o.attemptsBeforeRemedial,s=o.attemptsBeforeRestart,c=o.allowRetake,l=null;if(!t.passed&&c){var d=He()||[],u=o.remedialSlideIds&&o.remedialSlideIds.length>0,p=u&&o.remedialSlideIds.every(function(e){return d.includes(e)});if(s&&n>=s)l={type:"restart",action:"restart-course",label:"Restart Course",message:"You have completed ".concat(n," attempts. To try again, you must restart the entire course. This will erase all progress."),messageType:"warning"};else if(a&&n>=a&&!p)l={type:"remedial",action:u?"go-to-remedial":"retake",label:u?"Review Content":"Retake Assessment",message:u?"Please review the recommended content before attempting the assessment again. This will help strengthen your understanding of key concepts.":"Please take time to review the course material before attempting the assessment again.",messageType:"info"};else{var m=null;if(a){var g=a-n;g>0&&(m=g>1?"".concat(g," more attempts before review is recommended."):"Content review will be recommended after your next attempt.")}if(!m&&s){var f=s-n;f>0&&(m=f>1?"".concat(f," attempts remaining before course restart is required."):"This is your final attempt before course restart is required.")}l={type:"retake",action:"retake",label:"Retake Assessment",attemptsMessage:m}}}return i(i({},t),{},{actionButton:l,currentAttempts:n})}function _(){return R.apply(this,arguments)}function R(){return(R=u(c().m(function e(){var t,r,a,i;return c().w(function(e){for(;;)switch(e.n){case 0:if(0!==(t=o.remedialSlideIds||[]).length){e.n=1;break}throw r=new Error("No remedial slides configured"),E.emit("assessment:error",{domain:"assessment",operation:"handleGoToRemedial",message:r.message,stack:r.stack,context:{assessmentId:n.id}}),r;case 1:return a=t[0],e.n=2,le(a);case 2:if(e.v){e.n=3;break}throw i="[AssessmentActions:".concat(n.id,"] Remedial slide '").concat(a,"' not found in course structure"),E.emit("assessment:error",{domain:"assessment",operation:"handleGoToRemedial",message:i,context:{assessmentId:n.id,remedialSlideIds:t}}),za("Error: Slide '".concat(a,"' not found"),"error"),new Error(i);case 3:Ln(a,{fromAssessment:n.id,remedialReview:!0});case 4:return e.a(2)}},e)}))).apply(this,arguments)}function D(){return N.apply(this,arguments)}function N(){return(N=u(c().m(function r(){var a,o,i,l,d,u,m,g,f,v,h,b,y;return c().w(function(r){for(;;)switch(r.p=r.n){case 0:if(a=e.getSession()){r.n=1;break}throw o="[AssessmentActions:".concat(n.id,"] No session data found, cannot submit"),E.emit("assessment:error",o),new Error(o);case 1:return i=e.getAttemptNumber(),l=P(a.responses||{},i),(d=e.getStartTime())&&(u=Date.now(),m=u-d,g=Math.floor(m/6e4),f=Math.floor(m%6e4/1e3),l.timeSpent="".concat(g.toString().padStart(2,"0"),":").concat(f.toString().padStart(2,"0"))),v={attemptNumber:l.attemptNumber,totalQuestions:l.totalQuestions,correctCount:l.correctCount,scorePercentage:l.scorePercentage,passed:l.passed,questionResults:l.details.map(function(e){return{id:e.questionId,correct:e.correct}})},r.n=2,e.updateSummary(s({lastResults:v,submitted:!0,attempts:i},"attempt_".concat(i),v));case 2:return r.n=3,e.updateSession({submitted:!0});case 3:return h=j(l),r.n=4,e.setCurrentView("results");case 4:if(p("results"),t.showView("results",h),!n.assessmentObjective){r.n=7;break}r.p=5,Nt.setCompletionStatus(n.assessmentObjective,"completed"),Nt.setSuccessStatus(n.assessmentObjective,l.passed?"passed":"failed"),r.n=7;break;case 6:throw r.p=6,y=r.v,b="Failed to update objective '".concat(n.assessmentObjective,"' after assessment submission"),E.emit("assessment:error",{domain:"assessment",operation:"submitAssessment",message:b,stack:y.stack,context:{assessmentId:n.id,objective:n.assessmentObjective}}),new Error(b);case 7:E.emit("assessment:submitted",{assessmentId:n.id,results:l}),"function"==typeof n.onComplete&&n.onComplete(l);case 8:return r.a(2)}},r,null,[[5,6]])}))).apply(this,arguments)}function P(e,t){var a=n.questions.length,i=0,s=0,c=n.questions.map(function(t,a){var o,c=r[a],l=e[a],d=t.weight;if(s+=d,!(o=null==l?{correct:!1,score:0,feedback:"Question was not answered"}:c.evaluate(l))||"boolean"!=typeof o.correct){var u=new Error("Question ".concat(a+1," (").concat(t.id,") evaluate() returned invalid result"));throw E.emit("assessment:error",{domain:"assessment",operation:"calculateFinalResults",message:u.message,stack:u.stack,context:{assessmentId:n.id,questionIndex:a,questionId:t.id}}),u}var p=o.correct;p&&(i+=d);var m={questionIndex:a,questionId:t.id,correct:p,response:l,weight:d};return t._meta&&(m.bankId=t._meta.bankId,m.originalIndex=t._meta.originalIndex),m}),l=s>0?i/s*100:0,d=l>=(o.passingScore||0);return{attemptNumber:t,totalQuestions:a,correctCount:c.filter(function(e){return e.correct}).length,scorePercentage:l,passed:d,details:c}}return{initialize:function(e){e.addEventListener("click",function(){var e=u(c().m(function e(t){var r,a,o,i,s;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=t.target.closest("[data-action]")){e.n=1;break}return e.a(2);case 1:if(a=r.dataset.action,!(o={start:m,prev:f,next:h,"review-question":y,"back-to-questions":x,"jump-to-review":S,submit:C,check:I,reset:M,hint:q,retake:L,"restart-course":O,"go-to-remedial":_})[a]){e.n=6;break}return t.preventDefault(),r.disabled=!0,e.p=2,e.n=3,o[a](t);case 3:e.n=5;break;case 4:throw e.p=4,s=e.v,i="[AssessmentActions:".concat(n.id,"] Error in action '").concat(a,"': ").concat(s.message),E.emit("assessment:error",i),s;case 5:return e.p=5,r.disabled=!1,e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}));return function(t){return e.apply(this,arguments)}}())}}}(a,m,l,d,x),g.initialize(t);var k=h.fromSlide,S=(null===(r=e.settings)||void 0===r?void 0:r.remedialSlideIds)||[];if(k&&S.includes(k)&&null!==(f=y)&&void 0!==f&&f.lastResults&&!y.lastResults.passed)a.clearSession().then(function(){qa(),m.showView("intro")});else{var A=null===(v=y)||void 0===v?void 0:v.lastResults;if(A){var C=function(e,t){var r=a.getSummary(),n=(null==r?void 0:r.attempts)||0,o=t.attemptsBeforeRemedial,s=t.attemptsBeforeRestart,c=t.allowRetake,l=(t.settings,{attemptNumber:e.attemptNumber,totalQuestions:e.totalQuestions,correctCount:e.correctCount,scorePercentage:e.scorePercentage,passed:e.passed,details:null}),d=null;if(s&&n>=s)d={type:"restart",action:"restart-course",label:"Restart Course",message:"You've completed ".concat(n," attempt(s). You must restart the course to try again."),messageType:"error"};else{var u=!1;if(o&&n>=o&&!e.passed){var p,m,g=(null===(p=t.settings)||void 0===p?void 0:p.remedialSlideIds)||(null!==(m=t.settings)&&void 0!==m&&m.remedialSlideId?[t.settings.remedialSlideId]:[]),f=He()||[],v=g.length>0&&g.every(function(e){return f.includes(e)});g.length>0&&!v&&(u=!0,d={type:"remedial",action:"go-to-remedial",label:"Review Content",message:"Please review the content before attempting again (Attempt ".concat(n,"/").concat(s||"∞",")."),messageType:"warning",attemptsMessage:"Attempts: ".concat(n).concat(s?"/".concat(s):"")})}u||!1===c||e.passed||(d={type:"retake",action:"retake",label:"Retake Assessment",attemptsMessage:"Attempts: ".concat(n).concat(s?"/".concat(s):"")})}return i(i({},l),{},{actionButton:d,timeSpent:null})}(A,d);return qa(),void m.showView("results",C)}if(w&&!w.submitted){var z=w.currentView||"intro";return"question"===z||"review"===z?La():qa(),void m.showView(z)}qa(),m.showView("intro")}}}}function go(e){return"assessment_".concat(e)}function fo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Me||"function"!=typeof Me.getDomainState||"function"!=typeof Me.setDomainState)throw new Error("AssessmentManager: StateManager with domain persistence APIs is required");return mo(x({},e,t))}function vo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e){var r=new Error("AssessmentManager.meetsCompletionRequirements: assessmentId is required");throw E.emit("assessment:error",{domain:"assessment",operation:"meetsCompletionRequirements",message:r.message,stack:r.stack,context:{}}),r}var n=go(e),a=Me.getDomainState(n);if(!a||!a.summary)return!1;var o,i=a.summary;if(t.requireSubmission&&!i.submitted)return!1;if(t.requirePass&&!(!0===(null===(o=i.lastResults)||void 0===o?void 0:o.passed)))return!1;return!0}var ho=Object.freeze(Object.defineProperty({__proto__:null,allAssessmentsMeetRequirements:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(e)){var t=new Error("AssessmentManager.allAssessmentsMeetRequirements: assessmentSlides must be an array");throw E.emit("assessment:error",{domain:"assessment",operation:"allAssessmentsMeetRequirements",message:t.message,stack:t.stack,context:{assessmentSlides:e}}),t}if(0===e.length)return!0;var r=e.filter(function(e){var t,r=null===(t=e.assessment)||void 0===t?void 0:t.completionRequirements;return r&&(r.requireSubmission||r.requirePass)});return 0===r.length||r.every(function(e){return vo(e.assessmentId,e.assessment.completionRequirements)})},createAssessment:fo,hasPassedAssessment:function(e){var t;if(!e){var r=new Error("AssessmentManager.hasPassedAssessment: assessmentId is required");throw E.emit("assessment:error",{domain:"assessment",operation:"hasPassedAssessment",message:r.message,stack:r.stack,context:{}}),new Error(errorMessage)}var n=go(e),a=Me.getDomainState(n);if(!a||!a.summary)return!1;var o=a.summary;return!0===o.submitted&&!0===(null===(t=o.lastResults)||void 0===t?void 0:t.passed)},meetsCompletionRequirements:vo},Symbol.toStringTag,{value:"Module"})),bo=function(){return g(function e(t,r){var n=this;if(p(this,e),this.container=document.querySelector(t),!this.container)throw new Error("[ScrollTracker] Container not found: ".concat(t,". Ensure the container exists in the DOM before creating ScrollTracker."));this.slideId=r,this.maxDepth=0,this.rafId=null,this.isScrolling=!1,this.handleScroll=function(){n.isScrolling||(n.isScrolling=!0,n.rafId=requestAnimationFrame(function(){return n.updateDepth()}))},this.container.addEventListener("scroll",this.handleScroll,{passive:!0}),this.updateDepth()},[{key:"updateDepth",value:function(){var e=this.calculateDepth();e>this.maxDepth&&(this.maxDepth=e,Qe.trackScrollDepth(this.slideId,e)),this.isScrolling=!1}},{key:"calculateDepth",value:function(){var e=this.container,t=e.scrollTop,r=e.scrollHeight-e.clientHeight;return r<=0?100:Math.round(t/r*100)}},{key:"destroy",value:function(){this.rafId&&cancelAnimationFrame(this.rafId),this.container&&this.container.removeEventListener("scroll",this.handleScroll)}}])}();window.SCORM_Framework={stateManager:Me,objectiveManager:Nt,interactionManager:Bt,interactionRegistry:Ft,AssessmentManager:ho,flagManager:wt,accessibilityManager:Oe,commentManager:fr,scoreManager:null,NavigationActions:Qn,AppActions:un,AppState:Tr,createMultipleChoiceQuestion:Da,createTrueFalseQuestion:Ba,createFillInQuestion:Va,createMatchingQuestion:Ua,createDragDropQuestion:Qa,createNumericQuestion:Za,createHotspotQuestion:to,initTabs:bt,initDropdown:Ke,Modal:ut,announceToScreenReader:ht,FeedbackSystem:Ur,eventBus:E,courseConfig:_t};null===(l=_t.environment)||void 0===l||null===(l=l.automation)||void 0===l||l.enabled;function yo(e){try{br()&&yr(e)}catch(r){}E.emit("initialization:error",{domain:"initialization",operation:"initializeCourseApplication",message:e.message,stack:e.stack,context:{timestamp:(new Date).toISOString()}});var t=document.getElementById("content");t&&(t.innerHTML='\n          <div class="p-6 callout callout-error" role="alert" aria-live="assertive">\n            <h2>Initialization Error</h2>\n            <p><strong>Failed to initialize course:</strong> '.concat(e.message,"</p>\n            <p>Please refresh the page. If the problem persists, contact support.</p>\n          </div>\n        "))}function wo(){return xo.apply(this,arguments)}function xo(){return xo=u(c().m(function e(){var t,r,n,a,s,l,d,p,g,f,v,h;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("[CourseInit] Initializing course modules..."),e.p=1,null!==(t=_t.metadata)&&void 0!==t&&t.title&&(document.title=_t.metadata.title,(n=document.getElementById("page-title"))&&(n.textContent=_t.metadata.title)),null!==(r=_t.metadata)&&void 0!==r&&r.description&&(a=document.getElementById("page-description"))&&a.setAttribute("content",_t.metadata.description),q()){e.n=2;break}throw new Error("SCORM initialization failed. Cannot start course without LMS connection.");case 2:if(Me.initialize(),Nt.initialize(_t.objectives),Bt.initialize(),Oe.initialize(),wt.initialize(),fr.initialize(),Qe.initialize(_t),!_t.scoring){e.n=4;break}return e.n=3,m(function(){return o.import("./score-manager-legacy.js")},void 0,o.meta.url);case 3:s=e.v,(l=s.default).initialize(_t.scoring),window.SCORM_Framework.scoreManager=l;case 4:return Nt.syncAllObjectivesToSCORM(),Bt.syncAllInteractionsToSCORM(),re(_t),e.n=5,ne();case 5:return d=e.v,e.n=6,ue();case 6:return p=e.v,e.n=7,fe();case 7:if(g=e.v,f=document.getElementById("slide-container")){e.n=8;break}throw new Error("Framework error: #slide-container not found.");case 8:return v=Rt(f,"main"),d.forEach(function(e){var t,r=e.component;if(!e.engagement)throw new Error('Slide "'.concat(e.id,'" missing required \'engagement\' configuration in course-config.js structure. Add "engagement: { required: false }" to the slide definition in courseConfig.structure.'));v.registerView(e.id,{render:(t=u(c().m(function t(n){var a,o,s;return c().w(function(t){for(;;)switch(t.p=t.n){case 0:return Ft.clear(),Qe.initSlide(e.id,e.engagement),a=i(i({},n),{},{slideId:e.id,title:e.title}),t.p=1,t.n=2,r.render(null,a);case 2:o=t.v,t.n=4;break;case 3:throw t.p=3,s=t.v,new Error('Slide "'.concat(e.id,'" render() failed: ').concat(s.message));case 4:if(o){t.n=5;break}throw new Error('Slide "'.concat(e.id,'" render() returned null/undefined. Must return a DOM element.'));case 5:return Ft.setReady(),t.a(2,o)}},t,null,[[1,3]])})),function(e){return t.apply(this,arguments)}),onShow:function(t,n){var a=new bo("main#content",e.id);t._scrollTracker=a,r.onShow&&r.onShow(t,n)},onHide:function(t){t._scrollTracker&&(t._scrollTracker.destroy(),t._scrollTracker=null),Qe.cleanupSlide(e.id),r.onHide&&r.onHide(t)}})}),hr(),Sa(),Wr(),e.n=9,kn(d,v,p,g);case 9:E.on("view:change",function(e){var t=e.view,r=e.context;console.log("[ViewManager] View changed to '".concat(t,"'"),r)}),console.log("[CourseInit] Initialization complete"),Ea(),window.addEventListener("beforeunload",function(e){var t,r,n,a,o=!0;!0===(null===(t=_t.environment)||void 0===t?void 0:t.disableBeforeUnloadGuard)?o=!1:!1===(null===(r=_t.environment)||void 0===r?void 0:r.disableBeforeUnloadGuard)&&(o=!0),null!==(n=_t.environment)&&void 0!==n&&null!==(n=n.automation)&&void 0!==n&&n.enabled&&null!==(a=_t.environment)&&void 0!==a&&null!==(a=a.automation)&&void 0!==a&&a.disableBeforeUnloadGuard&&(o=!1),o?Lr()?console.log("[Framework] Intentional exit detected, allowing page unload."):(e.preventDefault(),e.returnValue="",console.warn("[Framework] Unintentional page unload detected. Showing browser confirmation.")):console.log("[Framework] Beforeunload warning is disabled.")}),e.n=11;break;case 10:throw e.p=10,yo(h=e.v),h;case 11:return e.a(2)}},e,null,[[1,10]])})),xo.apply(this,arguments)}window.addEventListener("submit",function(e){e.preventDefault();var t=e.target,r=e.submitter,n="N/A (Submission not triggered by a button)";if(r){var a=r.getAttribute("type"),o=r.tagName.toLowerCase();n="Tag: <".concat(o,'>, Type: "').concat(a||"submit (default)",'", Text: "').concat(r.textContent.trim(),'"')}var i="[Framework] Critical Error: Form submission blocked.\n    Reason: Standard form submissions cause a page reload, which corrupts the SCORM session.\n    Form: ".concat(t.id?"#".concat(t.id):"(no id)","\n    Submitter: ").concat(n,"\n    Fix: Ensure all <button> elements inside <form> have 'type=\"button\"'. Use JavaScript and the data-action pattern to handle user interactions instead of form submissions.");throw console.error(i,{form:t,submitter:r}),new Error("Form submission blocked to prevent SCORM data corruption. See console for details.")}),window.addEventListener("click",function(e){var t=e.target.closest("a");if(t&&"_blank"!==t.target){var r=t.getAttribute("href");e.preventDefault();var n='[Framework] Critical Error: Navigation blocked.\n    Reason: Using <a> tags for navigation causes a page reload, which corrupts the SCORM session.\n    Anchor Href: "'.concat(r||"(not set)",'"\n    Anchor Text: "').concat(t.textContent.trim(),'"\n    Fix: For internal navigation, use \'NavigationActions.goToSlide(slideId)\'. For other actions, use a <button type="button"> with the data-action pattern.');throw console.error(n,{anchor:t}),new Error("Anchor tag navigation blocked to prevent SCORM data corruption. See console for details.")}}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",wo):wo()}}})}();
